<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"wgc5.gitee.io","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="区块链基础知识区块链：​        分布式数据库（本质：一个个区块形成的链表），区块就像一个个账本，链就是将一个个账本联系起来的纽带；2个区块之间采用p2p方式链接，整体呈现网状分部；每个账本记录着一些公认的信息；综上所述，区块链就笼统的解释为分布式数据库。 第一代区块链： ​        去中心话的加密货币；典型例子就是比特币；每个加密货币都会产生一个伪随机数，可以用于加追踪和验证交易。​">
<meta property="og:type" content="article">
<meta property="og:title" content="区块链基础知识">
<meta property="og:url" content="https://wgc5.gitee.io/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/index.html">
<meta property="og:site_name" content="北极星上的稻草人">
<meta property="og:description" content="区块链基础知识区块链：​        分布式数据库（本质：一个个区块形成的链表），区块就像一个个账本，链就是将一个个账本联系起来的纽带；2个区块之间采用p2p方式链接，整体呈现网状分部；每个账本记录着一些公认的信息；综上所述，区块链就笼统的解释为分布式数据库。 第一代区块链： ​        去中心话的加密货币；典型例子就是比特币；每个加密货币都会产生一个伪随机数，可以用于加追踪和验证交易。​">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://wgc5.gitee.io/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210904100457419.png">
<meta property="og:image" content="https://wgc5.gitee.io/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210904102345008.png">
<meta property="og:image" content="https://wgc5.gitee.io/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210904102735472.png">
<meta property="og:image" content="https://wgc5.gitee.io/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210904165220798.png">
<meta property="og:image" content="https://wgc5.gitee.io/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210904165056764.png">
<meta property="og:image" content="https://wgc5.gitee.io/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210905153225483.png">
<meta property="og:image" content="https://wgc5.gitee.io/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210905152338057.png">
<meta property="og:image" content="https://wgc5.gitee.io/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210905153053665.png">
<meta property="og:image" content="https://wgc5.gitee.io/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210905170220959.png">
<meta property="og:image" content="https://wgc5.gitee.io/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210906102334640.png">
<meta property="og:image" content="https://wgc5.gitee.io/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210906104758807.png">
<meta property="og:image" content="https://wgc5.gitee.io/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210906105523041.png">
<meta property="og:image" content="https://wgc5.gitee.io/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210906155836352.png">
<meta property="og:image" content="https://wgc5.gitee.io/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210906160530221.png">
<meta property="og:image" content="https://wgc5.gitee.io/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210906162108463.png">
<meta property="og:image" content="https://wgc5.gitee.io/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210906162255374.png">
<meta property="og:image" content="https://wgc5.gitee.io/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210906201626270.png">
<meta property="og:image" content="https://wgc5.gitee.io/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210906164806092.png">
<meta property="og:image" content="https://wgc5.gitee.io/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210906164853479.png">
<meta property="og:image" content="https://wgc5.gitee.io/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210906165209214.png">
<meta property="og:image" content="https://wgc5.gitee.io/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210906164952603.png">
<meta property="og:image" content="https://wgc5.gitee.io/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210906165653320.png">
<meta property="og:image" content="https://wgc5.gitee.io/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210906170115398.png">
<meta property="og:image" content="https://wgc5.gitee.io/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210907191401485.png">
<meta property="og:image" content="https://wgc5.gitee.io/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210907192116543.png">
<meta property="og:image" content="https://wgc5.gitee.io/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210907192515304.png">
<meta property="og:image" content="https://wgc5.gitee.io/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210907192906267.png">
<meta property="og:image" content="https://wgc5.gitee.io/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210907193208569.png">
<meta property="og:image" content="https://wgc5.gitee.io/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210907203719865.png">
<meta property="og:image" content="https://wgc5.gitee.io/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210907193527302.png">
<meta property="og:image" content="https://wgc5.gitee.io/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210907194720634.png">
<meta property="og:image" content="https://wgc5.gitee.io/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210907195902583.png">
<meta property="og:image" content="https://wgc5.gitee.io/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210907195059308.png">
<meta property="og:image" content="https://wgc5.gitee.io/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210907195225290.png">
<meta property="og:image" content="https://wgc5.gitee.io/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210907203754437.png">
<meta property="og:image" content="https://wgc5.gitee.io/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210907203812364.png">
<meta property="og:image" content="https://wgc5.gitee.io/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210907203952514.png">
<meta property="og:image" content="https://wgc5.gitee.io/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210907205250354.png">
<meta property="og:image" content="https://wgc5.gitee.io/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210907205116102.png">
<meta property="og:image" content="https://wgc5.gitee.io/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210907211716347.png">
<meta property="og:image" content="https://wgc5.gitee.io/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210907215416196.png">
<meta property="og:image" content="https://wgc5.gitee.io/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210907220032926.png">
<meta property="og:image" content="https://wgc5.gitee.io/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210907221512457.png">
<meta property="og:image" content="https://wgc5.gitee.io/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210908091951239.png">
<meta property="og:image" content="https://wgc5.gitee.io/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210908104505017.png">
<meta property="og:image" content="https://wgc5.gitee.io/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210908104607563.png">
<meta property="og:image" content="https://wgc5.gitee.io/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210908104646321.png">
<meta property="og:image" content="https://wgc5.gitee.io/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210908104755939.png">
<meta property="article:published_time" content="2021-09-08T04:42:58.000Z">
<meta property="article:modified_time" content="2021-10-08T01:20:23.151Z">
<meta property="article:author" content="北极星上的稻草人">
<meta property="article:tag" content="区块链入门">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://wgc5.gitee.io/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210904100457419.png">

<link rel="canonical" href="https://wgc5.gitee.io/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>区块链基础知识 | 北极星上的稻草人</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">北极星上的稻草人</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">稻草人笔记</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">20</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">7</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">34</span></a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wgc5.gitee.io/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="北极星上的稻草人">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="北极星上的稻草人">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          区块链基础知识
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-09-08 12:42:58" itemprop="dateCreated datePublished" datetime="2021-09-08T12:42:58+08:00">2021-09-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-10-08 09:20:23" itemprop="dateModified" datetime="2021-10-08T09:20:23+08:00">2021-10-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%8C%BA%E5%9D%97%E9%93%BE/" itemprop="url" rel="index"><span itemprop="name">区块链</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="区块链基础知识"><a href="#区块链基础知识" class="headerlink" title="区块链基础知识"></a>区块链基础知识</h1><h2 id="区块链："><a href="#区块链：" class="headerlink" title="区块链："></a>区块链：</h2><p>​        分布式数据库（本质：一个个区块形成的链表），区块就像一个个账本，链就是将一个个账本联系起来的纽带；2个区块之间采用p2p方式链接，整体呈现网状分部；每个账本记录着一些公认的信息；综上所述，区块链就笼统的解释为分布式数据库。</p>
<p><strong>第一代区块链：</strong></p>
<p>​        去中心话的加密货币；典型例子就是比特币；每个加密货币都会产生一个伪随机数，可以用于加追踪和验证交易。<br>​    特点：安全性高，可追踪和验证、透明度高<br>​    缺点：耗时、成本高</p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210904100457419.png" alt="image-20210904100457419"></p>
<p><strong>第二代区块链（以太坊为例）：</strong></p>
<p>​        比方说，就像滴滴打车平台，以前是司机自己抢单，现在可以让司机交押金，然后由平台派单。相比第一代的比特币，以太坊大大提高了验证的效率。以前，人们想开发数字货币，要根据比特币的协议，将原来的软件代码拷贝下来，变成自己的版本。因为原始代码会随时升级，所以这些货币会变得不兼容，而以太坊允许人们可以直接在协议上修改代码，做二次开发就可以了<br>​    特点：兼容、高效率<br>​    缺点：应用单一</p>
<p><strong>第三代区块链：</strong></p>
<p>​        又有两个新的成果。一个是智能合约的诞生，智能合约可以跟踪所有跟合同有关的执行情况，这意味着，它可以约束各种违反合同的不法行为。第二个成果是，区块链技术诞生了一种新的融资方式和财富分配方式。股权分配是一个道理<br>​    特点：可伸缩性、互操作性（侧链），个性化</p>
<p><strong>不可篡改性</strong></p>
<p>​    1.原理：提交时，用区块算出一个哈斯值a；下载时，再用区块算出一个哈斯值b；若a=b，则判断为没被篡改（其实会有哈斯碰撞情况，不能说百分比正确），若a！=b，则一定被篡改过。(扩展，提高安全性：X=x+random随机数)    </p>
<p>​    2.应用：预测，哈斯算法X—-&gt;H(x),由于哈斯计算具有抗碰撞性质，所以，可以先公布H(x)，后面预测正确就可以公布X。</p>
<p><strong>区块链创建账号</strong></p>
<p>​    自己创建私钥和公钥；验证：用私钥签名，用公钥验证。关键，随机源的取值</p>
<p><strong>说明：以下图片出自b站北大肖老师授课视频，内容为学习笔记</strong></p>
<h3 id="比特币"><a href="#比特币" class="headerlink" title="比特币"></a>比特币</h3><p>​     挖矿模式：pow（proof of work）</p>
<p>​    数据结构：区块链+merkle tree（如下图）；Merkle Tree 相比 Balance Tree，也是普通指针换成了哈希指针</p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210904102345008.png"></p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210904102735472.png" alt="image-20210904102735472"></p>
<p><strong>挖矿：</strong>比特币挖矿的过程中实际就是找一个nonce，nonce跟区块的块头里的其他信息合一起作为输入，得出的哈希值要小于等于某个指定的目标预值。H(block header)≤target。block header 指块头，块头里有很多域，其中一个域是我们可以设置的随机数nonce，挖矿的过程是不停的试随机数，使得block header取哈希后落在指定的范围之内。</p>
<p><strong>共识机制</strong></p>
<p>​    1.区块链共识机制：哈斯共识</p>
<p>​    2.比特币共识机制：去中心化的账本的内容–记账权–求nonce（hash rate）–算力“投票”</p>
<p>目标预值（期望预值expected time=14天）</p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210904165220798.png" alt="image-20210904165220798"></p>
<p>挖矿难度</p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210904165056764.png" alt="image-20210904165056764"></p>
<p><strong>比特币安全性保证：</strong></p>
<pre><code> 1.密码学机制：非对称加密</code></pre>
<p>​     2.共识机制</p>
<p><strong>分叉</strong></p>
<p>​    硬分叉：分叉永久存在；旧区块保守者不承认新区块模式，新区块模式承认旧区块模式，旧区块保守者永远只在旧区块链上挖矿。</p>
<p>​    软分叉：不会存在永久分叉；新区块先进者不承认旧区块模式，旧区块保守者赞同新区块模式，由于严重机制和共识机制的问题，只要大部分人更新了软件，分叉就不会永远存在；例如旧区块只验证a条件，而新区块要验证a、b两个区块;最终淘汰旧区块；如p2sh（pay to script hash）引入时就出现了软分叉)</p>
<p><strong>匿名性</strong></p>
<p>​    1.用户并不需要公布和捆绑的个人信息，只需要公布自己的公钥（现在连公钥都不需要，只需要公布公钥的哈希值）</p>
<p>​    2.多地址捆绑干扰，多个地址对应多个输出（一个用户可以开始多个账号，就有多个地址）</p>
<p>​    3.盲签方法</p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210905153225483.png" alt="image-20210905153225483"></p>
<p>​    4.零知识证明：证明方只需要向验证法（直接/间接）证明某一个陈述，不需要透露其他陈述是正确的以外信息。（例如，A证明这个交易者是自己，A只需要给出一个相同的hash值即可）</p>
<p>​    零知识证明的数学基础：同态隐藏：如图是其三个定义性质</p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210905152338057.png" alt="image-20210905152338057"></p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210905153053665.png" alt="image-20210905153053665"></p>
<ol start="5">
<li>零币和零钞</li>
<li>货币混合：用户们把比特币发给一个管理中心，管理中心再等额随机分配比特币（地址就不一样了，因为自己很有可能拿到的都是别人的币），管理中心还可以用比特币买其他的货币，经过几次转换，再把比特币返款给用户。</li>
</ol>
<p>打破匿名性：（1）在现实中进行交易（蹲点交易时间/地点等，再到链上查阅区块，可以分析出）</p>
<p><strong>不可溯源性</strong></p>
<p>​    这里说的溯源性是指找到用户的个人信息，这是由匿名性决定（主要）；但比特币的交易是可以溯源的，这里的指的是比特币的余额概念，例如可以判断是否进行了双花（double spending）操作，溯源使用的是UTXO模型。</p>
<p><strong>量子计算与比特币</strong></p>
<p>​        比特币只是第一代区块链的典型产物，如今已经开始研发第三代区块链了（第二段区块链典型产物：以太坊）。虽然量子计算有着惊人的算力，但是就目前知识发展来说，其对比特币威胁并非是致命的。原因如下：（1）量子计算机如今虽然发展迅速，但截止2020年12月，目前最强的量子计算机–九章，最理想状态下能控制76个量子比特；但要想破解比特币理论上需要控制4000个量子比特。而且目前量子计算机的量子控制的准确性还非常低，误差和出错率都很大。（2）目前，要想破解比特币，即使全球计算机同时运行，都破解不了（难度是2的256次方，因为其密钥值是256位）；而理论上，量子计算机只需要以分钟，甚至是秒做单位就可以破解。但这是在知道公钥的情况下破解。但是目前有的区块链技术已经不需要公布公钥了，只需要公布公钥的hash值，从公钥的hash值破解得到公钥，再从公钥破解到私钥；就目前的学术理论水平来说，即使是量子计算机也是不可能算出；首先是hash运算不可逆，而且其过程可能会出现有效数据丢失，而量子计算机主流认为的破解方法是暴力破解（该想法主要来源北京大学肖臻老师《区块链技术与应用》第13节课程的思考）（3）量子计算机是新型物理设备，而区块链只是软件；而且，目前用的是图灵计算机，属于不同的设备；再者，软件和硬件之间存在非常大的隔阂，以后很有可能会研发出量子计算机上的区块链（移植）。（4）目前区块链正在落实应用到我们的现实生活中，发展方向多，如：电子钞票（如：电子人民币）、电子发票、药品/食物标签追踪、公益、联盟链等等。存在既有理，所以区块链技术还是很有存在和发展的意义的。</p>
<p>​    总之，本人不认为区块链技术在量子计算机面前不值一提；量子计算机的发展还有很长的路，几年甚至几十年也不一定；按目前的发展速度，比特币在未来10年里应该是安全的（只是说在量子计算机威胁方面），至于以后的事，谁都不好说。再补充一下，量子计算机和区块链技术都是非常有用的技术，不能片面的评价谁好谁不好。</p>
<h3 id="以太坊"><a href="#以太坊" class="headerlink" title="以太坊"></a>以太坊</h3><p>​     <strong>挖矿模式</strong>：pow（proof of work）</p>
<p>​    <strong>用户机制：</strong>（1）比特币每次交易必须把已有的币花光，例如，B有10个币，B与C的交易只需要3个币，那么B还要把7个币转给自己，这是由于要保证币的来源所决定的。以太坊只验证币的支出交易，这样可以防御双花攻击（double spending attack，由于支付者A不诚实，同一笔钱进行多次交易并发布到区块链上：A-B，A-C…，这样A用一笔钱进行了多次交易，还可以把钱转回到自己地址上）；随机而来会造成应答攻击（replay attack，由于接收者B不诚实，把A-B重复发到链上，这样其他矿工看到了，就一起写入区块，最后写到区块链上，B就收到重复的多笔交易）</p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210905170220959.png" alt="image-20210905170220959"></p>
<p>（2）比特币用户身份不确定性，一个用户可以拥有多个账号，多个身份，进而迷惑交易。而以太坊采用了身份确认/固定机制，一个用户可以由多个账号，但是身份固定。</p>
<p><strong>账户类型的数据结构</strong></p>
<p>​    <strong>问题1</strong>：为什么不像BTC那样将哈希表组织为Merkle Tree？</p>
<p>​    答：BTC存储的是交易信息，存到区块链后不需要更改，而且BTC是没有账户概念的，它是通过比特币的流通来计算余额。若ETH采用Merkle Tree，那么每次产生新的区块（新交易），就需要重新构建Merkle Tree，而且新区块产生的周期为10s，这样一来就不现实了；而且随着交易的增加，Merkle Tree会越来越大，这也不现实。（BTC的Merkle Tree大小是由区块大小决定的，区块包含的交易上限是4000个，那么Merkle Tree大小并不会太大）</p>
<p>​    <strong>问题2：</strong>我们可以不用hash表，直接在Merkle Tree上修改新添加的部分么？</p>
<p>​    答：目前Merkle Tree并未提供一个高效的查找和更新的方案，为保证查找效率和一致性，必须排序。</p>
<p>​    <strong>问题3：</strong>那采用排序的Sorted Merkle Tree可以吗？</p>
<p>​    答：虽然进行了排序，查找效率有了保证，但是新建账号时，地址是随机的，当插入的结点在中间非叶子结点部分，就需要进行重构，所以Sorted Merkle Tree插入、删除(实际上可以不删除)的代价太大。因此专家采用了MPT结构。</p>
<p><strong>MPT(Merkle Patricia tree/trie)</strong></p>
<p>​    trie：字典树/前缀树；保证一致性</p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210906102334640.png" alt="image-20210906102334640"></p>
<p>​    Patricia tree/trie：路径压缩trie/tree；提高效率</p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210906104758807.png" alt="image-20210906104758807"></p>
<p>MPT：将Merkle Tree与Patricia trie结合；提高了安全性和性能</p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210906105523041.png" alt="image-20210906105523041"></p>
<p><strong>挖矿技术</strong></p>
<p>​    （引入）<strong>莱特币挖矿技术</strong>：Memory Hard Mining Puzzle。1.设置一个较大的数组（128k大小），Seed为种子结点，通过Seed运算得到一个数并把这个数放到第一个位置；之后的每个数都是通过计算前一个数的hash值得到（逻辑相邻，数组位置其实不相邻，有点像链表，但是存在数组里），具有一定的前后依赖性。</p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210906155836352.png" alt="image-20210906155836352"></p>
<p>2.在求解Puzzle时，从数组中取数，但是要取下一个数就必须要用当前的数求出下一个数的位置。（如A–&gt;B–&gt;C)；拿到数后，求出符合条件的nonce就算挖到。</p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210906160530221.png" alt="image-20210906160530221"></p>
<p>补充：如果数组足够大，对于挖矿矿工来说，必须保存该数组以便查询，否则每次不仅计算位置，还要根据Seed计算整个数组数据，才能查询到对应位置的数据。这对于矿工来说，计算性能要求（如：内存）大幅度上升。不利于ASCI专业挖矿机挖矿（这类矿机计算性能好，但是内存小），但利于大众挖矿（普通的计算机满足该内存需求）</p>
<p>​    <strong>以太坊挖矿技术</strong>：以太坊的理念与莱特币类似，都是Memory Hard Mining Puzzle，但具体设计上与莱特币不同。以太坊中，设计了两个数据集，一大一小；小的为16MB的cache，大的数据集为1G的dataset(DAG)。其关系为，1G的数据集是通过16MB数据集生成而来的。</p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210906162108463.png" alt="image-20210906162108463"></p>
<p>​    问：为什么要设计一大一小的数据集？</p>
<p>​    答：大的数据集是为了抵抗ASCI矿机，但对于轻节点并不友好（因为轻节点不用挖矿，它只是使用）；于是便有了小数据集，它给轻节点提供了检验功能。</p>
<p>​    <strong>DAG生成过程：</strong>大的数组中每个元素都是从小数组中按照伪随机顺序读取一些元素，方法同莱特币中相同。如第一次读取A位置数据，对当前哈希值更新迭代算出下一次读取位置B，再进行哈希值更新迭代计算出C位置元素。如此来回迭代读取256次，最终算出一个数作为DAG中第一个元素，如此类推，求出DAG的每一个元素。</p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210906162255374.png" alt="image-20210906162255374"></p>
<p>​    <strong>以太坊挖矿过程：</strong>目标是求出一个符合要求的nonce。首先根据block header和nonce运算得出第一个初始hash，根据hash映射到初始位置A（A后一个位置为A‘）；然后用A和A’运算得到下一个位置B，如此类推，迭代64次，共读取128个数；最后计算出一个hash值。若符合条件，则算挖矿成功；若不符合则要重新选择nonce进行重复操作，直到当前的区块挖出或被挖出（若先被别人挖出，block header就变了，则要准备挖下一个区块）</p>
<p><strong>奖励机制证明方式：</strong>目前正有工作量证明（POW）向权益证明(POS: Proof of State)转型，但是目前还是pow；但是由于POS还不完善，无法直接投入使用；而挖矿难度呈指数增加，所以在2017年-2018年之间进行了难度下调。（（奖励）铸币数也由5个降低为3个）</p>
<p>​    问：为什么不直接就推行pos？而且要由pow过渡？</p>
<p>​    答：由于矿工投入了大量资金打造挖矿设备，若马上采取pos，那么挖矿设备就没用了，用于引起暴动，也容易产生以太坊分支，不利于发展。</p>
<p><strong>权益证明主流思想：</strong></p>
<p>​    以太坊中，准备采用的权益证明协议为Casper the Friendly Finality Gadget(FFG)，该协议在过渡阶段是要和POW结合使用的。FFG协议引入一个概念：Validator(验证者)，一个用户想要成为Validator，需要上交一笔“保证金”，这笔保证金会被系统锁定。Validator的职责是推动系统达成共识，投票决定哪一条链成为最长合法链，投票权重取决于保证金数目。它采用两次投票的方式：prepare投票和Commit 投票，规定每次投票结果都要获得2/3以上的验证者同意；把100个区块等分为2部分；前50个采用commit投票，后50个采用prepare投票（相对的），当2个部分都通过了，这100个区块才算通过。如图</p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210906201626270.png" alt="image-20210906201626270"></p>
<p><strong>权益证明的奖罚机制：</strong>为了鼓励大家参与验证epoch，每次完成验证，都会得到相应的验证奖励；为了防止攻击/捣乱，如果有权益者不参与投票，那么他会扣罚一部分保证金；而对于同时2边都投的权益者，则没收其全部保证金；通过惩罚积出的以太币会被销毁。</p>
<p><strong>奖励机制之预挖矿：</strong>这里“预挖矿”并不挖矿，而是在开发以太坊时，给开发者预留了一部分货币（其份额占目前已有币的大半部分）。</p>
<p><strong>以太坊难度调整：</strong>区块编号减去了三百万</p>
<p>算法如图</p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210906164806092.png" alt="image-20210906164806092"></p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210906164853479.png" alt="image-20210906164853479"></p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210906165209214.png" alt="image-20210906165209214"></p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210906164952603.png" alt="image-20210906164952603"></p>
<p>补充：以前是没有H’的，是难度回调时才添加的（在什么不直接采用POS的背景下）</p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210906165653320.png" alt="image-20210906165653320"></p>
<p><strong>以太坊发展</strong></p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210906170115398.png" alt="image-20210906170115398"></p>
<p><strong>智能合约</strong></p>
<p>说明：智能合约并不智能，只是一个由代码执行的合约规定；合约是根据需求用代码来表示的；因此，一般情况下，合约上链了，执行的结果也确定了，即使代码有漏洞/被利用/受到攻击等，都无法改变；这是由区块链的不可篡改性决定的。（当然，这不是绝对不可篡改，利用区块链回滚可以撤销操作，但是其会产生巨大的影响）</p>
<p>​    以公开拍卖智能合约为例</p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210907191401485.png" alt="image-20210907191401485"></p>
<p>​    <strong>合约调用：</strong></p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210907192116543.png" alt="image-20210907192116543"></p>
<p>补充：以太网规定，内部账号不能调用合约，只有外部账号才可以调用合约（这句话需要自行理解），这种调用如果出错，整个合约会一起回滚，不会往下执行。</p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210907192515304.png" alt="image-20210907192515304"></p>
<p>补充：这种调用，当函数调用出错时，call（）函数会返回false，表明调用失败；但是合约会继续往下执行。</p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210907192906267.png" alt="image-20210907192906267"></p>
<p>补充：这种调用与上面call（）调用类似，不同之处是调用时不用跳到另外合约环境中进行（当合约调用合约时），在本身合约执行即可。</p>
<p>（特别）匿名函数</p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210907193208569.png" alt="image-20210907193208569"></p>
<p>补充：当函数缺省/合约没有执行任何函数/调用函数不存在时，系统会调用该函数。</p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210907203719865.png" alt="image-20210907203719865"></p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210907193527302.png" alt="image-20210907193527302"></p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210907194720634.png" alt="image-20210907194720634"></p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210907195902583.png" alt="image-20210907195902583"></p>
<p><strong>回答死循环问题：</strong>为了应对有的人恶意消耗资源（如：制造死循环），引入了汽油费的机制；（合约发起人）交易需要支付汽油费（执行不同语句消耗的汽油量不同）。由于无法确定合约执行汽油费的总额，每个合约还需要确定一个最大汽油费数值（表示愿意承受的费用）；而且每个区块也有一个汽油费上限；当消耗的汽油费超过区块最大汽油费，合约就会结束运行（即使交易没完成），注意回滚汽油费是不会退的。</p>
<p><strong>问：</strong>是先挖矿再执行合约？还是先执行合约再挖矿？</p>
<p><strong>答：</strong>先执行合约再挖矿。因为要想挖矿就必须获得完整的block header；其中状态树、交易树、收益树三颗树是存储在区块链的全结点上的；执行合约/验证交易时，用户的余额会发生变化，所以执行合约并验证结束后，三个树才能确定，三颗树确定后，block header才能确定，所以必须先执行合约再挖矿。<strong>注意</strong>：矿工在验证交易时是在本地验证的，那时候消耗的汽油量和余额变化是写在本地，只有挖到矿并成功写到区块链上才会生效；所以不存在如果挖不到矿，别人的汽油费白花的情况；也不存在多个矿工验证合约重复消耗合约的情况。</p>
<p><strong>问：</strong>既然是先验证/执行合约，再挖矿；那如果挖不到矿，岂不是白干活了？那可不可以直接不验证，用别人的结果，继续挖下一个区块？</p>
<p><strong>答：</strong>每个矿工都必须验证每一个交易/合约，即使挖不到而白干活；因为你不验证，你就得不到下一个区块的用户状态；必须验证后才可以获得当前完备且正确的状态。别人的验证结果是不可以套用的，因为验证/挖矿过程用的是自己的地址/hash值，别人验证用的是别人的地址/hash值（如果用，收款人就是对方，自己永远得不到奖励）；所以要想继续挖矿，就必须自己验证。</p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210907195059308.png" alt="image-20210907195059308"></p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210907195225290.png" alt="image-20210907195225290"></p>
<p><strong>问：</strong>执行发送错误的交易需要发布到区块链上么？（注意是交易有错）</p>
<p><strong>答：</strong>需要；（1）如果不发布到区块链上就无法扣取汽油费；（2）交易是否出错，需要经过全部人验算才行</p>
<p>问：智能合约支持多线程么？</p>
<p>答：不支持，因为区块链要保证状态一致性；多线程容易产生多过结果，（多线程）多个核访问进程的顺序不同容易出现多个状态。但是区块链是分布式的。（所有会导致产生不确定状态的技术都不可以，例如真.随机数（伪随机数可以）</p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210907203754437.png" alt="image-20210907203754437"></p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210907203812364.png" alt="image-20210907203812364"></p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210907203952514.png" alt="image-20210907203952514"></p>
<p>说明：transfer（）转账过程出现错误会回滚；而send（）转账过程会抛出错误，但不会回滚。上面两个是专门用于转账的，但call（）也可以用于转账，call（）主要用于函数调用。</p>
<p><strong>拍卖例子：</strong>出价可以多次出（拍卖出价是发布合约交易的形式），所有拍卖货币要先锁在区块链上；拍卖结束时，未拍卖成功的人的币会返款，拍卖成功的人的币会转给拍卖货物的人。</p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210907205250354.png" alt="image-20210907205250354"></p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210907205116102.png" alt="image-20210907205116102"></p>
<p>补充：拍卖结束时用一个for（）退款给拍卖的人。</p>
<p><strong>当出现多重合约调用情况</strong>：一个黑客写了一个合约hackV1（）合约，hackV1合约会；由于合约账户不用调用自身合约；所以黑客调用外部账户（另外一个账号）调用hackV1合约，再用转入hackV1合约的钱转到行拍卖合约进行拍卖（即hackV1合约通过调用拍卖合约，把转入把hackV1的再转到的拍卖合约）</p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210907211716347.png" alt="image-20210907211716347"></p>
<p>可能出现的问题：（hackV1合约只有一个函数，没有fallback（）函数）hackV1合约参与拍卖没问题，退款时会出现问题。执行退款for循环里transfer（）函数转账时，没有调用任何函数；当一个合约账户（这里是hackV1的账户）转账时（这里是收到转账）时没有调用任何函数，合约会自动调用fallback函数，而这个hackV1合约没有fallback函数；所以会抛出异常；又由于这里采用的是transfer（）函数进行交易，所以拍卖失败（出现异常）会发生回滚。回滚到交易前的状态，所以全部人都收不到退款。（注意：在拍卖混滚前，所有参与拍卖的货币，都是已经锁到了区块链上了；回滚只是回到了交易前的状态（程序认为是交易前状态，也就没有发生交易，就不会执行退款操作），但是实际上币已经支付出去了。）</p>
<p>引出：一旦合约代码出现漏洞/错误，放到了区块链上就无法修改，结果也不可改变。这是由于区块链不可篡改性导致的。</p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210907215416196.png" alt="image-20210907215416196"></p>
<p>补充：画红框的if语句的条件，只有在交易拍卖结束的时候才会为true</p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210907220032926.png" alt="image-20210907220032926"></p>
<p>补充：HackV2的fallback函数的if语句：当拍卖的返款的余额大于当初投入的钱（拍卖的余额足以支付报价）并且汽油量大于6000，状态深度小于500时；条件为真。</p>
<p><strong>出现的问题：</strong>当执行fallback函数时（就是function（）public payload{…}），调用了withdraw（）函数，当withdraw函数执行到上述红框语句（if的条件）时，又会触发HackV2的fallback函数，一直陷入死循环，直到拍卖里的币腿光；第一次调用是退回Hackv2用户自己的前，后面就是退别人的钱了。</p>
<p><strong>解决方法：</strong>（1）先将用户余额清零，再转账，转账失败再恢复余额；（2）call函数给为send函数/transfer（）因其汽油量问题。</p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210907221512457.png" alt="image-20210907221512457"></p>
<p><strong>DAO（Decentralized Autonomous Orgarization）</strong></p>
<p>​    DAO去中心化的自治织，这是一个泛称。大概理念是：大家把对自己有兴趣的基金进行投币，最后由投票权重觉得用这些币去赞助那个基金。</p>
<p>​    <strong>The DAO组织被盗币事件</strong></p>
<p>​    The DAO组织是一个典型的DAO，它会用以太币转化成代币进行交易，而且退款机制是采用了拆分技术，拆分后会有28天的审议期，由所有矿工评价拆分的好坏/是否要这样拆分。</p>
<p>The DAO合约的代码（一个函数）</p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210908091951239.png" alt="image-20210908091951239"></p>
<p><strong>问题/漏洞：</strong>先转账，再清零；其漏洞与上面拍卖例子的最后一个问题一样；可能会产生重入攻击。</p>
<p><strong>影响</strong>：The DAO组织的合约当时集资了大概1.5亿美元，对应合约的以太币大概全部以太币的10%+（一个合约的资金就占整个市场的10%+，是非常恐怖的）；黑客利用该漏洞盗取了5000万+美元，大概1/3的以太币；给社会带来的巨大的恐慌，严重危害了以太币的发展。</p>
<p><strong>解决方法</strong>（软分叉、硬分叉、采用黑客相同的手段转走剩下的钱</p>
<p>​    由于Tho DAO有28天的拆分期（即交易货币会被锁定28天），所以给以太坊留了一定的时间做对策。以太坊大部分人同意采用回滚，把货币全部回滚；剩下的少部分人认为以太坊干预并强制回滚背离了去中心化理念，他们部分人认为黑客只是利用了合约（就像利用法律/合同漏洞）并没有犯法。结果最后以太坊采用了回滚（采用了美国历史上Too big to fail的金融危机处理理念：这件事的影响太大了，破坏了生态健康发展，所以国家/组织应该出面帮忙解决）</p>
<p><strong>问：</strong>回滚这操作真的完全是背离了去中心化的理念么？</p>
<p><strong>主观认为：</strong>大部分人赞同，也代表了民主的少数服从多数，也不算是决定的中心化决定（思考：但多数人认为的就一定是正确的么？）</p>
<p><strong>具体补救方法：</strong></p>
<p>（1）软分叉：以太坊更新了软件，让The Dao 的账号无法交易，其他交易正常进行。（结果：由于大部分人认为官方强制执行回滚，所以交易的汽油费不应该由交易账号出，所以交易没有收取汽油费；从而引起了大量的非法型交易攻击，给矿工们造成了巨大的打击（白干活），进而失败了。）</p>
<p>（2）硬分叉：软分叉失败后（28天的审议期只剩下几天），以太坊通过软件升级的方法把The DAO上的资金转到新的合约上（这个合约只是用来退币）；把代币退转回以太币；决定在第129万个区块上执行。说明：由于是以太坊强制执行的，不管同意不同意都强行把资金转到新的合约上（正常交易是要用到签名的），不用签名；所以旧矿工会认为这是非法交易，不认同该区块，于是会产生分叉，新矿工认同旧矿工的区块，但旧矿工永远不会认同新矿工的区块，因此分叉会永远存在，所以是硬分叉。 </p>
<p><strong>问：</strong>存在分叉就可能受到双花攻击，那该怎么做？</p>
<p><strong>答：</strong>给两条链设置ID。</p>
<p><strong>问：</strong>The DAO 事件中，以太坊是把所有The DAO的账户锁定；为什么不只锁定黑客的账户？</p>
<p>答：由于合约是定死了（区块链不可篡改性），如果只锁定黑客的账户，那么其他的交易账户也可以利用该漏洞成为下一个黑客。（注意：回滚是退回到某个区块，产生一个新的分叉，在新的分叉开挖；由于在当前区块后成功产生6个区块后，当前区块的交易才会被完全确认，所以回滚的结点常常要考虑回退的交易最少/造成的影响最小；如果直接回退到出错结点，往往会引起较大的影响）</p>
<p><strong>问：</strong>什么时候需要智能合约？</p>
<p><strong>答：</strong>当需要一个共识的控制逻辑下，在那些互不认识的情况下建立共识机制的条件下。</p>
<p>以太坊事件：美链</p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210908104505017.png" alt="image-20210908104505017"></p>
<p>美链的一个函数</p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210908104607563.png" alt="image-20210908104607563"></p>
<p>存在问题：数据溢出</p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210908104646321.png" alt="image-20210908104646321"></p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210908104755939.png" alt="image-20210908104755939"></p>
<p><strong>数据溢出解决方法：</strong>c=a*b;if b=c/a,ture</p>
<p>注意：即使数据没溢出，但是如果操作数之间的精度不够，可能会出现精度丢失，造成的结果也不对。但是如果都整数类型，且是先进行乘法后用除法验证，就可以准确判断溢出问题。</p>
<p><strong>加密货币的应用场景：</strong>已有的支付方式没有较好解决的领域</p>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%85%A5%E9%97%A8/" rel="tag"># 区块链入门</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8F%E5%90%8E%E9%97%A8/" rel="prev" title="Mestasploit渗透测试之制作隐藏后门">
      <i class="fa fa-chevron-left"></i> Mestasploit渗透测试之制作隐藏后门
    </a></div>
      <div class="post-nav-item">
    <a href="/2021/10/07/SQL%E6%B3%A8%E5%85%A501/" rel="next" title="SQL注入01">
      SQL注入01 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86"><span class="nav-number">1.</span> <span class="nav-text">区块链基础知识</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8C%BA%E5%9D%97%E9%93%BE%EF%BC%9A"><span class="nav-number">1.1.</span> <span class="nav-text">区块链：</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%AF%94%E7%89%B9%E5%B8%81"><span class="nav-number">1.1.1.</span> <span class="nav-text">比特币</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%A5%E5%A4%AA%E5%9D%8A"><span class="nav-number">1.1.2.</span> <span class="nav-text">以太坊</span></a></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">北极星上的稻草人</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">34</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">20</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">北极星上的稻草人</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
</div>








      </div>
    </footer>
  </div>

  
  
  <script color='0,0,255' opacity='0.5' zIndex='-1' count='99' src="/lib/canvas-nest/canvas-nest.min.js"></script>
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  


<!-- 页面动态背景 -->

<script type="text/javascript" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script>


</body>
</html>
<!-- 页面点击小红心 -->
<script type="text/javascript" src="/js/clicklove.js"></script>