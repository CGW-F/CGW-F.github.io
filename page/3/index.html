<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"wgc5.gitee.io","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="北极星上的稻草人">
<meta property="og:url" content="https://wgc5.gitee.io/page/3/index.html">
<meta property="og:site_name" content="北极星上的稻草人">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="北极星上的稻草人">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://wgc5.gitee.io/page/3/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>北极星上的稻草人</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">北极星上的稻草人</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">稻草人笔记</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">24</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">9</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">66</span></a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wgc5.gitee.io/2021/11/26/SSI%E6%B3%A8%E5%85%A5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="北极星上的稻草人">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="北极星上的稻草人">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/11/26/SSI%E6%B3%A8%E5%85%A5/" class="post-title-link" itemprop="url">SSI注入</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2021-11-26 11:17:51 / 修改时间：11:18:15" itemprop="dateCreated datePublished" datetime="2021-11-26T11:17:51+08:00">2021-11-26</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CTF/" itemprop="url" rel="index"><span itemprop="name">CTF</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="SSI注入"><a href="#SSI注入" class="headerlink" title="SSI注入"></a>SSI注入</h1><h3 id="SSI注入攻击介绍"><a href="#SSI注入攻击介绍" class="headerlink" title="SSI注入攻击介绍"></a>SSI注入攻击介绍</h3><p><img src="/2021/11/26/SSI%E6%B3%A8%E5%85%A5/image-20211031095501023.png" alt="image-20211031095501023"></p>
<p><img src="/2021/11/26/SSI%E6%B3%A8%E5%85%A5/image-20211031095536153.png" alt="image-20211031095536153"></p>
<h4 id="步骤1：信息探测"><a href="#步骤1：信息探测" class="headerlink" title="步骤1：信息探测"></a>步骤1：信息探测</h4><p><img src="/2021/11/26/SSI%E6%B3%A8%E5%85%A5/image-20211031095623538.png" alt="image-20211031095623538"></p>
<p><img src="/2021/11/26/SSI%E6%B3%A8%E5%85%A5/image-20211031095654966.png" alt="image-20211031095654966"></p>
<p><img src="/2021/11/26/SSI%E6%B3%A8%E5%85%A5/image-20211031095725275.png" alt="image-20211031095725275"></p>
<img src="/2021/11/26/SSI%E6%B3%A8%E5%85%A5/image-20211031095849824.png" alt="image-20211031095849824" style="zoom:67%;">

<p><img src="/2021/11/26/SSI%E6%B3%A8%E5%85%A5/image-20211031100000296.png" alt="image-20211031100000296"></p>
<p><img src="/2021/11/26/SSI%E6%B3%A8%E5%85%A5/image-20211031100303782.png" alt="image-20211031100303782"></p>
<p>探测时，发现有：admin（管理员界面）、index（主页）、robots（隐藏目录）、config（配置文件）、login（登录界面）、.php/.python等（可代码审计）、mysql/sql（数据库）、ssi（可能存在ssi漏洞的页面）；以上页面/目录/文件都是可疑的，需要重点关注</p>
<h5 id="步骤2：深入挖掘"><a href="#步骤2：深入挖掘" class="headerlink" title="步骤2：深入挖掘"></a>步骤2：深入挖掘</h5><p><img src="/2021/11/26/SSI%E6%B3%A8%E5%85%A5/image-20211031100639794.png" alt="image-20211031100639794"></p>
<p><img src="/2021/11/26/SSI%E6%B3%A8%E5%85%A5/image-20211031100647926.png" alt="image-20211031100647926"></p>
<p>nikto….</p>
<p><img src="/2021/11/26/SSI%E6%B3%A8%E5%85%A5/image-20211031100908166.png" alt="image-20211031100908166"></p>
<p><img src="/2021/11/26/SSI%E6%B3%A8%E5%85%A5/image-20211031101111950.png" alt="image-20211031101111950"></p>
<p><img src="/2021/11/26/SSI%E6%B3%A8%E5%85%A5/image-20211031101140051.png" alt="image-20211031101140051"></p>
<p>下载这2个可疑文件，习惯性的查看文件类容（虽然不一定用的上）</p>
<p><img src="/2021/11/26/SSI%E6%B3%A8%E5%85%A5/image-20211031101737907.png" alt="image-20211031101737907"></p>
<p>dirk…</p>
<p><img src="/2021/11/26/SSI%E6%B3%A8%E5%85%A5/image-20211031101030655.png" alt="image-20211031101030655"></p>
<p><img src="/2021/11/26/SSI%E6%B3%A8%E5%85%A5/image-20211031102214294.png" alt="image-20211031102214294"></p>
<p><img src="/2021/11/26/SSI%E6%B3%A8%E5%85%A5/image-20211031101456109.png" alt="image-20211031101456109"></p>
<p><img src="/2021/11/26/SSI%E6%B3%A8%E5%85%A5/image-20211031102015364.png" alt="image-20211031102015364"></p>
<h5 id="步骤3：漏洞利用"><a href="#步骤3：漏洞利用" class="headerlink" title="步骤3：漏洞利用"></a>步骤3：漏洞利用</h5><p><img src="/2021/11/26/SSI%E6%B3%A8%E5%85%A5/image-20211031102102790.png" alt="image-20211031102102790"></p>
<p>测试</p>
<p>要想利用注入漏洞，就需要了解其处理输入的代码格式（上一步已经找到），然后利用该格式构造能够获得有用信息的指令（网站可能会注释/屏蔽某些指令，需要绕过注入；绕过方法有：大小写输入、添加注释符、封闭、编码等等)</p>
<p><img src="/2021/11/26/SSI%E6%B3%A8%E5%85%A5/image-20211031102239790.png" alt="image-20211031102239790"></p>
<p><img src="/2021/11/26/SSI%E6%B3%A8%E5%85%A5/image-20211031102605670.png" alt="image-20211031102605670"></p>
<p><img src="/2021/11/26/SSI%E6%B3%A8%E5%85%A5/image-20211031103011291.png" alt="image-20211031103011291"></p>
<p><img src="/2021/11/26/SSI%E6%B3%A8%E5%85%A5/image-20211031103037909.png" alt="image-20211031103037909"></p>
<p>然后发现获得了一些特别的信息；我们利用第二条指令获取信息/操作；到这里可以确定，需要利用ssi漏洞获得有用信息或进行操作（上传/启动webshell，修改配置）。</p>
<h5 id="步骤4：制作并上传webshell"><a href="#步骤4：制作并上传webshell" class="headerlink" title="步骤4：制作并上传webshell"></a>步骤4：制作并上传webshell</h5><p><img src="/2021/11/26/SSI%E6%B3%A8%E5%85%A5/image-20211031103244263.png" alt="image-20211031103244263"></p>
<p>上图是php的webshell；这次用python的webshell</p>
<p><img src="/2021/11/26/SSI%E6%B3%A8%E5%85%A5/image-20211031103451812.png" alt="image-20211031103451812"></p>
<p>设置并启动监听</p>
<p><img src="/2021/11/26/SSI%E6%B3%A8%E5%85%A5/image-20211031103508597.png" alt="image-20211031103508597"></p>
<p><img src="/2021/11/26/SSI%E6%B3%A8%E5%85%A5/image-20211031103536363.png" alt="image-20211031103536363"></p>
<p><img src="/2021/11/26/SSI%E6%B3%A8%E5%85%A5/image-20211031103639334.png" alt="image-20211031103639334"></p>
<p>kali开启apache服务</p>
<p><img src="/2021/11/26/SSI%E6%B3%A8%E5%85%A5/image-20211031103929774.png" alt="image-20211031103929774"></p>
<p>利用注入漏洞上传webshell</p>
<p>下载kali的webshell</p>
<p><img src="/2021/11/26/SSI%E6%B3%A8%E5%85%A5/image-20211031103826859.png" alt="image-20211031103826859"></p>
<p>启动webshell</p>
<p><img src="/2021/11/26/SSI%E6%B3%A8%E5%85%A5/image-20211031104129043.png" alt="image-20211031104129043"></p>
<p><img src="/2021/11/26/SSI%E6%B3%A8%E5%85%A5/image-20211031104339535.png" alt="image-20211031104339535"></p>
<p><img src="/2021/11/26/SSI%E6%B3%A8%E5%85%A5/image-20211031104316388.png" alt="image-20211031104316388"></p>
<p><img src="/2021/11/26/SSI%E6%B3%A8%E5%85%A5/image-20211031104532301.png" alt="image-20211031104532301"></p>
<p>步骤5:获取 flag</p>
<p><img src="/2021/11/26/SSI%E6%B3%A8%E5%85%A5/image-20211031104407277.png" alt="image-20211031104407277"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wgc5.gitee.io/2021/11/26/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="北极星上的稻草人">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="北极星上的稻草人">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5/" class="post-title-link" itemprop="url">命令注入</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2021-11-26 11:15:46 / 修改时间：11:16:09" itemprop="dateCreated datePublished" datetime="2021-11-26T11:15:46+08:00">2021-11-26</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CTF/" itemprop="url" rel="index"><span itemprop="name">CTF</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="命令注入"><a href="#命令注入" class="headerlink" title="命令注入"></a>命令注入</h1><p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5/image-20211101205003790.png" alt="image-20211101205003790"></p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5/image-20211101205239333.png" alt="image-20211101205239333"></p>
<h3 id="步骤1：信息探测"><a href="#步骤1：信息探测" class="headerlink" title="步骤1：信息探测"></a>步骤1：信息探测</h3><p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5/image-20211101205301539.png" alt="image-20211101205301539"></p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5/image-20211101205358227.png" alt="image-20211101205358227"></p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5/image-20211101205642740.png" alt="image-20211101205642740"></p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5/image-20211101205741371.png" alt="image-20211101205741371"></p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5/image-20211101205844043.png" alt="image-20211101205844043"></p>
<h3 id="步骤2：深入挖掘"><a href="#步骤2：深入挖掘" class="headerlink" title="步骤2：深入挖掘"></a>步骤2：深入挖掘</h3><p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5/image-20211101205921740.png" alt="image-20211101205921740"></p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5/image-20211101205928209.png" alt="image-20211101205928209"></p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5/image-20211101210009347.png" alt="image-20211101210009347"></p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5/image-20211101210233234.png" alt="image-20211101210233234"></p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5/image-20211101210158900.png" alt="image-20211101210158900"></p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5/image-20211101210501170.png" alt="image-20211101210501170"></p>
<p>继续探测目录，发现了备份文件</p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5/image-20211101210638933.png" alt="image-20211101210638933"></p>
<p>点击下载并放到桌面</p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5/image-20211101210733426.png" alt="image-20211101210733426"></p>
<p>打开/解压back.zip，发现需要密码</p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5/image-20211101210803155.png" alt="image-20211101210803155"></p>
<p>利用之前找到的密码，进行尝试；得到一个mp3格式的文件（备份文件怎么是mp3格式？带着怀疑去查看其真正文件格式）</p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5/image-20211101210906050.png" alt="image-20211101210906050"></p>
<p>发现真实格式是text，查看文档，发现用户名：touhid</p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5/image-20211101211345772.png" alt="image-20211101211345772"></p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5/image-20211101211449940.png" alt="image-20211101211449940"></p>
<p>查看得到的url，发现是一个登录界面；输入挖掘到的uname并用之前找到的密码进行逐一匹配，最后登录成功</p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5/image-20211101211657381.png" alt="image-20211101211657381"></p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5/image-20211101211730419.png" alt="image-20211101211730419"></p>
<p>进入服务器后台后，如果是常见的系统（这里是playSM5：网站标题），还可以尝试利用百度等方法看看是否存在某些可以利用的漏洞。</p>
<h4 id="可利用的信息"><a href="#可利用的信息" class="headerlink" title="可利用的信息"></a>可利用的信息</h4><p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5/image-20211101211816652.png" alt="image-20211101211816652"></p>
<h3 id="步骤3：登录-利用exploit-db"><a href="#步骤3：登录-利用exploit-db" class="headerlink" title="步骤3：登录-利用exploit-db"></a>步骤3：登录-利用exploit-db</h3><p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5/image-20211101212109147.png" alt="image-20211101212109147"></p>
<p>a.利用searchsploit 对应的系统，查看是否存在漏洞</p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5/image-20211101212429647.png" alt="image-20211101212429647"></p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5/image-20211101213016589.png" alt="image-20211101213016589"></p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5/image-20211101213140807.png" alt="image-20211101213140807"></p>
<p>b.利用漏洞</p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5/image-20211101213430954.png" alt="image-20211101213430954"></p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5/image-20211101213659411.png" alt="image-20211101213659411"></p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5/image-20211101213553446.png" alt="image-20211101213553446"></p>
<p>新建1.csv文件，上传到服务器</p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5/image-20211101213749697.png" alt="image-20211101213749697"></p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5/image-20211101213907214.png" alt="image-20211101213907214"></p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5/image-20211101213924122.png" alt="image-20211101213924122"></p>
<p>b-1.利用burpsuite（bp）修改文件名</p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5/image-20211101214112383.png" alt="image-20211101214112383"></p>
<p>设置代理服务器</p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5/image-20211101214221701.png" alt="image-20211101214221701"></p>
<p>再次上传文件，bp就可以抓到包了</p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5/image-20211101214336153.png" alt="image-20211101214336153"></p>
<p>bp抓到包后，将数据包发送到repeater进行修改文件名</p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5/image-20211101214551332.png"></p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5/image-20211101214806865.png" alt="image-20211101214806865"></p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5/image-20211101214835002.png" alt="image-20211101214835002"></p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5/image-20211101214937162.png" alt="image-20211101214937162"></p>
<p>每次利用这个修改名字的漏洞都要进行b-2的操作；因为网站重定向了</p>
<p>b-2再次利用漏洞</p>
<p>先打开bp的中断</p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5/image-20211101215258926.png" alt="image-20211101215258926"></p>
<p>上传文件</p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5/image-20211101215331883.png" alt="image-20211101215331883"></p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5/image-20211101215406955.png" alt="image-20211101215406955"></p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5/image-20211101215431891.png" alt="image-20211101215431891"></p>
<h3 id="步骤4：制作webshell并监听"><a href="#步骤4：制作webshell并监听" class="headerlink" title="步骤4：制作webshell并监听"></a>步骤4：制作webshell并监听</h3><p>这里靶场地址改为了192.168.1.107，攻击机地址（kali）地址为192.168.1.106.（按你当前的地址来操作即可）</p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5/image-20211101215958651.png" alt="image-20211101215958651"></p>
<p>a.制作webshell</p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5/image-20211101220604585.png" alt="image-20211101220604585"></p>
<p>生成webshell</p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5/image-20211101220811284.png" alt="image-20211101220811284"></p>
<p>启动apache服务</p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5/image-20211101220938918.png" alt="image-20211101220938918"></p>
<p>b.启动监听</p>
<p>启动msf</p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5/image-20211101220032380.png" alt="image-20211101220032380"></p>
<p>使用渗透模块</p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5/image-20211101220115715.png" alt="image-20211101220115715"></p>
<p>设置playload</p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5/image-20211101220307314.png" alt="image-20211101220307314"></p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5/image-20211101220324200.png" alt="image-20211101220324200"></p>
<p>启动监听</p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5/image-20211101220337898.png" alt="image-20211101220337898"></p>
<h3 id="步骤5：上传webshell并反弹shell"><a href="#步骤5：上传webshell并反弹shell" class="headerlink" title="步骤5：上传webshell并反弹shell"></a>步骤5：上传webshell并反弹shell</h3><p>a.绕过防火墙上传shell</p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5/image-20211101221359723.png" alt="image-20211101221359723"></p>
<p>绕过方法：编译法</p>
<p>编码</p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5/image-20211101221459154.png" alt="image-20211101221459154"></p>
<p>b.执行步骤3的b-2操作</p>
<p>把上面编码的3句译码，加上解码命令作为文件名进行操作；</p>
<p>第一句（上传shell）</p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5/image-20211101221914887.png" alt="image-20211101221914887"></p>
<p>第二句（修改文件权限）执行b-2同样的操作后，再修改文件名</p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5/image-20211101222059408.png" alt="image-20211101222059408"></p>
<p>第三句（触发并反弹shell）</p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5/image-20211101222149941.png" alt="image-20211101222149941"></p>
<p>获取到shell</p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5/image-20211101222252658.png" alt="image-20211101222252658"></p>
<h3 id="步骤6：提权"><a href="#步骤6：提权" class="headerlink" title="步骤6：提权"></a>步骤6：提权</h3><p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5/image-20211101222324377.png" alt="image-20211101222324377"></p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5/image-20211101222507358.png" alt="image-20211101222507358"></p>
<p>提权</p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5/image-20211101222625348.png" alt="image-20211101222625348"></p>
<h3 id="步骤7：获取flag"><a href="#步骤7：获取flag" class="headerlink" title="步骤7：获取flag"></a>步骤7：获取flag</h3><p>flag往往都是在root目录下的</p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5/image-20211101222729074.png" alt="image-20211101222729074"></p>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5/image-20211101222748535.png" alt="image-20211101222748535"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wgc5.gitee.io/2021/11/26/SMB%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="北极星上的稻草人">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="北极星上的稻草人">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/11/26/SMB%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/" class="post-title-link" itemprop="url">SMB信息泄露</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2021-11-26 11:14:58 / 修改时间：11:15:27" itemprop="dateCreated datePublished" datetime="2021-11-26T11:14:58+08:00">2021-11-26</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CTF/" itemprop="url" rel="index"><span itemprop="name">CTF</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="SMB信息泄露"><a href="#SMB信息泄露" class="headerlink" title="SMB信息泄露"></a>SMB信息泄露</h1><h3 id="SMB介绍"><a href="#SMB介绍" class="headerlink" title="SMB介绍"></a>SMB介绍</h3><p><img src="/2021/11/26/SMB%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/image-20211030101913702.png" alt="image-20211030101913702"></p>
<h5 id><a href="#" class="headerlink" title></a><img src="/2021/11/26/SMB%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/image-20211030101924259.png" alt="image-20211030101924259"></h5><h4 id="步骤一：信息探测"><a href="#步骤一：信息探测" class="headerlink" title="步骤一：信息探测"></a>步骤一：信息探测</h4><p><img src="/2021/11/26/SMB%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/image-20211030102016861.png" alt="image-20211030102016861"></p>
<p><img src="/2021/11/26/SMB%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/image-20211030102119677.png" alt="image-20211030102119677"></p>
<h4 id="步骤二：分析探测结果"><a href="#步骤二：分析探测结果" class="headerlink" title="步骤二：分析探测结果"></a>步骤二：分析探测结果</h4><p><img src="/2021/11/26/SMB%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/image-20211030102248592.png" alt="image-20211030102248592"></p>
<h5 id="针对SMB协议弱点分析"><a href="#针对SMB协议弱点分析" class="headerlink" title="针对SMB协议弱点分析"></a>针对SMB协议弱点分析</h5><p><img src="/2021/11/26/SMB%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/image-20211030102341391.png" alt="image-20211030102341391"></p>
<p>a、smbclient -L IP：扫描出对应IP地址的主机共享的文件夹</p>
<p><img src="/2021/11/26/SMB%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/image-20211030102710161.png" alt="image-20211030102710161"></p>
<p>b、smbclient  ‘\\IP\$share’：查看对应IP主机上的共享文件（share指文件名）</p>
<p><img src="/2021/11/26/SMB%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/image-20211030103200184.png" alt="image-20211030103200184"></p>
<p>c、get （敏感信息）文件名：下载文件</p>
<p>这里是在share文件夹里下载，这里找到了一个password 12345</p>
<p><img src="/2021/11/26/SMB%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/image-20211030103445542.png" alt="image-20211030103445542"></p>
<p>继续探测，看看还有没有其他的敏感信息</p>
<p><img src="/2021/11/26/SMB%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/image-20211030103743667.png" alt="image-20211030103743667"></p>
<p><img src="/2021/11/26/SMB%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/image-20211030103932330.png" alt="image-20211030103932330"></p>
<p><img src="/2021/11/26/SMB%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/image-20211030104035643.png" alt="image-20211030104035643"></p>
<p>前面我们探测得知：靶机的数据库端口和ssh端口是开放的</p>
<p><img src="/2021/11/26/SMB%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/image-20211030104132817.png" alt="image-20211030104132817"></p>
<p><img src="/2021/11/26/SMB%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/image-20211030104556774.png" alt="image-20211030104556774"></p>
<p>尝试远程服务登录：远程登录数据库和远程登录SSH服务（这里尝试/登录失败）</p>
<p><img src="/2021/11/26/SMB%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/image-20211030104703042.png" alt="image-20211030104703042"></p>
<p>d、searchsploit samba 版本号：查看某个版本号的SMB协议是否有漏洞（溢出）</p>
<p><img src="/2021/11/26/SMB%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/image-20211030105045103.png" alt="image-20211030105045103"></p>
<p>版本号</p>
<p><img src="/2021/11/26/SMB%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/image-20211030105123129.png" alt="image-20211030105123129"></p>
<p>查看是否有漏洞（这里没探测出漏洞），如果有，可以（用MSF）直接利用漏洞获取靶场权限</p>
<p><img src="/2021/11/26/SMB%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/image-20211030105228385.png" alt="image-20211030105228385"></p>
<h5 id="针对HTTP协议弱点分析"><a href="#针对HTTP协议弱点分析" class="headerlink" title="针对HTTP协议弱点分析"></a>针对HTTP协议弱点分析</h5><p><img src="/2021/11/26/SMB%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/image-20211030105355602.png" alt="image-20211030105355602"></p>
<p>a、使用（dirb 网址）探测</p>
<p><img src="/2021/11/26/SMB%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/image-20211030105553230.png" alt="image-20211030105553230"></p>
<p><img src="/2021/11/26/SMB%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/image-20211030105650271.png" alt="image-20211030105650271"></p>
<p><img src="/2021/11/26/SMB%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/image-20211030105800422.png" alt="image-20211030105800422"></p>
<p>登录到了服务器后台</p>
<p><img src="/2021/11/26/SMB%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/image-20211030105832721.png" alt="image-20211030105832721"></p>
<h6 id="制作并在服务器后台安装一句话木马进行反弹shell"><a href="#制作并在服务器后台安装一句话木马进行反弹shell" class="headerlink" title="制作并在服务器后台安装一句话木马进行反弹shell"></a>制作并在服务器后台安装一句话木马进行反弹shell</h6><p>制作一句话木马（webshell）</p>
<p><img src="/2021/11/26/SMB%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/image-20211030105950502.png" alt="image-20211030105950502"></p>
<p><img src="/2021/11/26/SMB%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/image-20211030110404745.png" alt="image-20211030110404745"></p>
<p><img src="/2021/11/26/SMB%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/image-20211030110426623.png" alt="image-20211030110426623"></p>
<p>设置payload（用msf）</p>
<p><img src="/2021/11/26/SMB%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/image-20211030110546385.png" alt="image-20211030110546385"></p>
<p><img src="/2021/11/26/SMB%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/image-20211030110641650.png" alt="image-20211030110641650"></p>
<p>（lhost是攻击机得地址，不是靶机的地址）</p>
<p>启动监听，等待上钩</p>
<p><img src="/2021/11/26/SMB%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/image-20211030110745695.png" alt="image-20211030110745695"></p>
<h6 id="上传webshell"><a href="#上传webshell" class="headerlink" title="上传webshell"></a>上传webshell</h6><p><img src="/2021/11/26/SMB%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/image-20211030110902537.png" alt="image-20211030110902537"></p>
<p>twentyfourteen：主机号</p>
<p><img src="/2021/11/26/SMB%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/image-20211030111103666.png" alt="image-20211030111103666"></p>
<p>这里是fifteen；当有用户点击/输入了上述的“执行网址”，kali就会建立链接</p>
<p><img src="/2021/11/26/SMB%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/image-20211030111254407.png" alt="image-20211030111254407"></p>
<p><img src="/2021/11/26/SMB%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/image-20211030111442356.png" alt="image-20211030111442356"></p>
<h4 id="步骤三：查看flag信息"><a href="#步骤三：查看flag信息" class="headerlink" title="步骤三：查看flag信息"></a>步骤三：查看flag信息</h4><p><img src="/2021/11/26/SMB%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/image-20211030111549145.png" alt="image-20211030111549145"></p>
<p> 优化并查找home目录下的用户名</p>
<p><img src="/2021/11/26/SMB%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/image-20211030111816200.png" alt="image-20211030111816200"></p>
<p>提权（home目录下的账号togie）</p>
<p><img src="/2021/11/26/SMB%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/image-20211030112056550.png" alt="image-20211030112056550"></p>
<p><img src="/2021/11/26/SMB%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/image-20211030112259423.png" alt="image-20211030112259423"></p>
<p>查看flag</p>
<p>到根目录下寻找flag相关的文件，并查看</p>
<p><img src="/2021/11/26/SMB%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/image-20211030112455807.png" alt="image-20211030112455807"></p>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p><img src="/2021/11/26/SMB%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/image-20211030112520034.png" alt="image-20211030112520034"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wgc5.gitee.io/2021/11/26/FTP%E6%9C%8D%E5%8A%A1%E5%90%8E%E9%97%A8%E5%88%A9%E7%94%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="北极星上的稻草人">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="北极星上的稻草人">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/11/26/FTP%E6%9C%8D%E5%8A%A1%E5%90%8E%E9%97%A8%E5%88%A9%E7%94%A8/" class="post-title-link" itemprop="url">FTP服务后门利用</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-11-26 11:14:11" itemprop="dateCreated datePublished" datetime="2021-11-26T11:14:11+08:00">2021-11-26</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-02-28 10:31:13" itemprop="dateModified" datetime="2023-02-28T10:31:13+08:00">2023-02-28</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CTF/" itemprop="url" rel="index"><span itemprop="name">CTF</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="FTP服务后门利用"><a href="#FTP服务后门利用" class="headerlink" title="FTP服务后门利用"></a>FTP服务后门利用</h1><p>FTP介绍</p>
<p><img src="/2021/11/26/FTP%E6%9C%8D%E5%8A%A1%E5%90%8E%E9%97%A8%E5%88%A9%E7%94%A8/image-20211030144942876.png" alt="image-20211030144942876"></p>
<p><img src="/2021/11/26/FTP%E6%9C%8D%E5%8A%A1%E5%90%8E%E9%97%A8%E5%88%A9%E7%94%A8/image-20211030144952819.png" alt="image-20211030144952819"></p>
<p>靶场机器系统：Ubuntu</p>
<h3 id="步骤1：信息探测"><a href="#步骤1：信息探测" class="headerlink" title="步骤1：信息探测"></a>步骤1：信息探测</h3><p><img src="/2021/11/26/FTP%E6%9C%8D%E5%8A%A1%E5%90%8E%E9%97%A8%E5%88%A9%E7%94%A8/image-20211030145128505.png" alt="image-20211030145128505"></p>
<p><img src="/2021/11/26/FTP%E6%9C%8D%E5%8A%A1%E5%90%8E%E9%97%A8%E5%88%A9%E7%94%A8/image-20211030145303905.png" alt="image-20211030145303905"></p>
<p>ProFTPD是ftp服务的软件，1.3.3c是版本号</p>
<h3 id="步骤2：发现漏洞"><a href="#步骤2：发现漏洞" class="headerlink" title="步骤2：发现漏洞"></a>步骤2：发现漏洞</h3><p>分析nmap扫描结果，并对结果进行分析，挖掘可以利用的信息；</p>
<p>使用seachsploit，查看漏洞信息，找到可以利用的溢出代码。</p>
<p><img src="/2021/11/26/FTP%E6%9C%8D%E5%8A%A1%E5%90%8E%E9%97%A8%E5%88%A9%E7%94%A8/image-20211030145812179.png" alt="image-20211030145812179"></p>
<p>这里发现第二漏洞是metasploit自带的模块，因此利用该漏洞</p>
<h5 id="使用metasploit进行溢出"><a href="#使用metasploit进行溢出" class="headerlink" title="使用metasploit进行溢出"></a>使用metasploit进行溢出</h5><p><img src="/2021/11/26/FTP%E6%9C%8D%E5%8A%A1%E5%90%8E%E9%97%A8%E5%88%A9%E7%94%A8/image-20211030150215512.png" alt="image-20211030150215512"></p>
<p><img src="/2021/11/26/FTP%E6%9C%8D%E5%8A%A1%E5%90%8E%E9%97%A8%E5%88%A9%E7%94%A8/image-20211030150515781.png" alt="image-20211030150515781"></p>
<p><img src="/2021/11/26/FTP%E6%9C%8D%E5%8A%A1%E5%90%8E%E9%97%A8%E5%88%A9%E7%94%A8/image-20211030150649626.png" alt="image-20211030150649626"></p>
<p><img src="/2021/11/26/FTP%E6%9C%8D%E5%8A%A1%E5%90%8E%E9%97%A8%E5%88%A9%E7%94%A8/image-20211030150759026.png" alt="image-20211030150759026"></p>
<h3 id="步骤3：获取flag"><a href="#步骤3：获取flag" class="headerlink" title="步骤3：获取flag"></a>步骤3：获取flag</h3><p><img src="/2021/11/26/FTP%E6%9C%8D%E5%8A%A1%E5%90%8E%E9%97%A8%E5%88%A9%E7%94%A8/image-20211030150840413.png" alt="image-20211030150840413"></p>
<p><img src="/2021/11/26/FTP%E6%9C%8D%E5%8A%A1%E5%90%8E%E9%97%A8%E5%88%A9%E7%94%A8/image-20211030150916007.png" alt="image-20211030150916007"></p>
<p><img src="/2021/11/26/FTP%E6%9C%8D%E5%8A%A1%E5%90%8E%E9%97%A8%E5%88%A9%E7%94%A8/image-20211030151032530.png" alt="image-20211030151032530"></p>
<p>ls 列出目录，-al表示列出全部，h展示文件大小</p>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p><img src="/2021/11/26/FTP%E6%9C%8D%E5%8A%A1%E5%90%8E%E9%97%A8%E5%88%A9%E7%94%A8/image-20211030151120506.png" alt="image-20211030151120506"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wgc5.gitee.io/2021/11/26/SQL%E6%B3%A8%E5%85%A5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="北极星上的稻草人">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="北极星上的稻草人">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/" class="post-title-link" itemprop="url">SQL注入</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2021-11-26 11:13:12 / 修改时间：11:13:49" itemprop="dateCreated datePublished" datetime="2021-11-26T11:13:12+08:00">2021-11-26</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CTF/" itemprop="url" rel="index"><span itemprop="name">CTF</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="SQL注入"><a href="#SQL注入" class="headerlink" title="SQL注入"></a>SQL注入</h1><h3 id="sql介绍"><a href="#sql介绍" class="headerlink" title="sql介绍"></a>sql介绍</h3><p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030195103555.png" alt="image-20211030195103555"></p>
<h3 id="SQL注入：get"><a href="#SQL注入：get" class="headerlink" title="SQL注入：get"></a>SQL注入：get</h3><p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030195206062.png" alt="image-20211030195206062"></p>
<h5 id="步骤1：信息探测"><a href="#步骤1：信息探测" class="headerlink" title="步骤1：信息探测"></a>步骤1：信息探测</h5><p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030195430406.png" alt="image-20211030195430406"></p>
<p>nikto是探测http服务的，默认端口是80</p>
<p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030195413097.png" alt="image-20211030195413097"></p>
<h5 id="步骤2：深入挖掘"><a href="#步骤2：深入挖掘" class="headerlink" title="步骤2：深入挖掘"></a>步骤2：深入挖掘</h5><p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030195640496.png" alt="image-20211030195640496"></p>
<p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030195628359.png" alt="image-20211030195628359"></p>
<p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030195658976.png" alt="image-20211030195658976"></p>
<h5 id="步骤3：漏洞扫描"><a href="#步骤3：漏洞扫描" class="headerlink" title="步骤3：漏洞扫描"></a>步骤3：漏洞扫描</h5><p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030195904984.png" alt="image-20211030195904984"></p>
<p>kali自带</p>
<p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030200009064.png" alt="image-20211030200009064"></p>
<p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030200355880.png" alt="image-20211030200355880"></p>
<h5 id="步骤4：漏洞利用"><a href="#步骤4：漏洞利用" class="headerlink" title="步骤4：漏洞利用"></a>步骤4：漏洞利用</h5><p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030201025832.png" alt="image-20211030201025832"></p>
<p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030200617332.png" alt="image-20211030200617332"></p>
<p>利用sqlmap探测有漏洞网址</p>
<p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030200857314.png" alt="image-20211030200857314"></p>
<p>a.查看数据库</p>
<p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030201115476.png" alt="image-20211030201115476"></p>
<p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030201330640.png" alt="image-20211030201330640"></p>
<p>b.查看数据库的表</p>
<p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030201401702.png" alt="image-20211030201401702"></p>
<p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030201503525.png" alt="image-20211030201503525"></p>
<p>c.查看表的列</p>
<p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030201539039.png" alt="image-20211030201539039"></p>
<p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030201631528.png" alt="image-20211030201631528"></p>
<p>d.查看内容（用户名，密码）</p>
<p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030201704046.png" alt="image-20211030201704046"></p>
<p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030201838624.png" alt="image-20211030201838624"></p>
<p>e.登录</p>
<p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030201919623.png" alt="image-20211030201919623"></p>
<p>登录成功（一般都是后台服务器）</p>
<p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030201951643.png" alt="image-20211030201951643"></p>
<h5 id="步骤5：上传shell反弹权限"><a href="#步骤5：上传shell反弹权限" class="headerlink" title="步骤5：上传shell反弹权限"></a>步骤5：上传shell反弹权限</h5><p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030202106015.png" alt="image-20211030202106015"></p>
<p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030202206919.png" alt="image-20211030202206919"></p>
<h6 id="生产一句话木马"><a href="#生产一句话木马" class="headerlink" title="生产一句话木马"></a>生产一句话木马</h6><p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030202303905.png" alt="image-20211030202303905"></p>
<p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030202405758.png" alt="image-20211030202405758"></p>
<h6 id="启动监听"><a href="#启动监听" class="headerlink" title="启动监听"></a>启动监听</h6><p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030202457644.png" alt="image-20211030202457644"></p>
<p>步骤略…（按照上面的提示即可）</p>
<h3 id="SQL注入：post"><a href="#SQL注入：post" class="headerlink" title="SQL注入：post"></a>SQL注入：post</h3><p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030202715197.png" alt="image-20211030202715197"></p>
<p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030202734637.png" alt="image-20211030202734637"></p>
<h5 id="步骤1：信息探测-1"><a href="#步骤1：信息探测-1" class="headerlink" title="步骤1：信息探测"></a>步骤1：信息探测</h5><p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030202838854.png" alt="image-20211030202838854"></p>
<p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030203029825.png" alt="image-20211030203029825"></p>
<h5 id="步骤2：漏洞扫描"><a href="#步骤2：漏洞扫描" class="headerlink" title="步骤2：漏洞扫描"></a>步骤2：漏洞扫描</h5><p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030203138724.png" alt="image-20211030203138724"></p>
<p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030203259464.png" alt="image-20211030203259464"></p>
<p>有时该软件是检测不出来漏洞，但通过扫描有时可以找到。</p>
<p>（登录界面是sql注入敏感界面）</p>
<p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030203441182.png" alt="image-20211030203441182"></p>
<p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030203810208.png" alt="image-20211030203810208"></p>
<h5 id="步骤3：漏洞利用"><a href="#步骤3：漏洞利用" class="headerlink" title="步骤3：漏洞利用"></a>步骤3：漏洞利用</h5><p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030203913929.png" alt="image-20211030203913929"></p>
<p>a.用burp-StartBurp抓包（方法不唯一）</p>
<p>避免端口冲突，这里用8081而不是8080端口</p>
<p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030204207430.png" alt="image-20211030204207430"></p>
<p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030204227407.png" alt="image-20211030204227407"></p>
<p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030204330334.png" alt="image-20211030204330334"></p>
<p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030204416814.png" alt="image-20211030204416814"></p>
<p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030204518260.png" alt="image-20211030204518260"></p>
<p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030204527245.png" alt="image-20211030204527245"></p>
<p>b.探测数据库</p>
<p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030204718382.png" alt="image-20211030204718382"></p>
<p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030204803197.png" alt="image-20211030204803197"></p>
<p>c.探测可疑数据库的表</p>
<p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030204901021.png" alt="image-20211030204901021"></p>
<p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030204914716.png" alt="image-20211030204914716"></p>
<p>d.探测字段</p>
<p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030205004109.png" alt="image-20211030205004109"></p>
<p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030205014868.png" alt="image-20211030205014868"></p>
<p>e.探测字段内容</p>
<p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030205056260.png" alt="image-20211030205056260"></p>
<p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030205111198.png" alt="image-20211030205111198"></p>
<p>f.利用数据库获取到的用户名和密码</p>
<p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030205309461.png" alt="image-20211030205309461"></p>
<p>登录到后台</p>
<p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030205406227.png" alt="image-20211030205406227"></p>
<h5 id="步骤4：上传webshell获取控制权（另外一种方法：kali自带）"><a href="#步骤4：上传webshell获取控制权（另外一种方法：kali自带）" class="headerlink" title="步骤4：上传webshell获取控制权（另外一种方法：kali自带）"></a>步骤4：上传webshell获取控制权（另外一种方法：kali自带）</h5><h6 id="制作wenshell"><a href="#制作wenshell" class="headerlink" title="制作wenshell"></a>制作wenshell</h6><p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030210638514.png" alt="image-20211030210638514"></p>
<p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030205649760.png" alt="image-20211030205649760"></p>
<p>复制到桌面</p>
<p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030205758479.png" alt="image-20211030205758479"></p>
<p>注意：需要修改该webshell的shell返回地址</p>
<p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030205845387.png" alt="image-20211030205845387"></p>
<p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030205956630.png" alt="image-20211030205956630"></p>
<h6 id="上传webshell"><a href="#上传webshell" class="headerlink" title="上传webshell"></a>上传webshell</h6><p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030210603631.png" alt="image-20211030210603631"></p>
<p>主题名twentyhtirteen</p>
<p>监听</p>
<p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030210238468.png" alt="image-20211030210238468"></p>
<p>监听后要访问对应的页面才可以生效</p>
<p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030210421797.png" alt="image-20211030210421797"></p>
<p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030210850545.png" alt="image-20211030210850545"></p>
<h6 id="查看敏感文件（寻找flag）"><a href="#查看敏感文件（寻找flag）" class="headerlink" title="查看敏感文件（寻找flag）"></a>查看敏感文件（寻找flag）</h6><p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030210730741.png" alt="image-20211030210730741"></p>
<p>查看敏感信息是个习惯，尽管这里没有找到flag</p>
<p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030210918431.png" alt="image-20211030210918431"></p>
<p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030210945951.png" alt="image-20211030210945951"></p>
<h6 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h6><p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030211136197.png" alt="image-20211030211136197"></p>
<p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030211039365.png" alt="image-20211030211039365"></p>
<p>获取了root权限后，就去根目录（root目录）寻找flag</p>
<h3 id="SQL注入-X-Forwarded-For报文头"><a href="#SQL注入-X-Forwarded-For报文头" class="headerlink" title="SQL注入-X-Forwarded-For报文头"></a>SQL注入-X-Forwarded-For报文头</h3><p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030211429182.png" alt="image-20211030211429182"></p>
<h5 id="步骤1：信息探测-2"><a href="#步骤1：信息探测-2" class="headerlink" title="步骤1：信息探测"></a>步骤1：信息探测</h5><p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030211518814.png" alt="image-20211030211518814"></p>
<p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030211602431.png" alt="image-20211030211602431"></p>
<p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030211630636.png" alt="image-20211030211630636"></p>
<p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030211721024.png" alt="image-20211030211721024"></p>
<p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030211811665.png" alt="image-20211030211811665"></p>
<h5 id="步骤2：漏洞扫描-1"><a href="#步骤2：漏洞扫描-1" class="headerlink" title="步骤2：漏洞扫描"></a>步骤2：漏洞扫描</h5><p>这里用avws（acunetix），方法不唯一</p>
<p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030211842798.png" alt="image-20211030211842798"></p>
<p>填加目标</p>
<p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030212002249.png" alt="image-20211030212002249"></p>
<p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030212015856.png" alt="image-20211030212015856"></p>
<p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030212108734.png" alt="image-20211030212108734"></p>
<p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030212157113.png" alt="image-20211030212157113"></p>
<p>（点击可以查看详情）</p>
<h5 id="步骤3：漏洞利用-1"><a href="#步骤3：漏洞利用-1" class="headerlink" title="步骤3：漏洞利用"></a>步骤3：漏洞利用</h5><p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030213230888.png" alt="image-20211030213230888"></p>
<p>a.探测数据库</p>
<p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030212348421.png" alt="image-20211030212348421"></p>
<p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030212559034.png" alt="image-20211030212559034"></p>
<p>b.探测表</p>
<p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030212622155.png" alt="image-20211030212622155"></p>
<p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030212655679.png" alt="image-20211030212655679"></p>
<p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030212706557.png" alt="image-20211030212706557">.c.探测users表的字段名</p>
<p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030212749052.png" alt="image-20211030212749052"></p>
<p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030212832324.png" alt="image-20211030212832324"></p>
<p>d.探测账号（login）和密码（password）</p>
<p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030212908773.png" alt="image-20211030212908773"></p>
<p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030213119901.png" alt="image-20211030213119901"></p>
<p>e.登录</p>
<p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030213152488.png" alt="image-20211030213152488"></p>
<p>登录到后台服务器</p>
<p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030213211646.png" alt="image-20211030213211646"></p>
<p>下面3个步骤具体过程省略。（与前面的实验一样）</p>
<p>步骤4：上传webshell反弹shell</p>
<p>步骤5：获取shell后提权，</p>
<p>步骤6：获取root权限后，在根目录下找flag.txt文件</p>
<h5 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h5><p><img src="/2021/11/26/SQL%E6%B3%A8%E5%85%A5/image-20211030213512529.png" alt="image-20211030213512529"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wgc5.gitee.io/2021/11/26/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="北极星上的稻草人">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="北极星上的稻草人">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/" class="post-title-link" itemprop="url">命令执行漏洞</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-11-26 11:12:02" itemprop="dateCreated datePublished" datetime="2021-11-26T11:12:02+08:00">2021-11-26</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-02-28 10:29:48" itemprop="dateModified" datetime="2023-02-28T10:29:48+08:00">2023-02-28</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CTF/" itemprop="url" rel="index"><span itemprop="name">CTF</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="命令执行漏洞"><a href="#命令执行漏洞" class="headerlink" title="命令执行漏洞"></a>命令执行漏洞</h1><h3 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h3><p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/image-20211101140937997.png" alt="image-20211101140937997"></p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/image-20211101141003632.png" alt="image-20211101141003632"></p>
<h3 id="步骤一：信息探测"><a href="#步骤一：信息探测" class="headerlink" title="步骤一：信息探测"></a>步骤一：信息探测</h3><p>这次使用图形化界面工具sparta（方法不唯一）</p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/image-20211101141540666.png" alt="image-20211101141540666"></p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/image-20211101141635904.png" alt="image-20211101141635904"></p>
<p>启动软件</p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/image-20211101141655651.png" alt="image-20211101141655651"></p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/image-20211101141832697.png" alt="image-20211101141832697"></p>
<p>软件会进行nmap、nikto、screenshot扫描</p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/image-20211101142025402.png" alt="image-20211101142025402"></p>
<p>点击下面的扫描模块就可以查看详情，也可以单独对某个端口进行扫描</p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/image-20211101142202492.png" alt="image-20211101142202492"></p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/image-20211101142255859.png" alt="image-20211101142255859"></p>
<p>还可以用dirt进行暴力探测</p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/image-20211101142339879.png" alt="image-20211101142339879"></p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/image-20211101142645755.png" alt="image-20211101142645755"></p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/image-20211101142844851.png" alt="image-20211101142844851"></p>
<p>（这里展示的目录结果是没有探测完毕的，只是一部分）</p>
<h3 id="步骤2：深入挖掘"><a href="#步骤2：深入挖掘" class="headerlink" title="步骤2：深入挖掘"></a>步骤2：深入挖掘</h3><p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/image-20211101143032178.png" alt="image-20211101143032178"></p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/image-20211101143039928.png" alt="image-20211101143039928"></p>
<p>由dirt探测到的目录，发现了admin目录</p>
<p>（先查看根目录）</p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/image-20211101143152281.png" alt="image-20211101143152281"></p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/image-20211101143016291.png" alt="image-20211101143016291"></p>
<p>由nikto探测，发现了/dev/敏感目录</p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/image-20211101143305976.png" alt="image-20211101143305976"></p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/image-20211101143400181.png" alt="image-20211101143400181"></p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/image-20211101143432624.png" alt="image-20211101143432624"></p>
<p>对敏感页面，要查看源代码（注释，审计（输入界面）等等），如主页、登录界面、跳转的页面</p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/image-20211101144058602.png" alt="image-20211101144058602"></p>
<p>/dev/界面</p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/image-20211101144346774.png" alt="image-20211101144346774"></p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/image-20211101144544122.png" alt="image-20211101144544122"></p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/image-20211101144758385.png" alt="image-20211101144758385"></p>
<p>登录成功</p>
<h3 id="步骤3：漏洞利用"><a href="#步骤3：漏洞利用" class="headerlink" title="步骤3：漏洞利用"></a>步骤3：漏洞利用</h3><p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/image-20211101144916499.png" alt="image-20211101144916499"></p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/image-20211101144943217.png" alt="image-20211101144943217"></p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/image-20211101145031778.png" alt="image-20211101145031778"></p>
<p>全扫描</p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/image-20211101145059553.png" alt="image-20211101145059553"></p>
<p>扫描结果并没有发现高危漏洞或可直接利用的简单漏洞（对于需要登录的网站，不提供用户名和密码，只会扫描到登录前的界面）</p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/image-20211101145325404.png" alt="image-20211101145325404"></p>
<p>再回头查看探测内容</p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/image-20211101145537120.png" alt="image-20211101145537120"></p>
<p>由于我们登录成功了</p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/image-20211101145614993.png" alt="image-20211101145614993"></p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/image-20211101145722635.png" alt="image-20211101145722635"></p>
<h3 id="步骤4：反弹shell"><a href="#步骤4：反弹shell" class="headerlink" title="步骤4：反弹shell"></a>步骤4：反弹shell</h3><p>从步骤3结果可以知道，该网站以及上传了webshell；所以我们直接反弹shell即可</p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/image-20211101145854848.png" alt="image-20211101145854848"></p>
<p>启动监听</p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/image-20211101145921584.png" alt="image-20211101145921584"></p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/image-20211101150020356.png" alt="image-20211101150020356"></p>
<p>回到kali就可以发现获取了shell</p>
<p>返回终端</p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/image-20211101150130208.png" alt="image-20211101150130208"></p>
<h3 id="步骤5：提权root权限"><a href="#步骤5：提权root权限" class="headerlink" title="步骤5：提权root权限"></a>步骤5：提权root权限</h3><p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/image-20211101190231269.png" alt="image-20211101190231269"></p>
<p>寻找可疑文件</p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/image-20211101150646707.png" alt="image-20211101150646707"></p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/image-20211101150836715.png" alt="image-20211101150836715"></p>
<p>（小编没看懂有什么用）</p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/image-20211101150932839.png" alt="image-20211101150932839"></p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/image-20211101181541134.png" alt="image-20211101181541134"></p>
<p>为什么是这个密码，小编也没看懂。</p>
<p>提权</p>
<p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/image-20211101190112908.png" alt="image-20211101190112908"></p>
<h3 id="步骤6：获取flag"><a href="#步骤6：获取flag" class="headerlink" title="步骤6：获取flag"></a>步骤6：获取flag</h3><p><img src="/2021/11/26/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/image-20211101190301542.png" alt="image-20211101190301542"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wgc5.gitee.io/2021/11/26/%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="北极星上的稻草人">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="北极星上的稻草人">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/11/26/%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/" class="post-title-link" itemprop="url">目录遍历漏洞</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2021-11-26 11:11:11 / 修改时间：11:11:43" itemprop="dateCreated datePublished" datetime="2021-11-26T11:11:11+08:00">2021-11-26</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CTF/" itemprop="url" rel="index"><span itemprop="name">CTF</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="目录遍历漏洞"><a href="#目录遍历漏洞" class="headerlink" title="目录遍历漏洞"></a>目录遍历漏洞</h1><h3 id="目录遍历漏洞介绍"><a href="#目录遍历漏洞介绍" class="headerlink" title="目录遍历漏洞介绍"></a>目录遍历漏洞介绍</h3><p><img src="/2021/11/26/%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/image-20211031145326806.png" alt="image-20211031145326806"></p>
<p><img src="/2021/11/26/%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/image-20211031145407982.png" alt="image-20211031145407982"></p>
<h4 id="步骤1：信息探测"><a href="#步骤1：信息探测" class="headerlink" title="步骤1：信息探测"></a>步骤1：信息探测</h4><p><img src="/2021/11/26/%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/image-20211031145509894.png" alt="image-20211031145509894"></p>
<p><img src="/2021/11/26/%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/image-20211031145447840.png" alt="image-20211031145447840"></p>
<p><img src="/2021/11/26/%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/image-20211031145810901.png" alt="image-20211031145810901"></p>
<h4 id="步骤2：深入挖掘"><a href="#步骤2：深入挖掘" class="headerlink" title="步骤2：深入挖掘"></a>步骤2：深入挖掘</h4><p><img src="/2021/11/26/%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/image-20211031145606936.png" alt="image-20211031145606936"></p>
<p><img src="/2021/11/26/%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/image-20211031145615519.png" alt="image-20211031145615519"></p>
<p><img src="/2021/11/26/%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/image-20211031145845492.png" alt="image-20211031145845492"></p>
<p><img src="/2021/11/26/%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/image-20211031145913903.png" alt="image-20211031145913903"></p>
<h4 id="步骤3：漏洞扫描"><a href="#步骤3：漏洞扫描" class="headerlink" title="步骤3：漏洞扫描"></a>步骤3：漏洞扫描</h4><p><img src="/2021/11/26/%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/image-20211031145947445.png" alt="image-20211031145947445"></p>
<p><img src="/2021/11/26/%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/image-20211031150111960.png" alt="image-20211031150111960"></p>
<p><img src="/2021/11/26/%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/image-20211031150319083.png" alt="image-20211031150319083"></p>
<p><img src="/2021/11/26/%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/image-20211031150529431.png" alt="image-20211031150529431"></p>
<p><img src="/2021/11/26/%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/image-20211031150600534.png" alt="image-20211031150600534"></p>
<p>由此可以知道，该网站是存在路径遍历漏洞的。于是利用该原理（…/etc/passwd）进行获取信息。</p>
<h6 id="分析漏洞扫描结果（利用漏洞）"><a href="#分析漏洞扫描结果（利用漏洞）" class="headerlink" title="分析漏洞扫描结果（利用漏洞）"></a>分析漏洞扫描结果（利用漏洞）</h6><p><img src="/2021/11/26/%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/image-20211031150812168.png" alt="image-20211031150812168"></p>
<h4 id="步骤4：敏感页面上传webshell"><a href="#步骤4：敏感页面上传webshell" class="headerlink" title="步骤4：敏感页面上传webshell"></a>步骤4：敏感页面上传webshell</h4><p><img src="/2021/11/26/%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/image-20211031152024169.png" alt="image-20211031152024169"></p>
<p><strong>a.寻找并登录敏感页面</strong></p>
<p><img src="/2021/11/26/%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/image-20211031151044287.png" alt="image-20211031151044287"></p>
<p>b.<strong>查找可以利用的写webshell的点</strong></p>
<p>一般是都是后台站点，这里用弱口令登录成功就进了数据库后台</p>
<p><img src="/2021/11/26/%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/image-20211031151814888.png" alt="image-20211031151814888"></p>
<p><strong>c.使用/usr/share/webshell/php/下的webshell</strong></p>
<p><img src="/2021/11/26/%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/image-20211031151418332.png" alt="image-20211031151418332"></p>
<p><img src="/2021/11/26/%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/image-20211031151536728.png" alt="image-20211031151536728"></p>
<p><img src="/2021/11/26/%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/image-20211031151619899.png" alt="image-20211031151619899"></p>
<p><strong>d.新建数据库，表，字段；上传并启动webshell</strong></p>
<p><img src="/2021/11/26/%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/image-20211031152123371.png" alt="image-20211031152123371"></p>
<p><img src="/2021/11/26/%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/image-20211031152205549.png" alt="image-20211031152205549"></p>
<p><img src="/2021/11/26/%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/image-20211031152530658.png" alt="image-20211031152530658"></p>
<p><img src="/2021/11/26/%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/image-20211031152618948.png" alt="image-20211031152618948"></p>
<p>上面的define value值如下</p>
<p><img src="/2021/11/26/%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/image-20211031152920720.png" alt="image-20211031152920720"></p>
<p><img src="/2021/11/26/%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/image-20211031153043743.png" alt="image-20211031153043743"></p>
<p>步骤5：监听并反弹shell </p>
<p><img src="/2021/11/26/%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/image-20211031153148658.png" alt="image-20211031153148658"></p>
<p><img src="/2021/11/26/%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/image-20211031152449254.png" alt="image-20211031152449254"></p>
<p>启动监听</p>
<p><img src="/2021/11/26/%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/image-20211031153136075.png" alt="image-20211031153136075"></p>
<p>触发webshell</p>
<p><img src="/2021/11/26/%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/image-20211031153301143.png" alt="image-20211031153301143"></p>
<p><img src="/2021/11/26/%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/image-20211031153331763.png" alt="image-20211031153331763"></p>
<p><img src="/2021/11/26/%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/image-20211031153513748.png" alt="image-20211031153513748"></p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p><img src="/2021/11/26/%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/image-20211031153528845.png" alt="image-20211031153528845"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wgc5.gitee.io/2021/11/26/%E4%B8%AD%E9%97%B4%E4%BB%B6PUT%E6%BC%8F%E6%B4%9E/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="北极星上的稻草人">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="北极星上的稻草人">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/11/26/%E4%B8%AD%E9%97%B4%E4%BB%B6PUT%E6%BC%8F%E6%B4%9E/" class="post-title-link" itemprop="url">中间件PUT漏洞</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2021-11-26 11:10:05 / 修改时间：11:10:54" itemprop="dateCreated datePublished" datetime="2021-11-26T11:10:05+08:00">2021-11-26</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CTF/" itemprop="url" rel="index"><span itemprop="name">CTF</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="中间件PUT漏洞"><a href="#中间件PUT漏洞" class="headerlink" title="中间件PUT漏洞"></a>中间件PUT漏洞</h1><h3 id="中间件PUT漏洞介绍"><a href="#中间件PUT漏洞介绍" class="headerlink" title="中间件PUT漏洞介绍"></a>中间件PUT漏洞介绍</h3><p><img src="/2021/11/26/%E4%B8%AD%E9%97%B4%E4%BB%B6PUT%E6%BC%8F%E6%B4%9E/image-20211101190633407.png" alt="image-20211101190633407"></p>
<p><img src="/2021/11/26/%E4%B8%AD%E9%97%B4%E4%BB%B6PUT%E6%BC%8F%E6%B4%9E/image-20211101190711037.png" alt="image-20211101190711037"></p>
<h3 id="步骤1：信息探测"><a href="#步骤1：信息探测" class="headerlink" title="步骤1：信息探测"></a>步骤1：信息探测</h3><p><img src="/2021/11/26/%E4%B8%AD%E9%97%B4%E4%BB%B6PUT%E6%BC%8F%E6%B4%9E/image-20211101190813705.png" alt="image-20211101190813705"></p>
<p><img src="/2021/11/26/%E4%B8%AD%E9%97%B4%E4%BB%B6PUT%E6%BC%8F%E6%B4%9E/image-20211101191127170.png" alt="image-20211101191127170"></p>
<p><img src="/2021/11/26/%E4%B8%AD%E9%97%B4%E4%BB%B6PUT%E6%BC%8F%E6%B4%9E/image-20211101192439328.png" alt="image-20211101192439328"></p>
<p><img src="/2021/11/26/%E4%B8%AD%E9%97%B4%E4%BB%B6PUT%E6%BC%8F%E6%B4%9E/image-20211101191209867.png" alt="image-20211101191209867"></p>
<h3 id="步骤2：深入挖掘"><a href="#步骤2：深入挖掘" class="headerlink" title="步骤2：深入挖掘"></a>步骤2：深入挖掘</h3><p><img src="/2021/11/26/%E4%B8%AD%E9%97%B4%E4%BB%B6PUT%E6%BC%8F%E6%B4%9E/image-20211101191017554.png" alt="image-20211101191017554"></p>
<p><img src="/2021/11/26/%E4%B8%AD%E9%97%B4%E4%BB%B6PUT%E6%BC%8F%E6%B4%9E/image-20211101191029331.png" alt="image-20211101191029331"></p>
<p>（这里没有发现有用的东西）</p>
<h3 id="步骤3：漏洞扫描"><a href="#步骤3：漏洞扫描" class="headerlink" title="步骤3：漏洞扫描"></a>步骤3：漏洞扫描</h3><p><img src="/2021/11/26/%E4%B8%AD%E9%97%B4%E4%BB%B6PUT%E6%BC%8F%E6%B4%9E/image-20211101192145310.png" alt="image-20211101192145310"></p>
<p>启动</p>
<p><img src="/2021/11/26/%E4%B8%AD%E9%97%B4%E4%BB%B6PUT%E6%BC%8F%E6%B4%9E/image-20211101192205795.png" alt="image-20211101192205795"></p>
<p><img src="/2021/11/26/%E4%B8%AD%E9%97%B4%E4%BB%B6PUT%E6%BC%8F%E6%B4%9E/image-20211101192321798.png" alt="image-20211101192321798"></p>
<p><img src="/2021/11/26/%E4%B8%AD%E9%97%B4%E4%BB%B6PUT%E6%BC%8F%E6%B4%9E/image-20211101192350669.png" alt="image-20211101192350669"></p>
<p>（这里也没有发现一些特别有用的信息）</p>
<h4 id="测试PUT漏洞"><a href="#测试PUT漏洞" class="headerlink" title="测试PUT漏洞"></a>测试PUT漏洞</h4><p><img src="/2021/11/26/%E4%B8%AD%E9%97%B4%E4%BB%B6PUT%E6%BC%8F%E6%B4%9E/image-20211101192654900.png" alt="image-20211101192654900"></p>
<p>制作webshell</p>
<p><img src="/2021/11/26/%E4%B8%AD%E9%97%B4%E4%BB%B6PUT%E6%BC%8F%E6%B4%9E/image-20211101192846917.png" alt="image-20211101192846917"></p>
<p><img src="/2021/11/26/%E4%B8%AD%E9%97%B4%E4%BB%B6PUT%E6%BC%8F%E6%B4%9E/image-20211101193010519.png" alt="image-20211101193010519"></p>
<h3 id="步骤4：上传webshell"><a href="#步骤4：上传webshell" class="headerlink" title="步骤4：上传webshell"></a>步骤4：上传webshell</h3><p><img src="/2021/11/26/%E4%B8%AD%E9%97%B4%E4%BB%B6PUT%E6%BC%8F%E6%B4%9E/image-20211101194033989.png" alt="image-20211101194033989"></p>
<p>python -c  “ import pty;pty.spawn(‘/bin/bash’)”;图片出少了“/”</p>
<p><img src="/2021/11/26/%E4%B8%AD%E9%97%B4%E4%BB%B6PUT%E6%BC%8F%E6%B4%9E/image-20211101193136053.png" alt="image-20211101193136053"></p>
<p><img src="/2021/11/26/%E4%B8%AD%E9%97%B4%E4%BB%B6PUT%E6%BC%8F%E6%B4%9E/image-20211101193306697.png" alt="image-20211101193306697"></p>
<p><img src="/2021/11/26/%E4%B8%AD%E9%97%B4%E4%BB%B6PUT%E6%BC%8F%E6%B4%9E/image-20211101193321252.png" alt="image-20211101193321252"></p>
<p>启动监听</p>
<p><img src="/2021/11/26/%E4%B8%AD%E9%97%B4%E4%BB%B6PUT%E6%BC%8F%E6%B4%9E/image-20211101193451427.png" alt="image-20211101193451427"></p>
<p>触发webshell</p>
<p><img src="/2021/11/26/%E4%B8%AD%E9%97%B4%E4%BB%B6PUT%E6%BC%8F%E6%B4%9E/image-20211101193521178.png" alt="image-20211101193521178"></p>
<p><img src="/2021/11/26/%E4%B8%AD%E9%97%B4%E4%BB%B6PUT%E6%BC%8F%E6%B4%9E/image-20211101193622565.png" alt="image-20211101193622565"></p>
<p>启动终端</p>
<p><img src="/2021/11/26/%E4%B8%AD%E9%97%B4%E4%BB%B6PUT%E6%BC%8F%E6%B4%9E/image-20211101193703601.png" alt="image-20211101193703601"></p>
<p>步骤5：提权（过程略）</p>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p><img src="/2021/11/26/%E4%B8%AD%E9%97%B4%E4%BB%B6PUT%E6%BC%8F%E6%B4%9E/image-20211101193759180.png" alt="image-20211101193759180"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wgc5.gitee.io/2021/11/26/CTF%E6%B8%97%E9%80%8F%E5%BC%95%E5%85%A5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="北极星上的稻草人">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="北极星上的稻草人">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/11/26/CTF%E6%B8%97%E9%80%8F%E5%BC%95%E5%85%A5/" class="post-title-link" itemprop="url">CTF渗透引入</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-11-26 11:08:09" itemprop="dateCreated datePublished" datetime="2021-11-26T11:08:09+08:00">2021-11-26</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-02-28 10:28:47" itemprop="dateModified" datetime="2023-02-28T10:28:47+08:00">2023-02-28</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CTF/" itemprop="url" rel="index"><span itemprop="name">CTF</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="CTF渗透引入"><a href="#CTF渗透引入" class="headerlink" title="CTF渗透引入"></a>CTF渗透引入</h1><p><img src="/2021/11/26/CTF%E6%B8%97%E9%80%8F%E5%BC%95%E5%85%A5/image-20211030153041568.png" alt="image-20211030153041568"></p>
<p><strong>一般渗透步骤：</strong>信息探测-&gt;深入探测-&gt;信息分析-&gt;</p>
<p>​                        （协议弱点利用-&gt;寻找协议软件版本漏洞-&gt;爆力破解）-&gt;获取flag</p>
<h3 id="步骤1：信息探测"><a href="#步骤1：信息探测" class="headerlink" title="步骤1：信息探测"></a>步骤1：信息探测</h3><p><img src="/2021/11/26/CTF%E6%B8%97%E9%80%8F%E5%BC%95%E5%85%A5/image-20211030153245365.png" alt="image-20211030153245365"></p>
<p>nikto，dirb：探测开发http服务的主机所开放的目录、地址、配置文件等</p>
<p><img src="/2021/11/26/CTF%E6%B8%97%E9%80%8F%E5%BC%95%E5%85%A5/image-20211030153218829.png" alt="image-20211030153218829"></p>
<p><img src="/2021/11/26/CTF%E6%B8%97%E9%80%8F%E5%BC%95%E5%85%A5/image-20211030153502368.png" alt="image-20211030153502368"></p>
<h3 id="步骤2：深入挖掘"><a href="#步骤2：深入挖掘" class="headerlink" title="步骤2：深入挖掘"></a>步骤2：深入挖掘</h3><p><img src="/2021/11/26/CTF%E6%B8%97%E9%80%8F%E5%BC%95%E5%85%A5/image-20211030153826666.png" alt="image-20211030153826666"></p>
<p>利用nc扫描大端口非http服务</p>
<p><img src="/2021/11/26/CTF%E6%B8%97%E9%80%8F%E5%BC%95%E5%85%A5/image-20211030154207937.png" alt="image-20211030154207937"></p>
<p><img src="/2021/11/26/CTF%E6%B8%97%E9%80%8F%E5%BC%95%E5%85%A5/image-20211030154340275.png" alt="image-20211030154340275"></p>
<p>直接访问大端口http服务</p>
<p>由nmap -T4 -A -v 靶场ip的结果可以得到一些不知道（自定义）服务名字的实际服务类型</p>
<p><img src="/2021/11/26/CTF%E6%B8%97%E9%80%8F%E5%BC%95%E5%85%A5/image-20211030154643090.png" alt="image-20211030154643090"></p>
<p><img src="/2021/11/26/CTF%E6%B8%97%E9%80%8F%E5%BC%95%E5%85%A5/image-20211030154708106.png" alt="image-20211030154708106"></p>
<p><img src="/2021/11/26/CTF%E6%B8%97%E9%80%8F%E5%BC%95%E5%85%A5/image-20211030154816668.png" alt="image-20211030154816668"></p>
<p><img src="/2021/11/26/CTF%E6%B8%97%E9%80%8F%E5%BC%95%E5%85%A5/image-20211030154938348.png" alt="image-20211030154938348"></p>
<p><img src="/2021/11/26/CTF%E6%B8%97%E9%80%8F%E5%BC%95%E5%85%A5/image-20211030155021568.png" alt="image-20211030155021568"></p>
<p>查看敏感文件</p>
<p><img src="/2021/11/26/CTF%E6%B8%97%E9%80%8F%E5%BC%95%E5%85%A5/image-20211030155041199.png" alt="image-20211030155041199"></p>
<p>http文件要看源代码</p>
<p>找到了一个密码winter</p>
<p><img src="/2021/11/26/CTF%E6%B8%97%E9%80%8F%E5%BC%95%E5%85%A5/image-20211030155152337.png" alt="image-20211030155152337"></p>
<h4 id="进一步深入挖掘"><a href="#进一步深入挖掘" class="headerlink" title="进一步深入挖掘"></a>进一步深入挖掘</h4><p><img src="/2021/11/26/CTF%E6%B8%97%E9%80%8F%E5%BC%95%E5%85%A5/image-20211030155316721.png" alt="image-20211030155316721"></p>
<p>a、ftp</p>
<p><img src="/2021/11/26/CTF%E6%B8%97%E9%80%8F%E5%BC%95%E5%85%A5/image-20211030155522357.png" alt="image-20211030155522357"></p>
<p><img src="/2021/11/26/CTF%E6%B8%97%E9%80%8F%E5%BC%95%E5%85%A5/image-20211030155543922.png" alt="image-20211030155543922"></p>
<p>b、robots.txt</p>
<p><img src="/2021/11/26/CTF%E6%B8%97%E9%80%8F%E5%BC%95%E5%85%A5/image-20211030155707997.png" alt="image-20211030155707997"></p>
<p>访问robots.txt目录下的可疑文件</p>
<p><img src="/2021/11/26/CTF%E6%B8%97%E9%80%8F%E5%BC%95%E5%85%A5/image-20211030155757357.png" alt="image-20211030155757357"></p>
<p>有输入就有可能存在注入漏洞（sql）</p>
<p><img src="/2021/11/26/CTF%E6%B8%97%E9%80%8F%E5%BC%95%E5%85%A5/image-20211030155959746.png" alt="image-20211030155959746"></p>
<p>试探</p>
<p><img src="/2021/11/26/CTF%E6%B8%97%E9%80%8F%E5%BC%95%E5%85%A5/image-20211030160150379.png" alt="image-20211030160150379"></p>
<p>有用户，就可能需要用到密码（前面找到了一个密码winter）</p>
<p><img src="/2021/11/26/CTF%E6%B8%97%E9%80%8F%E5%BC%95%E5%85%A5/image-20211030160450424.png" alt="image-20211030160450424"></p>
<p>说明：1./etc/passwd是所有人都可以访问的用户目录文件。2.more命令的功能与cat命令相似</p>
<p><img src="/2021/11/26/CTF%E6%B8%97%E9%80%8F%E5%BC%95%E5%85%A5/image-20211030160626404.png" alt="image-20211030160626404"></p>
<p>到这里就获得了用户名（summer）和密码（winter）了；一般都是ssh服务（远程登录服务）需要用户和密码。</p>
<h3 id="步骤3：登录靶场机器"><a href="#步骤3：登录靶场机器" class="headerlink" title="步骤3：登录靶场机器"></a>步骤3：登录靶场机器</h3><p><img src="/2021/11/26/CTF%E6%B8%97%E9%80%8F%E5%BC%95%E5%85%A5/image-20211030161012147.png" alt="image-20211030161012147"></p>
<p><img src="/2021/11/26/CTF%E6%B8%97%E9%80%8F%E5%BC%95%E5%85%A5/image-20211030160928619.png" alt="image-20211030160928619"></p>
<p><img src="/2021/11/26/CTF%E6%B8%97%E9%80%8F%E5%BC%95%E5%85%A5/image-20211030161233894.png" alt="image-20211030161233894"></p>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p><img src="/2021/11/26/CTF%E6%B8%97%E9%80%8F%E5%BC%95%E5%85%A5/image-20211030161336185.png" alt="image-20211030161336185"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wgc5.gitee.io/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="北极星上的稻草人">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="北极星上的稻草人">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/" class="post-title-link" itemprop="url">CTF-WEB渗透思路与技巧</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-11-26 11:04:23" itemprop="dateCreated datePublished" datetime="2021-11-26T11:04:23+08:00">2021-11-26</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-02-28 10:28:19" itemprop="dateModified" datetime="2023-02-28T10:28:19+08:00">2023-02-28</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CTF/" itemprop="url" rel="index"><span itemprop="name">CTF</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="CTF-WEB渗透入门思路与技巧"><a href="#CTF-WEB渗透入门思路与技巧" class="headerlink" title="CTF-WEB渗透入门思路与技巧"></a>CTF-WEB渗透入门思路与技巧</h1><p>说明：图片只是一个展示效果，可能前后不对应</p>
<h2 id="步骤一：信息探测"><a href="#步骤一：信息探测" class="headerlink" title="步骤一：信息探测"></a>步骤一：信息探测</h2><h4 id="1、扫描主机服务信息以及服务版本"><a href="#1、扫描主机服务信息以及服务版本" class="headerlink" title="1、扫描主机服务信息以及服务版本"></a>1、扫描主机服务信息以及服务版本</h4><p><strong>a.**扫描主机</strong>开放的端口号<strong>：</strong>nmap -p -T4 靶场ip地址**</p>
<p>参数说明：-p指端口，-T4指线程数为4</p>
<p><strong>b.快速扫描主机全部信息</strong>：<strong>nmap -T4 -A -v 靶场ip地址</strong> </p>
<p>参数说明：-A指all（全部），-v指快速</p>
<p>说明：有时候b扫描方式的结果会漏（在端口开放扫描部分）</p>
<p><strong>c.探测开放服务信息</strong>：<strong>nmap -sV 靶场ip地址</strong></p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211102200402655.png" alt="image-20211102200402655"></p>
<p>tip0：一般用b、c操作就足够了。</p>
<p>tip1：注意开放的服务与其可能存在的漏洞/攻击方法：ssh服务：远程登录；ftp服务：文件上传</p>
<p>tip3：后面所有操作都要考虑端口占用情况，可以用netstat -pantu来查看占用端口</p>
<h4 id="2、探测目录信息"><a href="#2、探测目录信息" class="headerlink" title="2、探测目录信息"></a>2、探测目录信息</h4><p>！！这里要求靶场开启了http服务！！</p>
<p>**a.**nikto -host http://靶场IP地址：端口 </p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104160032606.png" alt="image-20211104160032606"></p>
<p>**b.**dirb http://靶场IP地址：端口</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104155903347.png" alt="image-20211104155903347"></p>
<p>说明：</p>
<p>（1）端口不填，默认是80端口；</p>
<p>（2）虽然都是探测目录信息，但探测到的信息往往是互补的，a操作侧重于敏感信息，b操作侧重于敏感目录。</p>
<h4 id="3、用sparta探测（图形化界面工具）"><a href="#3、用sparta探测（图形化界面工具）" class="headerlink" title="3、用sparta探测（图形化界面工具）"></a>3、用sparta探测（图形化界面工具）</h4><p>启动软件（kali自带）</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104152216258.png" alt="image-20211104152216258"></p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104152211299.png" alt="image-20211104152211299"></p>
<p>软件会进行nmap、nikto、screenshot扫描</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104152242903.png" alt="image-20211104152242903"></p>
<p>点击下面的扫描模块就可以查看详情，也可以单独对某个端口进行扫描</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104152303730.png" alt="image-20211104152303730"></p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104152331126.png" alt="image-20211104152331126"></p>
<p>还可以用dirt进行暴力探测</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104152341971.png" alt="image-20211104152341971"></p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104152348212.png" alt="image-20211104152348212"></p>
<h2 id="步骤2：深入挖掘信息-分析探测结果"><a href="#步骤2：深入挖掘信息-分析探测结果" class="headerlink" title="步骤2：深入挖掘信息/分析探测结果"></a>步骤2：深入挖掘信息/分析探测结果</h2><h3 id="端口-服务利用"><a href="#端口-服务利用" class="headerlink" title="端口/服务利用"></a>端口/服务利用</h3><h4 id="1、大端口利用"><a href="#1、大端口利用" class="headerlink" title="1、大端口利用"></a>1、大端口利用</h4><p>​    常用端口为0~1023，要注意大于1024的端口和一些不知名或乱起名的服务</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211102202748686.png" alt="image-20211102202748686"></p>
<p>技巧1：利用nc扫描大端口（非http服务）</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211102203709341.png" alt="image-20211102203709341"></p>
<p>技巧2：直接访问大端口http服务</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211102204232751.png" alt="image-20211102204232751"></p>
<h4 id="2、SMB服务利用"><a href="#2、SMB服务利用" class="headerlink" title="2、SMB服务利用"></a>2、SMB服务利用</h4><p>​    SMB协议又叫samba，是一种通讯协议，它基于TCP协议，一般使用139、445端口。SMB允许计算机访问网络资源，下载对应的源文件。</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211102214659335.png" alt="image-20211102214659335"></p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211102214559780.png" alt="image-20211102214559780"></p>
<p><strong>a、smbclient -L IP：</strong>扫描出对应IP地址的主机共享的文件夹</p>
<p>（若空密码不行，可能需要另外方法寻找方法）</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211102215008230.png" alt="image-20211102215008230"></p>
<p><strong>b、smbclient  ‘\\IP\$share’：</strong>查看对应IP主机上的共享文件（share指文件名）</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211102215117240.png" alt="image-20211102215117240"></p>
<p><strong>c、get （敏感信息）文件名：</strong>下载文件</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211102215227610.png" alt="image-20211102215227610"></p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211102215245319.png" alt="image-20211102215245319"></p>
<p><strong>d、searchsploit samba 版本号：</strong>查看某个版本号的SMB协议是否有（溢出）漏洞：这里没有</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211030105045103.png" alt="image-20211030105045103"></p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211102220133905.png" alt="image-20211102220133905"></p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211102220153317.png" alt="image-20211102220153317"></p>
<h4 id="3、ssh服务利用"><a href="#3、ssh服务利用" class="headerlink" title="3、ssh服务利用"></a>3、ssh服务利用</h4><p>​    SSH（secure shell）是基于TCP 22号端口的服务，是建立在应用层基础上的安全协议，它专为远程登录会话和其他网络服务提供安全性的协议，利用SSH协议可以有效防止远程管理过程中的信息泄露问题。</p>
<p><strong>ssh远程登录：</strong>ssh -p 用户名@ip地址</p>
<h5 id="ssh协议认证机制及其漏洞利用"><a href="#ssh协议认证机制及其漏洞利用" class="headerlink" title="ssh协议认证机制及其漏洞利用"></a>ssh协议认证机制及其漏洞利用</h5><p><strong>a.基于口令的安全验证：</strong>利用账号和口令就可以登录远程主机；传输的数据会被加密，但不能保证正在连接的服务器就是你想连接的服务器，因此会受到“中间人”攻击（有人冒充服务器）。</p>
<p><strong>漏洞利用</strong>：基于字典的暴力破解，破解对应用户名和密码，通过ssh客户端服务连接远程主机的ssh服务，实现对服务器的一定控制。</p>
<p><strong>b.基于密钥的安全验证：</strong>需要依靠密钥，用户必须创建一对密钥（公钥和私钥），把私钥放在服务器上，通过SSH连接服务器时提供正确私钥即可登录。</p>
<p><strong>漏洞利用：</strong>通过对主机信息收集，获取到泄露的用户名和对应的密钥</p>
<h4 id="4、FTP服务利用"><a href="#4、FTP服务利用" class="headerlink" title="4、FTP服务利用"></a>4、FTP服务利用</h4><p>​    FTP服务是一个文件传输协议。</p>
<p>漏洞利用：在浏览器中输入 ftp://靶场IP地址，进行匿名登录ftp根目录，再查看敏感文件（配置文件要查看源代码）。</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104153117467.png" alt="image-20211104153117467"></p>
<h3 id="目录利用"><a href="#目录利用" class="headerlink" title="目录利用"></a>目录利用</h3><p>​    对于用dirt、nikto等工具探测到的目录，要特备关注一些敏感目录/文件；如名字带有：</p>
<p>​        ●admin：管理员界面，一般是服务器后台界面或其登录界面</p>
<p>​        ●passwd：password的缩写，尝包含密码信息</p>
<p>​        ●shadow：常保存用户名，与passwd的密码匹配</p>
<p>​        ●index：主页，往往会留下提示/漏洞，需要审计其源码</p>
<p>​        ●robots：隐藏文件目录，常保存敏感文件</p>
<p>​        ●backup：备份文件，常保存密钥等敏感文件</p>
<p>​        ●config：配置文件，常可以发现漏洞/密钥信息，需要审计源码（要留意注释）</p>
<p>​        ●login：登录界面，先尝试弱密码登录，要么需要寻找用户名和口令/密钥，要么利用注入漏洞，最后才用爆破法</p>
<p>​        ●home：普通用户根目录，有时可以发现用户名等敏感信息</p>
<p>​        ●upload：上传文件，常需要上传webshell获取shell</p>
<p>​        ●download：下载文件，常可以下载敏感文件</p>
<p>​        ●.php/.python等：可代码审计，已达到利用语句或发现漏洞</p>
<p>​        ●mysql/sql/__db：数据库，需要登录其数据库，查找用户名和密码</p>
<p>​        ●ssi：可能存在ssi漏洞的页面</p>
<p>​        ●.txt文件：常存有密钥（可能是加密形式）、口令、用户名等信息</p>
<p>​        ●icon：特别文件</p>
<p>​        ●wordpress（wp缩写）：常保存与密钥或登录的相关信息</p>
<p>​        ●ssh/samba等：对应漏洞的利用</p>
<p>​        ●secure：敏感文件</p>
<p>​        ●nothing：常是假404页面，需要代码审计</p>
<p>​    还有根目录和一些乱七八糟的目录需要注意；有时候文件/目录背后会有提示该文件/目录是敏感的。对于敏感网站还要查看其源码（注意注释、代码审计等），如主页、登录界面等等页面</p>
<p>如：</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104161211476.png" alt="image-20211104161211476"></p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104160837857.png" alt="image-20211104160837857"></p>
<p>​    目录利用是信息挖掘最重要的一步，往往很多重要的信息（用户名、密钥、敏感漏洞）都是在这一步发现的。</p>
<h2 id="步骤3：弱点-漏洞扫描-信息利用"><a href="#步骤3：弱点-漏洞扫描-信息利用" class="headerlink" title="步骤3：弱点/漏洞扫描/信息利用"></a>步骤3：弱点/漏洞扫描/信息利用</h2><h3 id="漏洞扫描"><a href="#漏洞扫描" class="headerlink" title="漏洞扫描"></a>漏洞扫描</h3><h4 id="1、使用metasploit扫描漏洞"><a href="#1、使用metasploit扫描漏洞" class="headerlink" title="1、使用metasploit扫描漏洞"></a>1、使用metasploit扫描漏洞</h4><p>a、seachsploit 服务的软件版本查找漏洞信息</p>
<p>服务的软件版本号可以用nmap -sV ip地址查询</p>
<p>如：扫描ftp服务的软件</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104153707417.png" alt="image-20211104153707417"></p>
<p>ProFTPD是ftp服务的软件，1.3.3c是版本号</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104153947435.png" alt="image-20211104153947435"></p>
<p>b、使用metasploit的search查找漏洞模块</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104193152596.png" alt="image-20211104193152596"></p>
<h4 id="2、使用owasp-zap扫描漏洞"><a href="#2、使用owasp-zap扫描漏洞" class="headerlink" title="2、使用owasp-zap扫描漏洞"></a>2、使用owasp-zap扫描漏洞</h4><p>​    kali自带owasp-zap</p>
<p>终端启动</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104194037138.png" alt="image-20211104194037138"></p>
<p>图形化界面启动</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104193650252.png" alt="image-20211104193650252"></p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104193655617.png" alt="image-20211104193655617"></p>
<h4 id="3、使用AVWS（Acunetix）扫描漏洞"><a href="#3、使用AVWS（Acunetix）扫描漏洞" class="headerlink" title="3、使用AVWS（Acunetix）扫描漏洞"></a>3、使用AVWS（Acunetix）扫描漏洞</h4><p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104195647852.png" alt="image-20211104195647852"></p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104195806884.png" alt="image-20211104195806884"></p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104195832261.png" alt="image-20211104195832261"></p>
<h4 id="4、探测中间件PUT漏洞"><a href="#4、探测中间件PUT漏洞" class="headerlink" title="4、探测中间件PUT漏洞"></a>4、探测中间件PUT漏洞</h4><p>​    只要HTTP方法开启了PUT功能，PUT可以直接从客户机上传文件到服务器。 探测http开启中间件指令：curl -v -X OPTIONS 目标地址</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104194628075.png" alt="image-20211104194628075"></p>
<h3 id="弱点漏洞"><a href="#弱点漏洞" class="headerlink" title="弱点漏洞"></a>弱点漏洞</h3><p>有输入的地方，就可以存在注入漏洞！；具体操作查看本博客对应的文章</p>
<p>​    a、sql注入：《CTF渗透引入》、《SQL注入》</p>
<p>​    b、SSI注入：《SSI注入》</p>
<p>​    c、命令注入：《命令注入》</p>
<p>​    d、目录遍历：《目录遍历漏洞》</p>
<h3 id="暴力破解"><a href="#暴力破解" class="headerlink" title="暴力破解"></a>暴力破解</h3><h4 id="1、使用msf暴力破解"><a href="#1、使用msf暴力破解" class="headerlink" title="1、使用msf暴力破解"></a>1、使用msf暴力破解</h4><p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104200102859.png" alt="image-20211104200102859"></p>
<p>《web安全暴力破解》</p>
<p>a.利用wpscan获取用户名和密码（如果没有探测到）</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211031163357930.png" alt="image-20211031163357930"></p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104200258439.png" alt="image-20211104200258439"></p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211031163538379.png" alt="image-20211031163538379"></p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104200421430.png" alt="image-20211104200421430"></p>
<p>b.利用msf暴力破解登录密码</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104200509299.png" alt="image-20211104200509299"></p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104200514650.png" alt="image-20211104200514650"></p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104200526368.png" alt="image-20211104200526368"></p>
<p>rhost：靶机地址（lhost：攻击地址）</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104200551621.png" alt="image-20211104200551621"></p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104200556107.png" alt="image-20211104200556107"></p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104200600049.png" alt="image-20211104200600049"></p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104200611821.png" alt="image-20211104200611821"></p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104200617555.png" alt="image-20211104200617555"></p>
<h4 id="2、使用burpsuite爆破"><a href="#2、使用burpsuite爆破" class="headerlink" title="2、使用burpsuite爆破"></a>2、使用burpsuite爆破</h4><p>a、获取爆破用的字典（这里是kali自带的sql注入字典）</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211102140627873.png" alt="image-20211102140627873"></p>
<p>b、设置中断获取爆破页面数据</p>
<p>设置浏览器代理服务器</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104201522077.png" alt="image-20211104201522077"></p>
<p>启动中断</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104201537419.png" alt="image-20211104201537419"></p>
<p>截取数据</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104201555173.png" alt="image-20211104201555173"></p>
<p>c、爆破</p>
<p>将抓取的页面发到intruder模块进行爆破</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104201619332.png" alt="image-20211104201619332"></p>
<p>设置爆破区域</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104201630302.png" alt="image-20211104201630302"></p>
<p>设置爆破字典</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104201643667.png" alt="image-20211104201643667"></p>
<p>启动</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104201653148.png" alt="image-20211104201653148"></p>
<p>查看结果</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104201703598.png" alt="image-20211104201703598"></p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104201710210.png" alt="image-20211104201710210"></p>
<p>（最后发现输入返回长度为2900的是正确密码：例子出自《CTF综合测试》）</p>
<h2 id="步骤4：上传webshell"><a href="#步骤4：上传webshell" class="headerlink" title="步骤4：上传webshell"></a>步骤4：上传webshell</h2><p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211105103733193.png" alt="image-20211105103733193"></p>
<h3 id="制作webshell"><a href="#制作webshell" class="headerlink" title="制作webshell"></a>制作webshell</h3><h4 id="1、制作php的webshell"><a href="#1、制作php的webshell" class="headerlink" title="1、制作php的webshell"></a>1、制作php的webshell</h4><p>​    a、使用/usr/share/webshell/php下的webshell（kali自带）</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104210730250.png" alt="image-20211104210730250"></p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211031151536728.png" alt="image-20211031151536728"></p>
<p>b、利用kali生成php的webshell</p>
<p>输入正确的参数（lhost、端口号等），再把内容拷贝到php文件即可使用</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104211453611.png" alt="image-20211104211453611"></p>
<h4 id="2、制作python的websehll"><a href="#2、制作python的websehll" class="headerlink" title="2、制作python的websehll"></a>2、制作python的websehll</h4><p>这里的方法和生成php的webshell是一样的，只是这里加了重定向。</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104211632043.png" alt="image-20211104211632043"></p>
<h4 id="3、制作elf的webshell"><a href="#3、制作elf的webshell" class="headerlink" title="3、制作elf的webshell"></a>3、制作elf的webshell</h4><p>用于命令注入</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104211112036.png" alt="image-20211104211112036"></p>
<h4 id="4、命令执行webshell"><a href="#4、命令执行webshell" class="headerlink" title="4、命令执行webshell"></a>4、命令执行webshell</h4><p>在输入端输入一下webshell（要按实际情况改）</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104211247531.png" alt="image-20211104211247531"></p>
<h3 id="上传webshell"><a href="#上传webshell" class="headerlink" title="上传webshell"></a>上传webshell</h3><p>​    一般而言，webshell都是上传到404页面，因为方便利用</p>
<p>​    ●登录后台网站，直接上传文件，或者操作服务器下载文件</p>
<p>​    ●通过upload等服务，上传文件，或者操作服务器下载文件</p>
<p>​    ●有时候需要绕过防火墙上传文件，如《CTF综合测试》</p>
<p>​    ●利用注入漏洞上传文件</p>
<p>注意：如果需要服务器下载靶场的文件（如：webshell），需要在攻击机（kali）开启/创建http服务。</p>
<p><strong>启动/创建HTTP服务</strong></p>
<p><strong>方法一：</strong>python -m “SimpleHTTPServer”</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211105094111832.png" alt="image-20211105094111832"></p>
<h2 id="步骤5：渗透获取shell"><a href="#步骤5：渗透获取shell" class="headerlink" title="步骤5：渗透获取shell"></a>步骤5：渗透获取shell</h2><p><strong>说明：</strong>渗透的方法有很多，方法不唯一。</p>
<h3 id="启动监听"><a href="#启动监听" class="headerlink" title="启动监听"></a>启动监听</h3><h4 id="a、利用msf监听"><a href="#a、利用msf监听" class="headerlink" title="a、利用msf监听"></a>a、利用msf监听</h4><p>启动msf</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211102170833011.png" alt="image-20211102170833011"></p>
<p>配置playload并启动监听（端口和lhost需要按实际来）</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104220108129.png" alt="image-20211104220108129"></p>
<h4 id="b、使用nc-nlvp-port监听"><a href="#b、使用nc-nlvp-port监听" class="headerlink" title="b、使用nc -nlvp port监听"></a>b、使用nc -nlvp port监听</h4><p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211105103954832.png" alt="image-20211105103954832"></p>
<h3 id="触发反弹shell"><a href="#触发反弹shell" class="headerlink" title="触发反弹shell"></a>触发反弹shell</h3><p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211105103820072.png" alt="image-20211105103820072"></p>
<p>触发shell方法    </p>
<p>​    ●点击点击/打开/查看文件</p>
<p>​    ●通过访问链接触发shell</p>
<p>​    ●等等</p>
<p>顺利的话，触发wenshell文件就会反弹shell了。</p>
<h2 id="步骤6：提权"><a href="#步骤6：提权" class="headerlink" title="步骤6：提权"></a>步骤6：提权</h2><p>​    反弹的shell一般都是普通用户权限，而flag常常在root权限，因此需要提权。如果反弹的shell不是终端（终端输入标识“$”、“~”、“#”），而是标准输入（什么都没或者是”&gt;”）;这是往往需要获取终端，因为sudo等操作往往需要终端输入。</p>
<h3 id="1、获取-启动终端"><a href="#1、获取-启动终端" class="headerlink" title="1、获取/启动终端"></a>1、获取/启动终端</h3><p>​        ● python -c  “ import pty;pty.spawn(‘/bin/bash’)” </p>
<p>​        ● python -c  “ import pty;pty.spawn(‘bin/sh’)”</p>
<p>​        ● python /tmp/asdf.py</p>
<p>​        ● echo “import pty;pty.spawn(‘/bin/bash’)” &gt; /tmp/asdf.py</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211105102839635.png" alt="image-20211105102839635"></p>
<p>​    获取终端后，可以尝试用su命令使用弱密码尝试提权</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211105104134139.png" alt="image-20211105104134139"></p>
<h3 id="2、查看用户可以使用那些root权限操作"><a href="#2、查看用户可以使用那些root权限操作" class="headerlink" title="2、查看用户可以使用那些root权限操作"></a>2、查看用户可以使用那些root权限操作</h3><p>​    <strong>sudo -l：</strong>查看普通用户可以使用那些sudo权限</p>
<h3 id="3、提权"><a href="#3、提权" class="headerlink" title="3、提权"></a>3、提权</h3><h4 id="a、利用密码提权"><a href="#a、利用密码提权" class="headerlink" title="a、利用密码提权"></a>a、利用密码提权</h4><p>​    su -用户名；再输入密码即可；更多的时候是需要自己探测用户名和密码；如进入数据库查找（《CTF综合测试》）、利用注入漏洞寻找等</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211030112056550.png" alt="image-20211030112056550"></p>
<h4 id="b、使用perl命令提权"><a href="#b、使用perl命令提权" class="headerlink" title="b、使用perl命令提权"></a>b、使用perl命令提权</h4><p>​    ①前提：用户可以执行perl命令</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211101222507358.png" alt="image-20211101222507358"></p>
<p>​    ②步：sudo perl -e “exec ‘/bin/sh’ “：运行sh，通过perl命令提权</p>
<p>​    ③步：bash -i ：以交互模式运行bash</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211105102320820.png" alt="image-20211105102320820"></p>
<h4 id="c、溢出提权"><a href="#c、溢出提权" class="headerlink" title="c、溢出提权"></a>c、溢出提权</h4><p>​    详情看《FTP服务后门利用》</p>
<h4 id="d、内核溢出提权"><a href="#d、内核溢出提权" class="headerlink" title="d、内核溢出提权"></a>d、内核溢出提权</h4><p>查找漏洞：searchsploit 系统 版本号</p>
<p>​    如：searchsploit ubuntu 4.4.0</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211105101709122.png" alt="image-20211105101709122"></p>
<p>​    使用第三个漏洞（内核溢出代码文件名：41458.c）</p>
<p>将其内核溢出代码复制到桌面并编译为可以执行的文件<br>    cp /usr/share/exploitdb/exploits/linux/local/41458.c /root/desktop/1234.c</p>
<p>​    gcc 1234.c -o shellroot</p>
<p>​    参数说明：-o是输入，输出文件名问shellroot</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211105101312890.png" alt="image-20211105101312890"></p>
<p>利用获取的shell将sehllroot上传到靶机并设置文件执行权限</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211105101645298.png" alt="image-20211105101645298"></p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211105101737053.png" alt="image-20211105101737053"></p>
<p>执行shellroot</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211105101818781.png" alt="image-20211105101818781"></p>
<h4 id="e、利用john破解"><a href="#e、利用john破解" class="headerlink" title="e、利用john破解"></a>e、利用john破解</h4><p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211105103144827.png" alt="image-20211105103144827"></p>
<p>进入会话，下载passwd和shadow</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211105103210995.png" alt="image-20211105103210995"></p>
<p>文件格式化并重定向</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211105103236376.png" alt="image-20211105103236376"></p>
<p>使用john爆破出用户名和密码</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211105103256494.png" alt="image-20211105103256494"></p>
<h2 id="步骤7：获取flag"><a href="#步骤7：获取flag" class="headerlink" title="步骤7：获取flag"></a>步骤7：获取flag</h2><p>a、可疑网页及其源码处：有时候网页会存在flag信息，通过源码的注释或代码审计也有可能发现flag</p>
<p>b、当获取到普通shell时，需要有意识的查看其home目录下的文件，有时候会发现flag</p>
<p>c、root根目录下的flag，渗透模块，root目录下必然会存在falg，它常常存在root的根目录下</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211105105225124.png" alt="image-20211105105225124"></p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211126110613621.png" alt="image-20211126110613621"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/2/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><a class="extend next" rel="next" href="/page/4/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">北极星上的稻草人</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">66</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">9</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">24</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">北极星上的稻草人</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
</div>








      </div>
    </footer>
  </div>

  
  
  <script color='0,0,255' opacity='0.5' zIndex='-1' count='99' src="/lib/canvas-nest/canvas-nest.min.js"></script>
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  


<!-- 页面动态背景 -->

<script type="text/javascript" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script>


</body>
</html>
<!-- 页面点击小红心 -->
<script type="text/javascript" src="/js/clicklove.js"></script>